System.register(["./mui-legacy-Co1sKVsS.js","./intl-legacy-f5dGU49Z.js","./reactVendor-legacy-C5drotBr.js","./react-setup-legacy-CKF-9cua.js","./load-functions-legacy-B3DSplhu.js","./base-legacy-DAqmyLJs.js","./QuoteStatus-legacy-BAlUXA_E.js","./getQuoteExtraFields-legacy-CAC5l3Az.js","./muiIcon-legacy-C-h6sDde.js","./dateFns-legacy-DHywh9DD.js","./b3checkout-legacy-Dvs0aye-.js","./router-legacy-CQEMCAt4.js","./lodashEs-legacy-BTGS6uHg.js","./eCache-legacy-QcRlogRO.js","./redux-legacy-DH94TLLa.js","./toolkit-legacy-DO7GmFjE.js","../index-legacy.JvindH6T.js","./global-legacy-vVqwfyov.js","./dropzone-legacy-B1uEXZk9.js"],function(e,t){"use strict";var r,s,n,i,a,o,l,c,u,d,p,m,x,h,g,f,y,b,j,C,w,q,D,N,S,v,P,T,k,I,E,R,A,B,F,$,H,L,z,U,Q,M,O,V,_,W,G,K,Z,X,Y,J,ee,te,re,se,ne,ie,ae,oe,le,ce,ue,de,pe,me;return{setters:[e=>{r=e.O,s=e.j,n=e.B,i=e.A,a=e.ae,o=e.b,l=e.am,c=e.G,u=e.T,d=e.s},e=>{p=e.r},e=>{m=e.g},e=>{x=e.G,h=e.j,g=e.u,f=e.a2,y=e.af,b=e.aT,j=e.aI,C=e.a7,w=e.bu,q=e.bv,D=e.w,N=e.a,S=e.ag,v=e.C,P=e.l,T=e.aa,k=e.aw,I=e.bw,E=e.bs,R=e.aN,A=e.am,B=e.bh,F=e.ao,$=e.bx,H=e.ak,L=e.by,z=e.y,U=e.bg,Q=e.at,M=e.ba,O=e.bb},null,e=>{V=e.b},e=>{_=e.u,W=e.g,G=e.q,K=e.Q,Z=e.a,X=e.b,Y=e.e},e=>{J=e.B,ee=e.Q,te=e.a,re=e.b,se=e.g},e=>{ne=e.m,ie=e.i},e=>{ae=e.f,oe=e.a},e=>{le=e.s,ce=e.a},e=>{ue=e.u,de=e.a,pe=e.c},e=>{me=e.j},null,null,null,null,null,null],execute:function(){var t,xe,he,ge;e("default",function(){const e=de(),{id:t,bcLanguage:r,quoteConfig:i,role:a,emailAddress:o,isB2BUser:l,selectCompanyHierarchyId:u,isAgenting:d,taxZoneRates:m,enteredInclusiveTax:b,isEnableProduct:j,purchasabilityPermission:C,handleGetProductsById:w,getQuote:D}=function(){const{id:e=""}=pe(),{state:{bcLanguage:t,quoteConfig:r}}=p.useContext(x),s=g(({company:e})=>e.companyInfo.id),n=g(({company:e})=>e.customer.emailAddress),i=g(({company:e})=>e.customer.customerGroupId),a=g(({company:e})=>e.customer.role),o=g(z),{selectCompanyHierarchyId:l}=g(({company:e})=>e.companyHierarchyInfo),c=g(({b2bFeatures:e})=>e.masqueradeCompany.isAgenting),{currency_code:u}=g(U),d=g(({global:e})=>e.taxZoneRates),m=g(({storeConfigs:e})=>e.currencies.enteredInclusiveTax),h=g(({global:e})=>e.blockPendingQuoteNonPurchasableOOS?.isEnableProduct),{purchasabilityPermission:y}=g(f),b=async e=>{if(e.length>0){const t=[];e.forEach(e=>{t.includes(e.productId)||t.push(e.productId)});const r={productIds:t,currencyCode:u,companyId:s,customerGroupId:i},{productsSearch:n}=await M(r),a=O(n);return e.forEach(e=>{const t=e,r=a.find(t=>{const{id:r}=t;return Number(e.productId)===Number(r)});t.productsSearch=r||{}}),e}},j=ue(),C=async()=>{const{search:t}=j,r=q(t,"date")||"",s={id:Number(e),date:r.toString()},{quote:n}=await(99===Number(a)?Z(s):X(s));return n};return{id:e,bcLanguage:t,quoteConfig:r,role:a,emailAddress:n,isB2BUser:o,selectCompanyHierarchyId:l,isAgenting:c,taxZoneRates:d,enteredInclusiveTax:m,isEnableProduct:h,purchasabilityPermission:y,handleGetProductsById:b,getQuote:C}}(),[S]=N(),v=h(),[P,T]=p.useState({}),[k,I]=p.useState([]),[E,R]=p.useState([]),[A,B]=p.useState(!1),[V,_]=p.useState(!0),[W,G]=p.useState({originalSubtotal:0,discount:0,tax:0,shipping:0,totalAmount:0}),[K,J]=p.useState(!1),[ne,ie]=p.useState(!1),[ae,oe]=p.useState(0),[le,ce]=p.useState({oos:"",nonPurchasable:""}),[xe,he]=p.useState({quotePurchasabilityPermission:!1,quoteConvertToOrderPermission:!1}),[ge,fe]=p.useState(!1),be=ue();p.useEffect(()=>{if(!P?.id)return;const{quoteConvertToOrderPermission:e}=F,{quotePurchasabilityPermission:t,quoteConvertToOrderPermission:r}=l?{quotePurchasabilityPermission:C,quoteConvertToOrderPermission:Q({code:e,companyId:P?.companyId?.id||null,userEmail:P?.contactInfo?.email||""})}:{quotePurchasabilityPermission:!0,quoteConvertToOrderPermission:!0};he({quotePurchasabilityPermission:t,quoteConvertToOrderPermission:r})},[l,P,u,C]),p.useEffect(()=>{let e="",t="";k.forEach(r=>{const s=$(r);s?.type&&j&&!r?.purchaseHandled&&("oos"===s.type&&(e+=`${r.productName}${e?",":""}`),"non-purchasable"===s.type&&(t+=`${r.productName}${t?",":""}`))});const r=!!e||!!t;j&&A&&r&&(e&&H.error(v("quoteDetail.message.insufficientStock",{ProductName:e})),t&&H.error(v("quoteDetail.message.nonPurchasable",{ProductName:t}))),_(r),ce({oos:e,nonPurchasable:t})},[j,A,k]);const je=p.useCallback(()=>{if(V){const{oos:e,nonPurchasable:t}=le;e&&H.error(v("quoteDetail.message.insufficientStock",{ProductName:e})),t&&H.error(v("quoteDetail.message.nonPurchasable",{ProductName:t}))}return V},[V,le]),De=[];if(m?.length){const e=m?.find(e=>1===e.id);if(e){const{rates:t=[]}=e;t[0]&&t[0].enabled&&t[0].classRates.length&&t[0].classRates.forEach(e=>De.push(e))}}const ve=(e,t)=>{if(t.length){const e=me(t,"[0].bc_calculated_price.tax_exclusive",0),r=me(t,"[0].bc_calculated_price.tax_inclusive",0);return e>0?(r-e)/e:0}return De.length?(De.find(t=>t.taxClassId===e)?.rate||0)/100:0},Pe=async()=>{J(!0),ie(!1);try{const e=await D(),t=await w(e.productsList).catch(()=>{}),r=await(async e=>{const t=await se(),r=[];return t.length&&t.forEach(t=>{const s=t,n=e.find(e=>e.fieldName===s.name);r.push({fieldName:s.name||"",fieldValue:n?.fieldValue||s.default})}),r})(e.extraFields);if(T({...e,extraFields:r}),G({originalSubtotal:e.subtotal,discount:e.discount,tax:e.taxTotal,shipping:e.shippingTotal,totalAmount:e.totalAmount}),I(t),0===Number(e.shippingTotal))oe(Number(e.taxTotal));else{let e=0;t?.forEach(t=>{const{quantity:r,offeredPrice:s,productsSearch:{variants:n=[],taxClassId:i}}=t,a=ve(i,n);e+=b?Number(s)*a/(1+a)*Number(r):Number(s)*a*Number(r)}),oe(e)}const{backendAttachFiles:s=[],storefrontAttachFiles:n=[],salesRep:i,salesRepEmail:a}=e;B(!!i||!!a);const o=[];return n.forEach(e=>{o.push({fileName:e.fileName,fileType:e.fileType,fileUrl:e.fileUrl,id:e.id,hasDelete:4!==P.status,title:v("quoteDetail.uploadedByCustomer",{createdBy:e.createdBy})})}),s.forEach(e=>{o.push({fileName:e.fileName,fileType:e.fileType,fileUrl:e.fileUrl,id:e.id,title:v("quoteDetail.uploadedBySalesRep",{createdBy:e.createdBy})})}),R(o),e}catch(e){throw H.error(e),e}finally{J(!1),ie(!0)}},Te=async e=>{J(!0);const{id:t,createdAt:s}=P;try{const n={quoteId:Number(t),createdAt:s,isPreview:e,lang:r},i=await Y(n);if(i)return{url:i.quoteFrontendPdf.url,content:i.quoteFrontendPdf.content}}catch(n){H.error(n)}return{url:"",content:""}};p.useEffect(()=>{const{state:t}=be;t&&(setTimeout(()=>{H.success(100===Number(a)?v("quoteDetail.submittedQuote"):v("quoteDetail.quoteSubmitted"),{action:{label:100===Number(a)?v("quoteDetail.copyQuoteLink"):v("quoteDetail.reviewAllQuotes"),onClick:()=>{100===Number(a)?(ye(window.location.href),H.success(v("quoteDetail.copySuccessful"))):e("/quotes")}}})},10),be.state=null)},[be,e,a]),p.useEffect(()=>{be.search.includes("isCheckout")&&t&&(async()=>{try{fe(!0),await we({quoteId:t,proceedingCheckoutFn:je,role:a,location:be,navigate:e})}finally{fe(!1)}})()},[t,V]);const ke=p.useMemo(()=>!("1"!==i.find(e=>"quote_auto_quoting"===e.key)?.value&&!A),[i,A]),Re=p.useMemo(()=>{const e=P?.extraFields?.map(e=>({fieldName:e.fieldName,value:e.fieldValue}));return{info:{quoteTitle:P?.quoteTitle||"",referenceNumber:P?.referenceNumber||""},extraFields:e||[],recipients:P?.recipients||[]}},[P]);L(!1);const{quotePurchasabilityPermission:Ae,quoteConvertToOrderPermission:Be}=xe;return s.jsx(y,{isSpinning:K||ge,children:s.jsxs(n,{sx:{display:"flex",flexDirection:"column",flex:1},children:[s.jsx(Ne,{status:P.status,quoteNumber:P.quoteNumber,issuedAt:P.createdAt,expirationDate:P.expiredAt,exportPdf:async()=>{try{const{url:e}=await Te(!1);e&&window.open(`${e}`,"_blank")}catch(e){H.error(e)}finally{J(!1)}},printQuote:async()=>{try{const{content:e}=await Te(!0),t=document.createElement("iframe");t.setAttribute("style","display:none;"),document.getElementById("bundle-container")?.appendChild(t),t.contentDocument?.open(),t.contentDocument?.write(e),t.contentDocument?.close(),J(!1),t.contentWindow?.print()}catch(e){H.error(e)}},role:a,salesRepInfo:P.salesRepInfo}),s.jsx(n,{sx:{marginTop:"1rem"},children:s.jsx(ee,{quoteAndExtraFieldsInfo:Re,contactInfo:P.contactInfo,shippingAddress:P.shippingAddress,billingAddress:P.billingAddress})}),s.jsxs(c,{container:!0,spacing:S?2:0,rowSpacing:0,sx:{overflow:"auto",flexWrap:S?"wrap":"nowrap",paddingBottom:"20px",marginBottom:S?"6rem":0,marginTop:S?0:"1rem","@media print":{overflow:"hidden"}},children:[s.jsx(c,{item:!0,xs:S?12:8,rowSpacing:0,sx:S?{flexBasis:"100%",pl:"16px"}:{mr:"16px"},children:s.jsx(n,{sx:S?{flexBasis:"100%"}:{},children:s.jsx(Ie,{total:k.length,currency:P.currency,isHandleApprove:A,getQuoteTableDetails:async e=>{let t=k;if(0===t.length){const e=await Pe();t=e?.productsList||[]}const r=Number(e.offset),s=Number(e.first)+r;return t.length?{edges:t.slice(r,s),totalCount:t.length}:{edges:[],totalCount:0}},getTaxRate:ve,displayDiscount:P.displayDiscount})})}),s.jsxs(c,{item:!0,xs:S?12:4,rowSpacing:0,sx:S?{flexBasis:"100%"}:{pl:0},children:[s.jsx(n,{sx:{marginBottom:"1rem"},children:s.jsx(Se,{isHideQuoteCheckout:V,quoteSummary:W,quoteDetailTax:ae,status:P.status,quoteDetail:P})}),P.notes&&s.jsx(n,{sx:{marginBottom:"1rem",displayPrint:"none"},children:s.jsx(te,{quoteNotes:P.notes})}),s.jsx(n,{sx:{marginBottom:"1rem",displayPrint:"none"},children:s.jsx(Ce,{id:t,status:P.status,isB2BUser:l,email:o||"",msgs:P?.trackingHistory||[]})}),s.jsx(n,{sx:{marginBottom:"1rem",displayPrint:"none"},children:s.jsx(re,{allowUpload:4!==Number(P.status),quoteId:P.id,status:P.status,defaultFileList:E})}),P.legalTerms&&s.jsx(n,{sx:{displayPrint:"none"},children:s.jsx(Ee,{quoteLegalTerms:P.legalTerms})})]})]}),Be&&Ae&&4!==Number(P.status)&&ne&&P?.allowCheckout&&ke&&(!j||!(!A||!V)||!V)&&s.jsx(qe,{quoteId:P.id,role:a,isAgenting:d,status:P.status,proceedingCheckoutFn:je})]})})});var fe=function(){if(ge)return he;ge=1;var e=xe?t:(xe=1,t=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,r=[],s=0;s<e.rangeCount;s++)r.push(e.getRangeAt(s));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||r.forEach(function(t){e.addRange(t)}),t&&t.focus()}}),r={"text/plain":"Text","text/html":"Url",default:"Text"};return he=function(t,s){var n,i,a,o,l,c,u=!1;s||(s={}),n=s.debug||!1;try{if(a=e(),o=document.createRange(),l=document.getSelection(),(c=document.createElement("span")).textContent=t,c.ariaHidden="true",c.style.all="unset",c.style.position="fixed",c.style.top=0,c.style.clip="rect(0, 0, 0, 0)",c.style.whiteSpace="pre",c.style.webkitUserSelect="text",c.style.MozUserSelect="text",c.style.msUserSelect="text",c.style.userSelect="text",c.addEventListener("copy",function(e){if(e.stopPropagation(),s.format)if(e.preventDefault(),void 0===e.clipboardData){n&&console.warn("unable to use e.clipboardData"),n&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var i=r[s.format]||r.default;window.clipboardData.setData(i,t)}else e.clipboardData.clearData(),e.clipboardData.setData(s.format,t);s.onCopy&&(e.preventDefault(),s.onCopy(e.clipboardData))}),document.body.appendChild(c),o.selectNodeContents(c),l.addRange(o),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");u=!0}catch(d){n&&console.error("unable to copy using execCommand: ",d),n&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(s.format||"text",t),s.onCopy&&s.onCopy(window.clipboardData),u=!0}catch(d){n&&console.error("unable to copy using clipboardData: ",d),n&&console.error("falling back to prompt"),i=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"âŒ˜":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in s?s.message:"Copy to clipboard: #{key}, Enter"),window.prompt(i,t)}}finally{l&&("function"==typeof l.removeRange?l.removeRange(o):l.removeAllRanges()),c&&document.body.removeChild(c),a()}return u},he}();const ye=m(fe);function be({msg:e,isEndMessage:t,isCustomer:r}){const i=h();return s.jsxs(n,{sx:{display:"flex",flexDirection:"column",alignItems:r?"flex-end":"flex-start",paddingTop:"5px"},children:[e?.role&&s.jsx(n,{sx:{height:"14px",fontWeight:400,lineHeight:"14px",fontSize:"10px",letterSpacing:"0.17px",color:"rgba(0, 0, 0, 0.38)"},children:e.role}),e?.message&&s.jsxs(n,{sx:{display:"inline-block",lineHeight:"34px",padding:"0 10px",background:r?"rgba(25, 118, 210, 0.3)":"rgba(0, 0, 0, 0.12)",borderRadius:"18px",m:"1px"},children:[s.jsx(l,{title:ae(1e3*(e.sendTime||0),"K:m aa"),placement:"top",arrow:!0,children:s.jsx(n,{sx:{wordBreak:"break-word"},children:e.message})}),t&&s.jsx(n,{sx:{height:"14px",fontWeight:400,lineHeight:"14px",fontSize:"10px",letterSpacing:"0.17px",color:"rgba(0, 0, 0, 0.38)"},children:`${i("quoteDetail.message.sent")} ${oe(new Date(1e3*(e.sendTime||0)),new Date,{addSuffix:!0})}`})]})]})}function je({msg:e}){return s.jsx(n,{sx:{color:"rgba(0, 0, 0, 0.6)",textAlign:"center",height:"21px",mb:"5px"},children:`${b(e?.date||0)}`})}function Ce({msgs:e,id:t,isB2BUser:l,email:c,status:u}){const{dispatch:d}=p.useContext(x),m=r().palette.primary.main,b=h(),C=p.useRef(null),w=p.useRef(0),[q,D]=p.useState([]),[N,S]=p.useState(0),[v,P]=p.useState(""),[T,k]=p.useState(!1),{quotesUpdateMessageActionsPermission:I}=g(f),E=!l||I,R=e=>{let t={};const r=[];let s=0;e.forEach((e,n)=>{0===n?(r.push({isCustomer:!e.role?.includes("Sales rep:"),date:e?.date,key:`${e?.date}date`}),r.push({isCustomer:!e.role?.includes("Sales rep:"),message:e.message,sendTime:e.date,role:e.role,key:e?.date}),t=e,t.isCustomer=!e.role?.includes("Sales rep:")):((e?.date||0)-(t?.date||0)>3600&&r.push({isCustomer:!e.role?.includes("Sales rep:"),date:e?.date,key:`${e?.date}date`}),t.isCustomer===!e.role?.includes("Sales rep:")?r.push({isCustomer:!e.role?.includes("Sales rep:"),message:e.message,sendTime:e.date,key:e?.date}):r.push({isCustomer:!e.role?.includes("Sales rep:"),message:e.message,role:e.role,sendTime:e.date,key:e?.date}),t=e,t.isCustomer=!e.role?.includes("Sales rep:")),e.role?.includes("Sales rep:")&&!e.read&&(s+=1)}),S(s),D(r)},A=p.useMemo(()=>s.jsxs(n,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:[`${b("quoteDetail.message.message")} `,0!==N&&s.jsx(n,{sx:{display:"flex",justifyContent:"center",alignItems:"center",width:"20px",height:"20px",borderRadius:"50%",background:m||"#1976D2",color:"#fff",fontSize:"12px",ml:"8px"},children:N})]}),[m,N]);p.useEffect(()=>{R(e)},[e]),p.useEffect(()=>{C.current&&q.length&&(C.current.scrollTop=C.current.scrollHeight)},[q]);const B=async e=>{try{k(!0);const{quoteUpdate:{quote:{trackingHistory:r}}}=await _({id:Number(t),quoteData:{message:e,lastMessage:parseInt(""+(new Date).getTime()/1e3,10),userEmail:c||"",storeHash:j}});P(""),S(0),R(r)}finally{k(!1)}},F=p.useCallback(r=>{if(r){if(!E&&l)return;0===w.current&&e.length&&_({id:Number(t),quoteData:{lastMessage:e[e.length-1]?.date,userEmail:c||"",storeHash:j}}),S(0),C.current&&(C.current.scrollTop=C.current.scrollHeight),w.current+=1}},[c,t,l,e,E]);return p.useEffect(()=>{d({type:"common",payload:{quoteDetailHasNewMessages:0!==N}})},[N]),s.jsx(i,{children:s.jsx(a,{sx:{p:"16px !important"},children:s.jsxs(J,{handleOnChange:F,title:A,children:[s.jsxs(n,{sx:{padding:"16px 0"},children:[s.jsx(n,{sx:{position:"relative",color:"rgba(0, 0, 0, 0.6)",opacity:.6,textAlign:"left",width:"100%",fontSize:"14px"},children:b("quoteDetail.message.merchantAnswers")}),s.jsx(n,{ref:C,sx:{mt:"20px",maxHeight:"280px",overflowY:"auto","&::-webkit-scrollbar":{display:"none"}},children:q.map((e,t)=>s.jsxs(n,{children:[s.jsx(be,{msg:e,isEndMessage:t===q.length-1,isCustomer:!!e.isCustomer}),e.date&&s.jsx(je,{msg:e})]},e.key))})]}),4!==u&&E&&s.jsx(y,{isSpinning:T,spinningHeight:50,size:10,isCloseLoading:!0,tip:"waiting..",children:s.jsxs(n,{sx:{display:"flex",width:"100%"},children:[s.jsx(o,{onKeyDown:e=>{"Enter"===e.key&&B(e.target.value||"")},sx:{width:"100%","& .MuiFormLabel-root":{color:"rgba(0, 0, 0, 0.38)"},"& input":{padding:"1.5rem 0.7rem 0.5rem"}},value:v,onChange:e=>{P(e.target.value)},size:"small",label:b("quoteDetail.message.typeMessage"),variant:"filled"}),s.jsx(n,{onClick:()=>B(v),sx:{width:"42px",height:"36px",margin:"10px 0 0 10px",background:"#BAD6F2",borderRadius:"50%"},children:s.jsx(ne,{sx:{height:"18px",width:"18px",margin:"8px 0 0 9px",color:"#0000008A"},fontSize:"small"})})]})})]})})})}const we=async({role:e,proceedingCheckoutFn:t,location:r,quoteId:s,navigate:n})=>{try{if(C.dispatch(w("")),t())return;const{storefrontProductSettings:{hidePriceFromGuests:i}}=await W();if(i&&100===Number(e)&&n)return C.dispatch(w(r.pathname+r.search)),void n("/login");const a=q(r.search,"date"),o=await G({id:Number(s)});le(s,a);const{quoteCheckout:{quoteCheckout:{checkoutUrl:l,cartId:c}}}=o;if("bigcommerce"===D)return void(window.location.href=l);if("catalyst"===D)return void(window.location.href=`/checkout?cartId=${c}`);await ce(c,l)}catch(i){V.error(i)}};function qe(e){const{quoteId:t,role:r,isAgenting:i,status:a,proceedingCheckoutFn:o}=e,[l]=N(),c=h(),u=ue(),d=de(),p=l?{alignItems:"flex-end",flexDirection:"column"}:{alignItems:"center"};return 5!==a?s.jsx(n,{sx:{position:"fixed",bottom:l&&i?"52px":0,left:0,backgroundColor:"#fff",width:"100%",padding:"0.8rem 1rem",height:"auto",display:"flex",zIndex:"999",justifyContent:l?"center":"flex-end",displayPrint:"none",...p},children:s.jsx(S,{variant:"contained",onClick:()=>{we({proceedingCheckoutFn:o,role:r,location:u,quoteId:t,navigate:d})},sx:{width:l?"100%":"auto"},children:c("quoteDetail.footer.proceedToCheckout")})}):null}const De=d("div")(()=>({display:"flex",alignItems:"center",marginTop:"0.5rem"}));function Ne(e){const[t]=N(),i=h(),{status:a,quoteNumber:o,issuedAt:l,expirationDate:d,exportPdf:m,printQuote:x,role:g,salesRepInfo:f}=e,{state:{portalStyle:{backgroundColor:y="#FEF9F5"}}}=p.useContext(v),b=P(y),j=r().palette.primary.main,C=de(),w=e=>t?{}:{xs:e};return s.jsxs(s.Fragment,{children:[100!==Number(g)&&s.jsx(n,{sx:{marginBottom:"10px",width:"fit-content",displayPrint:"none"},children:s.jsxs(n,{sx:{color:"#1976d2",cursor:"pointer",display:"flex",alignItems:"center"},onClick:()=>{C("/quotes")},children:[s.jsx(ie,{fontSize:"small",sx:{fontSize:"12px",marginRight:"0.5rem",color:j}}),s.jsx("p",{style:{color:j,margin:"0"},children:i("quoteDetail.header.backToQuoteLists")})]})}),s.jsxs(c,{container:!0,spacing:2,sx:{display:"flex",justifyContent:"space-between",flexDirection:t?"column":"row",mb:t?"16px":""},children:[s.jsxs(c,{item:!0,...w(8),sx:{color:b},children:[s.jsxs(n,{sx:{display:"flex",alignItems:t?"start":"center",flexDirection:t?"column":"row"},children:[s.jsx(u,{sx:{marginRight:"10px",fontSize:"34px",color:T(b,.87)},children:i("quoteDetail.header.quoteNumber",{quoteNumber:o||""})}),s.jsx(K,{code:a})]}),(f?.salesRepName||f?.salesRepEmail)&&s.jsxs(De,{children:[s.jsx(u,{variant:"subtitle2",sx:{marginRight:"0.5rem",fontSize:"16px"},children:i("quoteDetail.header.salesRep")}),s.jsx("span",{children:""!==f?.salesRepEmail?`${f?.salesRepName}(${f?.salesRepEmail})`:f?.salesRepName})]}),s.jsxs(n,{children:[s.jsxs(De,{children:[s.jsx(u,{variant:"subtitle2",sx:{marginRight:"0.5rem",fontSize:"16px"},children:i("quoteDetail.header.issuedOn")}),s.jsx("span",{children:`${l?k(Number(l)):""}`})]}),s.jsxs(De,{children:[s.jsx(u,{variant:"subtitle2",sx:{marginRight:"0.5rem",fontSize:"16px"},children:i("quoteDetail.header.expirationDate")}),s.jsx("span",{children:`${d?k(Number(d)):""}`})]})]})]}),100!==Number(g)&&s.jsx(c,{item:!0,sx:{textAlign:t?"none":"end",displayPrint:"none"},...w(4),children:s.jsxs(n,{children:[s.jsx(S,{variant:"outlined",sx:{marginRight:"1rem",displayPrint:"none"},onClick:x,children:i("quoteDetail.header.print")}),s.jsx(S,{variant:"outlined",onClick:m,children:i("quoteDetail.header.downloadPDF")})]})})]})]})}function Se({quoteSummary:{originalSubtotal:e,discount:t,tax:r,shipping:o,totalAmount:l},quoteDetailTax:d=0,status:p,quoteDetail:m,isHideQuoteCheckout:x}){const f=h(),y=g(({storeConfigs:e})=>e.currencies.enteredInclusiveTax),b=g(({global:e})=>e.showInclusiveTaxPrice),j=(e,t)=>y?b?e:e-t:b?e+t:e,C=e=>I(e,{currency:m.currency,isConversionRate:!1,useCurrentCurrency:!!m.currency}),w=m?.shippingMethod?.id?{shippingText:`${f("quoteDetail.summary.shipping")}(${m?.shippingMethod?.description||""})`,shippingVal:C(Number(o)),taxText:f("quoteDetail.summary.tax"),taxVal:C(Number(r))}:m?.salesRepEmail||m?.shippingMethod?.id||1!==Number(p)?!m?.salesRepEmail||m?.shippingMethod?.id||1!==Number(p)&&5!==Number(p)?null:{shippingText:`${f("quoteDetail.summary.shipping")}(${f("quoteDetail.summary.quoteCheckout")})`,shippingVal:f("quoteDetail.summary.tbd"),taxText:f("quoteDetail.summary.tax"),taxVal:f("quoteDetail.summary.tbd")}:{shippingText:f("quoteDetail.summary.shipping"),shippingVal:f("quoteDetail.summary.tbd"),taxText:f("quoteDetail.summary.estimatedTax"),taxVal:C(Number(r))},q=e=>x?f("quoteDraft.quoteSummary.tbd"):e,D=Number(e),N=Number(e)-Number(t);return s.jsx(i,{children:s.jsx(a,{children:s.jsxs(n,{children:[s.jsx(u,{variant:"h5",children:f("quoteDetail.summary.quoteSummary")}),s.jsxs(n,{sx:{marginTop:"20px",color:"#212121"},children:[m?.displayDiscount&&s.jsxs(c,{container:!0,justifyContent:"space-between",sx:{margin:"4px 0"},children:[s.jsx(u,{children:f("quoteDetail.summary.originalSubtotal")}),s.jsx(u,{children:q(C(j(D,d)))})]}),m?.salesRepEmail||1!==Number(p)?s.jsxs(c,{container:!0,justifyContent:"space-between",sx:{margin:"4px 0",display:m?.displayDiscount?"":"none"},children:[s.jsx(u,{children:f("quoteDetail.summary.discountAmount")}),s.jsx(u,{children:Number(t)>0?`-${C(Number(t))}`:C(Number(t))})]}):null,s.jsxs(c,{container:!0,justifyContent:"space-between",sx:{margin:"4px 0"},children:[s.jsx(u,{sx:{fontWeight:"bold",color:"#212121"},children:f("quoteDetail.summary.quotedSubtotal")}),s.jsx(u,{sx:{fontWeight:"bold",color:"#212121"},children:q(C(j(N,d)))})]}),w&&s.jsxs(s.Fragment,{children:[s.jsxs(c,{container:!0,justifyContent:"space-between",sx:{margin:"4px 0"},children:[s.jsx(u,{sx:{maxWidth:"70%",wordBreak:"break-word"},children:w.shippingText}),s.jsx(u,{children:q(w.shippingVal)})]}),s.jsxs(c,{container:!0,justifyContent:"space-between",sx:{margin:"4px 0"},children:[s.jsx(u,{children:w.taxText}),s.jsx(u,{children:q(w.taxVal)})]})]}),s.jsxs(c,{container:!0,justifyContent:"space-between",sx:{margin:"24px 0 0"},children:[s.jsx(u,{sx:{fontWeight:"bold",color:"#212121"},children:f("quoteDetail.summary.grandTotal")}),s.jsx(u,{sx:{fontWeight:"bold",color:"#212121"},children:q(C(Number(l)))})]})]})]})})})}const ve=d("img")(()=>({maxWidth:"60px",height:"auto",marginRight:"0.5rem"}));function Pe(e){const{item:t,len:r,itemIndex:i,getTaxRate:o,showPrice:l,currency:c,displayDiscount:d}=e,p=h(),m=g(({storeConfigs:e})=>e.currencies.enteredInclusiveTax),{basePrice:x,quantity:f,imageUrl:y,productName:b,options:j,sku:C,notes:w,offeredPrice:q,productsSearch:{productUrl:D,variants:N=[],taxClassId:S}}=t,v=o(S,N),P=m?Number(x)*v/(1+v):Number(x)*v,T=m?Number(q)*v/(1+v):Number(q)*v,k=E(Number(x),P),A=E(Number(q),T),B=Number(x)-Number(q)>0&&d,F=Number(k)*Number(f),$=A*Number(f);return s.jsx(n,{width:"100%",sx:{borderTop:"1px solid #D9DCE9",borderBottom:i===r-1?"1px solid #D9DCE9":""},children:s.jsxs(a,{sx:{color:"#313440",display:"flex",pl:0},children:[s.jsx(n,{children:s.jsx(ve,{src:y||R,alt:"Product-img",loading:"lazy"})}),s.jsxs(n,{sx:{flex:1},children:[s.jsx(u,{variant:"body1",color:"#212121",onClick:()=>{const{location:{origin:e}}=window;D&&(window.location.href=`${e}${D}`)},sx:{cursor:"pointer"},children:b}),s.jsx(u,{variant:"body1",color:"#616161",children:C}),s.jsx(n,{sx:{margin:"1rem 0"},children:j.length>0&&s.jsx(n,{children:j.map(e=>s.jsx(u,{sx:{fontSize:"0.75rem",lineHeight:"1.5",color:"#455A64"},children:`${e.optionName}: ${e.optionLabel}`},e.optionName))})}),s.jsx(u,{variant:"body1",color:"#616161",children:w}),s.jsxs(u,{sx:{fontSize:"14px"},children:[p("quoteDetail.tableCard.price"),B&&s.jsx("span",{style:{marginLeft:"5px",textDecoration:"line-through"},children:`${l(I(k,{currency:c}),t)}`}),s.jsx("span",{style:{marginLeft:"5px",color:B?"#2E7D32":"#212121"},children:`${l(I(q,{currency:c}),t)}`})]}),s.jsx(u,{sx:{padding:"12px 0",fontSize:"14px"},children:p("quoteDetail.tableCard.qty",{quantity:f})}),s.jsxs(u,{sx:{fontSize:"14px"},children:[p("quoteDetail.tableCard.total"),B&&s.jsx("span",{style:{marginLeft:"5px",textDecoration:"line-through"},children:`${l(I(F,{currency:c}),t)}`}),s.jsx("span",{style:{marginLeft:"5px",color:B?"#2E7D32":"#212121"},children:`${l(I($,{currency:c}),t)}`})]})]})]})},t.id)}const Te=d("div")(()=>({backgroundColor:"#FFFFFF",padding:"1rem",width:"100%",border:"1px solid #E0E0E0",boxShadow:"0px 2px 1px -1px rgba(0, 0, 0, 0.2), 0px 1px 1px rgba(0, 0, 0, 0.14), 0px 1px 3px rgba(0, 0, 0, 0.12)",borderRadius:"4px","& tbody":{"& tr":{"& td":{verticalAlign:"top"},"& td: first-of-type":{verticalAlign:"inherit"}},"& tr: hover":{"& #shoppingList-actionList":{opacity:1}}}})),ke=d("img")(()=>({maxWidth:"60px",height:"auto",marginRight:"0.5rem"})),Ie=p.forwardRef(function(e,t){const r=h(),{total:i,getQuoteTableDetails:a,getTaxRate:o,isHandleApprove:l,displayDiscount:c,currency:d}=e,m=g(({global:e})=>e.blockPendingQuoteNonPurchasableOOS.isEnableProduct),x=g(({storeConfigs:e})=>e.currencies.enteredInclusiveTax),f=p.useRef(null),[y,b]=p.useState({first:12,offset:0});p.useImperativeHandle(t,()=>({getList:()=>f.current?.getList(),refreshList:()=>{b({offset:0})}}));const j=(e,t)=>m?l?e:B({price:e,productInfo:t,showText:r("quoteDraft.quoteSummary.tbd")}):e,C=[{key:"Product",title:r("quoteDetail.table.product"),render:e=>{const t=e.options,r=e.productsSearch?.productUrl;return s.jsxs(n,{sx:{display:"flex",alignItems:"flex-start"},children:[s.jsx(ke,{src:e.imageUrl||R,alt:"Product-img",loading:"lazy"}),s.jsxs(n,{children:[s.jsx(u,{variant:"body1",color:"#212121",onClick:()=>{const{location:{origin:e}}=window;r&&(window.location.href=`${e}${r}`)},sx:{cursor:"pointer"},children:e.productName}),s.jsx(u,{variant:"body1",color:"#616161",children:e.sku}),t.length>0&&s.jsx(n,{children:t.map(e=>e.optionLabel&&s.jsxs(u,{sx:{fontSize:"0.75rem",lineHeight:"1.5",color:"#455A64"},children:[e.optionName,": ",e.optionLabel]},`${e.optionId}_${e.optionName}_${e.optionLabel}`))}),e.notes&&s.jsxs(u,{variant:"body1",color:"#ED6C02",sx:{fontSize:"0.9rem",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:[s.jsx("span",{children:"Notes: "}),e.notes]})]})]})},width:"40%"},{key:"Price",title:r("quoteDetail.table.price"),render:e=>{const{basePrice:t,offeredPrice:r,productsSearch:{variants:n=[],taxClassId:i}}=e,a=o(i,n),l=x?Number(t)*a/(1+a):Number(t)*a,p=x?Number(r)*a/(1+a):Number(r)*a,m=E(Number(t),l),h=E(Number(r),p),g=Number(t)-Number(r)>0&&c;return s.jsxs(s.Fragment,{children:[g&&s.jsx(u,{sx:{padding:"12px 0 0 0",textDecoration:"line-through"},children:j(I(m,{currency:d,isConversionRate:!1,useCurrentCurrency:!!d}),e)}),s.jsx(u,{sx:{padding:g?"0":"12px 0 0 0",color:g?"#2E7D32":"#212121"},children:j(I(h,{currency:d,isConversionRate:!1,useCurrentCurrency:!!d}),e)})]})},width:"15%",style:{textAlign:"right"}},{key:"Qty",title:r("quoteDetail.table.qty"),render:e=>s.jsx(u,{sx:{padding:"12px 0"},children:e.quantity}),width:"15%",style:{textAlign:"right"}},{key:"Total",title:r("quoteDetail.table.total"),render:e=>{const{basePrice:t,quantity:r,offeredPrice:i,productsSearch:{variants:a=[],taxClassId:l}}=e,p=o(l,a),m=x?Number(t)*p/(1+p):Number(t)*p,h=x?Number(i)*p/(1+p):Number(i)*p,g=E(Number(t),m),f=E(Number(i),h),y=Number(t)-Number(i)>0&&c,b=g*Number(r),C=f*Number(r);return s.jsxs(n,{children:[y&&s.jsx(u,{sx:{padding:"12px 0 0 0",textDecoration:"line-through"},children:j(I(b,{currency:d,isConversionRate:!1,useCurrentCurrency:!!d}),e)}),s.jsx(u,{sx:{padding:y?"0":"12px 0 0 0",color:y?"#2E7D32":"#212121"},children:j(I(C,{currency:d,isConversionRate:!1,useCurrentCurrency:!!d}),e)})]})},width:"20%",style:{textAlign:"right"}}];return s.jsxs(Te,{children:[s.jsx(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",margin:"0.5rem 0 1rem 0"},children:s.jsx(u,{sx:{fontSize:"24px"},children:r("quoteDetail.table.totalProducts",{total:i||0})})}),s.jsx(A,{ref:f,columnItems:C,rowsPerPageOptions:[12,24,36],getRequestList:a,isCustomRender:!1,hover:!0,searchParams:y,labelRowsPerPage:r("quoteDetail.table.perPage"),showBorder:!1,itemIsMobileSpacing:0,noDataText:r("quoteDetail.table.noProducts"),tableKey:"productId",renderItem:(e,t)=>s.jsx(Pe,{len:i||0,item:e,showPrice:j,itemIndex:t,currency:d,displayDiscount:c,getTaxRate:o})})]})});function Ee(e){const{quoteLegalTerms:t=""}=e,[r,o]=p.useState(!1),l=h();return s.jsx(i,{sx:{".MuiCardContent-root":{maxHeight:r?"637px":"auto"}},children:s.jsx(a,{sx:{p:"16px !important"},children:s.jsx(J,{title:l("quoteDetail.termsAndConditions"),handleOnChange:e=>{o(e)},children:s.jsx(n,{children:s.jsx(u,{variant:"body1",sx:{padding:"16px 0",maxHeight:"545px",whiteSpace:"pre-wrap",overflow:"auto"},children:t})})})})})}}}});
//# sourceMappingURL=index-legacy-BGrd1TS3.js.map
