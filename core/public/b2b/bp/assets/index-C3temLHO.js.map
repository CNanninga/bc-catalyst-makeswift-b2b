{"version":3,"file":"index-C3temLHO.js","sources":["../../src/components/B3QuantityTextField.tsx","../../src/pages/ShoppingListDetails/components/AddToShoppingList.tsx","../../src/pages/ShoppingListDetails/components/ReAddToCart.tsx","../../src/pages/ShoppingListDetails/components/ShoppingDetailDeleteItems.tsx","../../src/pages/ShoppingListDetails/components/ShoppingDetailFooter.tsx","../../src/pages/ShoppingListDetails/components/ShoppingDetailHeader.tsx","../../src/pages/ShoppingListDetails/components/ShoppingDetailAddNotes.tsx","../../src/pages/ShoppingListDetails/components/ShoppingDetailCard.tsx","../../src/pages/ShoppingListDetails/components/ShoppingDetailTable.tsx","../../src/pages/ShoppingListDetails/index.tsx"],"sourcesContent":["import { useCallback, useEffect, useState } from 'react';\n\nimport { useMobile } from '@/hooks';\n\nimport { StyledNumberNoTopTextField } from './styled';\n\ninterface B3NumberTextFieldProps {\n  disabled?: boolean;\n  label?: string;\n  value?: number | string;\n  maxQuantity?: number;\n  minQuantity?: number;\n  isStock?: string;\n  stock?: number;\n  hiddenLabel?: boolean;\n  onChange?: (value: number | string, isValid: boolean) => void;\n  sx?: CustomFieldItems;\n}\n\nexport default function B3QuantityTextField(props: B3NumberTextFieldProps) {\n  const [isMobile] = useMobile();\n\n  const {\n    disabled = false,\n    label = isMobile ? 'Qty' : '',\n    value = '',\n    maxQuantity = 0,\n    minQuantity = 0,\n    isStock = '0',\n    stock = 0,\n    hiddenLabel = !isMobile,\n    onChange = () => {},\n    sx = {\n      width: isMobile ? '110px' : '72px',\n      '& .MuiFormHelperText-root': {\n        marginLeft: '0',\n        marginRight: '0',\n      },\n    },\n  } = props;\n\n  const [validMessage, setValidMessage] = useState('');\n\n  const validateQuantity = useCallback(\n    (value: number | string) => {\n      const quantity = parseInt(`${value}`, 10) || 0;\n\n      let validMessage = '';\n\n      if (isStock === '1' && stock === 0) {\n        validMessage = 'Out of stock';\n      } else if (isStock === '1' && quantity > stock) {\n        validMessage = `${stock} in stock`;\n      } else if (minQuantity !== 0 && quantity < minQuantity) {\n        validMessage = `Min is ${minQuantity}`;\n      } else if (maxQuantity !== 0 && quantity > maxQuantity) {\n        validMessage = `Max is ${maxQuantity}`;\n      }\n\n      setValidMessage(validMessage);\n\n      return validMessage;\n    },\n    [isStock, maxQuantity, minQuantity, stock],\n  );\n\n  const handleChange = (value: string) => {\n    onChange(value, !!validMessage);\n  };\n\n  const handleBlur = () => {\n    const quantity = parseInt(`${value}`, 10) || 0;\n\n    onChange(quantity, !validateQuantity(quantity));\n  };\n\n  useEffect(() => {\n    validateQuantity(value);\n  }, [validateQuantity, value]);\n\n  return (\n    <StyledNumberNoTopTextField\n      size=\"small\"\n      type=\"number\"\n      variant=\"filled\"\n      disabled={disabled}\n      hiddenLabel={hiddenLabel}\n      label={label}\n      value={value}\n      error={!!validMessage}\n      helperText={validMessage}\n      inputProps={{\n        inputMode: 'numeric',\n        pattern: '[0-9]*',\n      }}\n      onChange={(e) => {\n        handleChange(e.target.value);\n      }}\n      onBlur={() => {\n        handleBlur();\n      }}\n      sx={sx}\n    />\n  );\n}\n","import { useContext, useState } from 'react';\nimport { UploadFile as UploadFileIcon } from '@mui/icons-material';\nimport { Box, Card, CardContent, Divider, Typography } from '@mui/material';\n\nimport { B3Upload } from '@/components';\nimport CustomButton from '@/components/button/CustomButton';\nimport { dispatchEvent, useBlockPendingAccountViewPrice } from '@/hooks';\nimport { useB3Lang } from '@/lib/lang';\nimport { addProductToBcShoppingList, addProductToShoppingList } from '@/shared/service/b2b';\nimport { useAppSelector } from '@/store';\nimport { snackbar } from '@/utils';\nimport { getValidOptionsList } from '@/utils/b3Product/b3Product';\n\nimport { getAllModifierDefaultValue } from '../../../utils/b3Product/shared/config';\nimport { ShoppingListDetailsContext } from '../context/ShoppingListDetailsContext';\n\nimport QuickAdd from './QuickAdd';\nimport SearchProduct from './SearchProduct';\n\ninterface AddToListProps {\n  updateList: () => void;\n  isB2BUser: boolean;\n  type?: string;\n}\n\nexport default function AddToShoppingList(props: AddToListProps) {\n  const {\n    state: { id },\n  } = useContext(ShoppingListDetailsContext);\n\n  const companyStatus = useAppSelector(({ company }) => company.companyInfo.status);\n  const { updateList, isB2BUser, type: pageType = '' } = props;\n  const b3Lang = useB3Lang();\n\n  const [isOpenBulkLoadCSV, setIsOpenBulkLoadCSV] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n\n  const [blockPendingAccountViewPrice] = useBlockPendingAccountViewPrice();\n\n  const addItemsToShoppingList = isB2BUser ? addProductToShoppingList : addProductToBcShoppingList;\n\n  const addToList = async (products: CustomFieldItems[]) => {\n    try {\n      if (!dispatchEvent('on-add-to-shopping-list', products)) {\n        throw new Error();\n      }\n\n      const items = products.map((product) => {\n        const newOptionLists = getValidOptionsList(product.newSelectOptionList, product);\n        return {\n          optionList: newOptionLists,\n          productId: product.id,\n          quantity: product.quantity,\n          variantId: product.variantId,\n        };\n      });\n\n      await addItemsToShoppingList({\n        shoppingListId: id,\n        items,\n      });\n\n      snackbar.success(b3Lang('shoppingList.addToShoppingList.productsAdded'));\n    } catch (e: any) {\n      if (e.message.length > 0) {\n        snackbar.error(e.message);\n      }\n    }\n  };\n\n  const quickAddToList = async (products: CustomFieldItems[]) => {\n    const items = products.map((product) => {\n      const newOptionLists = getValidOptionsList(\n        product.newSelectOptionList || product.optionList,\n        product?.products || product,\n      );\n      return {\n        optionList: newOptionLists || [],\n        productId: parseInt(product.productId, 10) || 0,\n        quantity: product.quantity,\n        variantId: parseInt(product.variantId, 10) || 0,\n      };\n    });\n\n    await addItemsToShoppingList({\n      shoppingListId: id,\n      items,\n    });\n\n    snackbar.success(b3Lang('shoppingList.addToShoppingList.productsAdded'));\n  };\n\n  const getValidProducts = (products: CustomFieldItems) => {\n    const notPurchaseSku: string[] = [];\n    const productItems: CustomFieldItems[] = [];\n    const notAddAble: string[] = [];\n\n    products.forEach((item: CustomFieldItems) => {\n      const { products: currentProduct, qty } = item;\n      const { option, purchasingDisabled, variantSku, variantId, productId, modifiers } =\n        currentProduct;\n\n      const defaultModifiers = getAllModifierDefaultValue(modifiers);\n      if (purchasingDisabled && pageType !== 'shoppingList') {\n        notPurchaseSku.push(variantSku);\n        return;\n      }\n\n      const notPassedModifier = defaultModifiers.filter(\n        (modifier: CustomFieldItems) => !modifier.isVerified,\n      );\n      if (notPassedModifier.length > 0) {\n        notAddAble.push(variantSku);\n\n        return;\n      }\n\n      const optionsList = option.map((item: CustomFieldItems) => ({\n        optionId: `attribute[${item.option_id}]`,\n        optionValue: item.id.toString(),\n      }));\n\n      defaultModifiers.forEach((modifier: CustomFieldItems) => {\n        const { type } = modifier;\n\n        if (type === 'date') {\n          const { defaultValue } = modifier;\n          Object.keys(defaultValue).forEach((key) => {\n            optionsList.push({\n              optionId: `attribute[${modifier.option_id}][${key}]`,\n              optionValue: `${modifier.defaultValue[key]}`,\n            });\n          });\n        } else {\n          optionsList.push({\n            optionId: `attribute[${modifier.option_id}]`,\n            optionValue: `${modifier.defaultValue}`,\n          });\n        }\n      });\n\n      productItems.push({\n        productId: parseInt(productId, 10) || 0,\n        variantId: parseInt(variantId, 10) || 0,\n        quantity: Number(qty),\n        optionList: optionsList,\n        products: item.products,\n      });\n    });\n\n    return {\n      notPurchaseSku,\n      productItems,\n      notAddAble,\n    };\n  };\n\n  const handleCSVAddToList = async (productsData: CustomFieldItems) => {\n    setIsLoading(true);\n    try {\n      const { validProduct } = productsData;\n\n      const { notPurchaseSku, productItems, notAddAble } = getValidProducts(validProduct);\n\n      if (productItems.length > 0) {\n        await quickAddToList(productItems);\n\n        updateList();\n      }\n\n      if (notAddAble.length > 0 && pageType !== 'shoppingList') {\n        snackbar.error(\n          b3Lang('shoppingList.addToShoppingList.skuNotAddable', {\n            notAddAble: notAddAble.join(', '),\n          }),\n        );\n      }\n\n      if (notPurchaseSku.length > 0 && pageType !== 'shoppingList') {\n        snackbar.error(\n          b3Lang('shoppingList.addToShoppingList.skuNotPurchasable', {\n            notPurchaseSku: notPurchaseSku.join(', '),\n          }),\n        );\n      }\n\n      setIsOpenBulkLoadCSV(false);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleOpenUploadDiag = () => {\n    if (blockPendingAccountViewPrice && companyStatus === 0) {\n      snackbar.info(\n        'Your business account is pending approval. This feature is currently disabled.',\n      );\n    } else {\n      setIsOpenBulkLoadCSV(true);\n    }\n  };\n\n  return (\n    <Card\n      sx={{\n        marginBottom: '50px',\n      }}\n    >\n      <CardContent>\n        <Box>\n          <Typography variant=\"h5\">{b3Lang('shoppingList.addToShoppingList.addToList')}</Typography>\n          <SearchProduct updateList={updateList} addToList={addToList} type=\"shoppingList\" />\n\n          <Divider />\n\n          <QuickAdd type=\"shoppingList\" updateList={updateList} quickAddToList={quickAddToList} />\n\n          <Divider />\n\n          <Box\n            sx={{\n              margin: '20px 0 0',\n            }}\n          >\n            <CustomButton variant=\"text\" onClick={() => handleOpenUploadDiag()}>\n              <UploadFileIcon\n                sx={{\n                  marginRight: '8px',\n                }}\n              />\n              {b3Lang('shoppingList.addToShoppingList.bulkUploadCsv')}\n            </CustomButton>\n          </Box>\n\n          <B3Upload\n            isOpen={isOpenBulkLoadCSV}\n            setIsOpen={setIsOpenBulkLoadCSV}\n            handleAddToList={handleCSVAddToList}\n            isLoading={isLoading}\n            withModifiers\n          />\n        </Box>\n      </CardContent>\n    </Card>\n  );\n}\n","import { useEffect, useState } from 'react';\nimport styled from '@emotion/styled';\nimport { Delete } from '@mui/icons-material';\nimport { Alert, Box, Grid, Typography } from '@mui/material';\n\nimport { B3QuantityTextField } from '@/components';\nimport B3Dialog from '@/components/B3Dialog';\nimport CustomButton from '@/components/button/CustomButton';\nimport B3Spin from '@/components/spin/B3Spin';\nimport { CART_URL, CHECKOUT_URL, PRODUCT_DEFAULT_IMAGE } from '@/constants';\nimport { useMobile } from '@/hooks';\nimport { useB3Lang } from '@/lib/lang';\nimport { activeCurrencyInfoSelector, rolePermissionSelector, useAppSelector } from '@/store';\nimport { ShoppingListStatus } from '@/types/shoppingList';\nimport { currencyFormat, snackbar } from '@/utils';\nimport { setModifierQtyPrice } from '@/utils/b3Product/b3Product';\nimport {\n  addLineItems,\n  getProductOptionsFields,\n  ProductsProps,\n} from '@/utils/b3Product/shared/config';\nimport b3TriggerCartNumber from '@/utils/b3TriggerCartNumber';\nimport { createOrUpdateExistingCart } from '@/utils/cartUtils';\n\ninterface ShoppingProductsProps {\n  shoppingListInfo: any;\n  role: string | number;\n  products: ProductsProps[];\n  successProducts: number;\n  allowJuniorPlaceOrder: boolean;\n  getProductQuantity?: (item: ProductsProps) => number;\n  onProductChange?: (products: ProductsProps[]) => void;\n  setValidateFailureProducts: (arr: ProductsProps[]) => void;\n  setValidateSuccessProducts: (arr: ProductsProps[]) => void;\n  textAlign?: string;\n  backendValidationEnabled: boolean;\n}\n\ninterface FlexProps {\n  isHeader?: boolean;\n  isMobile?: boolean;\n}\n\ninterface FlexItemProps {\n  width?: string;\n  padding?: string;\n  flexBasis?: string;\n  alignItems?: string;\n  flexDirection?:\n    | 'column'\n    | 'inherit'\n    | '-moz-initial'\n    | 'initial'\n    | 'revert'\n    | 'unset'\n    | 'column-reverse'\n    | 'row'\n    | 'row-reverse';\n  textAlignLocation?: string;\n}\n\nconst Flex = styled('div')<FlexProps>(({ isHeader, isMobile }) => {\n  const headerStyle = isHeader\n    ? {\n        borderBottom: '1px solid #D9DCE9',\n        paddingBottom: '8px',\n        alignItems: 'center',\n      }\n    : {\n        alignItems: 'flex-start',\n      };\n\n  const mobileStyle = isMobile\n    ? {\n        borderTop: '1px solid #D9DCE9',\n        padding: '12px 0 12px',\n        '&:first-of-type': {\n          marginTop: '12px',\n        },\n      }\n    : {};\n\n  const flexWrap = isMobile ? 'wrap' : 'initial';\n\n  return {\n    display: 'flex',\n    wordBreak: 'break-word',\n    padding: '8px 0 0',\n    gap: '8px',\n    flexWrap,\n    ...headerStyle,\n    ...mobileStyle,\n  };\n});\n\nconst FlexItem = styled(Box)(\n  ({\n    width,\n    padding = '0',\n    flexBasis,\n    flexDirection = 'row',\n    alignItems,\n    textAlignLocation,\n  }: FlexItemProps) => ({\n    display: 'flex',\n    justifyContent: textAlignLocation === 'right' ? 'flex-end' : 'flex-start',\n    flexDirection,\n    flexGrow: width ? 0 : 1,\n    flexShrink: width ? 0 : 1,\n    alignItems: alignItems || 'flex-start',\n    flexBasis,\n    width,\n    padding,\n  }),\n);\n\nconst ProductHead = styled('div')(() => ({\n  fontSize: '0.875rem',\n  lineHeight: '1.5',\n  color: '#263238',\n}));\n\nconst ProductImage = styled('img')(() => ({\n  width: '60px',\n  borderRadius: '4px',\n  flexShrink: 0,\n}));\n\nconst defaultItemStyle = {\n  default: {\n    width: '15%',\n  },\n  qty: {\n    width: '80px',\n  },\n  delete: {\n    width: '30px',\n  },\n};\n\nconst mobileItemStyle = {\n  default: {\n    width: '100%',\n    padding: '0 0 0 76px',\n  },\n  qty: {\n    width: '100%',\n    padding: '0 0 0 76px',\n  },\n  delete: {\n    width: '100%',\n    padding: '0 0 0 76px',\n    display: 'flex',\n    flexDirection: 'row-reverse',\n  },\n};\n\nexport default function ReAddToCart(props: ShoppingProductsProps) {\n  const {\n    shoppingListInfo,\n    products,\n    successProducts,\n    allowJuniorPlaceOrder,\n    setValidateFailureProducts,\n    setValidateSuccessProducts,\n    textAlign = 'left',\n    backendValidationEnabled,\n  } = props;\n\n  const { submitShoppingListPermission } = useAppSelector(rolePermissionSelector);\n\n  const b3Lang = useB3Lang();\n  const [isOpen, setOpen] = useState<boolean>(false);\n  const [loading, setLoading] = useState<boolean>(false);\n  const [isMobile] = useMobile();\n\n  const { decimal_places: decimalPlaces = 2 } = useAppSelector(activeCurrencyInfoSelector);\n\n  useEffect(() => {\n    if (products.length > 0) {\n      setOpen(true);\n    } else {\n      setOpen(false);\n    }\n  }, [products]);\n\n  const itemStyle = isMobile ? mobileItemStyle : defaultItemStyle;\n\n  const handleUpdateProductQty = async (\n    index: number,\n    value: number | string,\n    isValid: boolean,\n  ) => {\n    const newProduct: ProductsProps[] = [...products];\n    newProduct[index].node.quantity = Number(value);\n    newProduct[index].isValid = isValid;\n    const calculateProduct = await setModifierQtyPrice(newProduct[index].node, Number(value));\n    if (calculateProduct) {\n      (newProduct[index] as CustomFieldItems).node = calculateProduct;\n      setValidateFailureProducts(newProduct);\n    }\n  };\n\n  const handleCancelClicked = () => {\n    setOpen(false);\n    setValidateFailureProducts([]);\n    setValidateSuccessProducts([]);\n  };\n\n  const deleteProduct = (index: number) => {\n    const newProduct: ProductsProps[] = [...products];\n    newProduct.splice(index, 1);\n    setValidateFailureProducts(newProduct);\n  };\n\n  const shouldRedirectToCheckout = () => {\n    handleCancelClicked();\n    if (\n      allowJuniorPlaceOrder &&\n      submitShoppingListPermission &&\n      shoppingListInfo?.status === ShoppingListStatus.Approved\n    ) {\n      window.location.href = CHECKOUT_URL;\n    } else {\n      snackbar.success(b3Lang('shoppingList.reAddToCart.productsAdded'), {\n        action: {\n          label: b3Lang('shoppingList.reAddToCart.viewCart'),\n          onClick: () => {\n            if (window.b2b.callbacks.dispatchEvent('on-click-cart-button')) {\n              window.location.href = CART_URL;\n            }\n          },\n        },\n      });\n      b3TriggerCartNumber();\n    }\n  };\n\n  const handlePrimaryAction = async () => {\n    const isValidate = products.every((item: ProductsProps) => item.isValid);\n\n    if (!isValidate) {\n      snackbar.error(b3Lang('shoppingList.reAddToCart.fillCorrectQuantity'));\n      return;\n    }\n    try {\n      setLoading(true);\n\n      const lineItems = addLineItems(products);\n\n      const res = await createOrUpdateExistingCart(lineItems);\n\n      if (!res.errors) {\n        shouldRedirectToCheckout();\n      }\n\n      if (res.errors) {\n        snackbar.error(res.message);\n      }\n\n      b3TriggerCartNumber();\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleReAddToCartBackend = async () => {\n    setLoading(true);\n\n    try {\n      const lineItems = addLineItems(products);\n      const res = await createOrUpdateExistingCart(lineItems);\n\n      if (!res.errors) {\n        shouldRedirectToCheckout();\n      }\n\n      b3TriggerCartNumber();\n    } catch (e: unknown) {\n      if (e instanceof Error) {\n        snackbar.error(e.message);\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const addOrProceedToCheckout = async () => {\n    if (backendValidationEnabled) {\n      await handleReAddToCartBackend();\n    } else {\n      handlePrimaryAction();\n    }\n  };\n\n  // this need the information of the SearchGraphlQuery endpoint change\n  const handleClearNoStock = async () => {\n    const newProduct = products.filter(\n      (item: ProductsProps) => item.isStock === '0' || item.stock !== 0,\n    );\n    const requestArr: Promise<any>[] = [];\n    newProduct.forEach((product) => {\n      const item = product;\n      const {\n        node: { quantity },\n        minQuantity = 0,\n        maxQuantity = 0,\n        isStock,\n        stock,\n      } = product;\n\n      const quantityNumber = parseInt(`${quantity}`, 10) || 0;\n      if (minQuantity !== 0 && quantityNumber < minQuantity) {\n        item.node.quantity = minQuantity;\n      } else if (maxQuantity !== 0 && quantityNumber > maxQuantity) {\n        item.node.quantity = maxQuantity;\n      }\n      if (isStock !== '0' && stock && (quantity ? Number(quantity) : 0) > stock) {\n        item.node.quantity = stock;\n      }\n\n      item.isValid = true;\n\n      const qty = product?.node?.quantity ? Number(product.node.quantity) : 0;\n\n      requestArr.push(setModifierQtyPrice(product.node, qty));\n    });\n\n    const productArr = await Promise.all(requestArr);\n\n    productArr.forEach((item, index) => {\n      newProduct[index].node = item;\n    });\n    setValidateFailureProducts(newProduct);\n  };\n\n  return (\n    <B3Dialog\n      isOpen={isOpen}\n      handleLeftClick={handleCancelClicked}\n      handRightClick={addOrProceedToCheckout}\n      title={\n        allowJuniorPlaceOrder\n          ? b3Lang('shoppingList.reAddToCart.proceedToCheckout')\n          : b3Lang('shoppingList.reAddToCart.addToCart')\n      }\n      rightSizeBtn={\n        allowJuniorPlaceOrder\n          ? b3Lang('shoppingList.reAddToCart.proceedToCheckout')\n          : b3Lang('shoppingList.reAddToCart.addToCart')\n      }\n      maxWidth=\"xl\"\n    >\n      <Grid>\n        <Box\n          sx={{\n            m: '0 0 1rem 0',\n          }}\n        >\n          <Alert variant=\"filled\" severity=\"success\">\n            {allowJuniorPlaceOrder\n              ? b3Lang('shoppingList.reAddToCart.productsCanCheckout', {\n                  successProducts,\n                })\n              : b3Lang('shoppingList.reAddToCart.productsAddedToCart', {\n                  successProducts,\n                })}\n          </Alert>\n        </Box>\n\n        <Box\n          sx={{\n            m: '1rem 0',\n          }}\n        >\n          <Alert variant=\"filled\" severity=\"error\">\n            {allowJuniorPlaceOrder\n              ? b3Lang('shoppingList.reAddToCart.productsCantCheckout', {\n                  quantity: products.length,\n                })\n              : b3Lang('shoppingList.reAddToCart.productsNotAddedToCart', {\n                  quantity: products.length,\n                })}\n          </Alert>\n        </Box>\n        <B3Spin isSpinning={loading} size={16} isFlex={false}>\n          <Box\n            sx={{\n              display: 'flex',\n              justifyContent: 'space-between',\n              margin: '0.5rem 0 1rem 0',\n            }}\n          >\n            <Box\n              sx={{\n                fontSize: '24px',\n              }}\n            >\n              {b3Lang('shoppingList.reAddToCart.productCount', {\n                quantity: products.length,\n              })}\n            </Box>\n            <CustomButton onClick={() => handleClearNoStock()}>\n              {b3Lang('shoppingList.reAddToCart.adjustQuantity')}\n            </CustomButton>\n          </Box>\n\n          {products.length > 0 ? (\n            <Box>\n              {!isMobile && (\n                <Flex isHeader isMobile={isMobile}>\n                  <FlexItem>\n                    <ProductHead>{b3Lang('shoppingList.reAddToCart.product')}</ProductHead>\n                  </FlexItem>\n                  <FlexItem {...itemStyle.default} textAlignLocation={textAlign}>\n                    <ProductHead>{b3Lang('shoppingList.reAddToCart.price')}</ProductHead>\n                  </FlexItem>\n                  <FlexItem\n                    sx={{\n                      justifyContent: 'center',\n                    }}\n                    {...itemStyle.default}\n                    textAlignLocation={textAlign}\n                  >\n                    <ProductHead>{b3Lang('shoppingList.reAddToCart.quantity')}</ProductHead>\n                  </FlexItem>\n                  <FlexItem {...itemStyle.default} textAlignLocation={textAlign}>\n                    <ProductHead>{b3Lang('shoppingList.reAddToCart.total')}</ProductHead>\n                  </FlexItem>\n                  <FlexItem {...itemStyle.delete}>\n                    <ProductHead> </ProductHead>\n                  </FlexItem>\n                </Flex>\n              )}\n              {products.map((product: ProductsProps, index: number) => {\n                const { isStock, maxQuantity, minQuantity, stock } = product;\n\n                const {\n                  quantity = 1,\n                  primaryImage,\n                  productName,\n                  variantSku,\n                  optionList,\n                  productsSearch,\n                  basePrice,\n                } = product.node;\n\n                const price = Number(basePrice);\n                const total = (price * (quantity ? Number(quantity) : 0)).toFixed(decimalPlaces);\n\n                const newProduct: any = {\n                  ...productsSearch,\n                  selectOptions: optionList,\n                };\n\n                const productFields = getProductOptionsFields(newProduct, {});\n\n                const newOptionList = JSON.parse(optionList);\n                const optionsValue: CustomFieldItems[] = productFields.filter(\n                  (item) => item.valueText,\n                );\n\n                return (\n                  <Flex isMobile={isMobile} key={variantSku}>\n                    <FlexItem>\n                      <ProductImage src={primaryImage || PRODUCT_DEFAULT_IMAGE} />\n                      <Box\n                        sx={{\n                          marginLeft: '16px',\n                        }}\n                      >\n                        <Typography variant=\"body1\" color=\"#212121\">\n                          {productName}\n                        </Typography>\n                        <Typography variant=\"body1\" color=\"#616161\">\n                          {variantSku}\n                        </Typography>\n                        {newOptionList.length > 0 &&\n                          optionsValue.length > 0 &&\n                          optionsValue.map((option: CustomFieldItems) => (\n                            <Typography\n                              sx={{\n                                fontSize: '0.75rem',\n                                lineHeight: '1.5',\n                                color: '#455A64',\n                              }}\n                              key={option.valueLabel}\n                            >\n                              {`${option.valueLabel}: ${option.valueText}`}\n                            </Typography>\n                          ))}\n                      </Box>\n                    </FlexItem>\n                    <FlexItem {...itemStyle.default} textAlignLocation={textAlign}>\n                      {isMobile && <span>Price: </span>}\n                      {currencyFormat(price)}\n                    </FlexItem>\n                    <FlexItem {...itemStyle.default} textAlignLocation={textAlign}>\n                      <B3QuantityTextField\n                        isStock={isStock}\n                        maxQuantity={maxQuantity}\n                        minQuantity={minQuantity}\n                        stock={stock}\n                        value={quantity}\n                        onChange={(value, isValid) => {\n                          handleUpdateProductQty(index, value, isValid);\n                        }}\n                      />\n                    </FlexItem>\n                    <FlexItem {...itemStyle.default} textAlignLocation={textAlign}>\n                      {isMobile && <div>Total: </div>}\n                      {currencyFormat(total)}\n                    </FlexItem>\n\n                    <FlexItem {...itemStyle.delete}>\n                      <Delete\n                        sx={{\n                          cursor: 'pointer',\n                          color: 'rgba(0, 0, 0, 0.54)',\n                        }}\n                        onClick={() => {\n                          deleteProduct(index);\n                        }}\n                      />\n                    </FlexItem>\n                  </Flex>\n                );\n              })}\n            </Box>\n          ) : null}\n        </B3Spin>\n      </Grid>\n    </B3Dialog>\n  );\n}\n","import { Box } from '@mui/material';\n\nimport B3Dialog from '@/components/B3Dialog';\nimport { useMobile } from '@/hooks';\nimport { useB3Lang } from '@/lib/lang';\n\ninterface ShoppingDetailDeleteItemsProps {\n  open: boolean;\n  handleCancelClick: () => void;\n  handleDeleteProductClick: () => void;\n}\n\nfunction ShoppingDetailDeleteItems(props: ShoppingDetailDeleteItemsProps) {\n  const b3Lang = useB3Lang();\n  const [isMobile] = useMobile();\n  const { open, handleCancelClick, handleDeleteProductClick } = props;\n\n  return (\n    <B3Dialog\n      isOpen={open}\n      title={b3Lang('shoppingList.deleteItems.subtotal')}\n      leftSizeBtn={b3Lang('shoppingList.deleteItems.cancel')}\n      rightSizeBtn={b3Lang('shoppingList.deleteItems.delete')}\n      handleLeftClick={handleCancelClick}\n      handRightClick={handleDeleteProductClick}\n      rightStyleBtn={{\n        color: '#D32F2F',\n      }}\n    >\n      <Box\n        sx={{\n          display: 'flex',\n          width: isMobile ? '100%' : '450px',\n          height: '100%',\n        }}\n      >\n        {b3Lang('shoppingList.deleteItems.confirmDelete')}\n      </Box>\n    </B3Dialog>\n  );\n}\n\nexport default ShoppingDetailDeleteItems;\n","import { useContext, useRef, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { ArrowDropDown, Delete } from '@mui/icons-material';\nimport { Box, Grid, Menu, MenuItem, Typography } from '@mui/material';\nimport Cookies from 'js-cookie';\nimport { v1 as uuid } from 'uuid';\n\nimport CustomButton from '@/components/button/CustomButton';\nimport { CART_URL, CHECKOUT_URL, PRODUCT_DEFAULT_IMAGE } from '@/constants';\nimport { useFeatureFlags, useMobile } from '@/hooks';\nimport { useB3Lang } from '@/lib/lang';\nimport { GlobalContext } from '@/shared/global';\nimport { getVariantInfoBySkus, searchProducts } from '@/shared/service/b2b/graphql/product';\nimport { deleteCart, getCart } from '@/shared/service/bc/graphql/cart';\nimport { rolePermissionSelector, useAppSelector } from '@/store';\nimport { ShoppingListStatus } from '@/types/shoppingList';\nimport { currencyFormat, snackbar } from '@/utils';\nimport b2bLogger from '@/utils/b3Logger';\nimport {\n  addQuoteDraftProducts,\n  calculateProductListPrice,\n  validProductQty,\n} from '@/utils/b3Product/b3Product';\nimport {\n  addLineItems,\n  conversionProductsList,\n  ProductsProps,\n} from '@/utils/b3Product/shared/config';\nimport b3TriggerCartNumber from '@/utils/b3TriggerCartNumber';\nimport { createOrUpdateExistingCart, deleteCartData, updateCart } from '@/utils/cartUtils';\nimport { validateProducts } from '@/utils/validateProducts';\n\ninterface ShoppingDetailFooterProps {\n  shoppingListInfo: any;\n  allowJuniorPlaceOrder: boolean;\n  checkedArr: any;\n  selectedSubTotal: number;\n  setLoading: (val: boolean) => void;\n  setDeleteOpen: (val: boolean) => void;\n  setValidateFailureProducts: (arr: ProductsProps[]) => void;\n  setValidateSuccessProducts: (arr: ProductsProps[]) => void;\n  isB2BUser: boolean;\n  customColor: string;\n  isCanEditShoppingList: boolean;\n  role: string | number;\n  backendValidationEnabled: boolean;\n}\n\ninterface ProductInfoProps {\n  basePrice: number | string;\n  baseSku: string;\n  createdAt: number;\n  discount: number | string;\n  enteredInclusive: boolean;\n  id: number | string;\n  itemId: number;\n  optionList: string;\n  primaryImage: string;\n  productId: number;\n  productName: string;\n  productUrl: string;\n  quantity: number | string;\n  tax: number | string;\n  updatedAt: number;\n  variantId: number;\n  variantSku: string;\n  productsSearch: CustomFieldItems;\n}\n\ninterface ListItemProps {\n  node: ProductInfoProps;\n}\n\nfunction ShoppingDetailFooter(props: ShoppingDetailFooterProps) {\n  const [isMobile] = useMobile();\n  const b3Lang = useB3Lang();\n  const navigate = useNavigate();\n  const featureFlags = useFeatureFlags();\n\n  const {\n    state: { productQuoteEnabled = false },\n  } = useContext(GlobalContext);\n  const isAgenting = useAppSelector(({ b2bFeatures }) => b2bFeatures.masqueradeCompany.isAgenting);\n  const companyId = useAppSelector(({ company }) => company.companyInfo.id);\n  const customerGroupId = useAppSelector(({ company }) => company.customer.customerGroupId);\n  const {\n    shoppingListCreateActionsPermission,\n    purchasabilityPermission,\n    submitShoppingListPermission,\n  } = useAppSelector(rolePermissionSelector);\n  const ref = useRef<HTMLButtonElement | null>(null);\n  const [isOpen, setIsOpen] = useState(false);\n\n  const cartEntityId = Cookies.get('cartId');\n\n  const containerStyle = isMobile\n    ? {\n        alignItems: 'flex-start',\n        flexDirection: 'column',\n      }\n    : {\n        alignItems: 'center',\n      };\n\n  const {\n    shoppingListInfo,\n    allowJuniorPlaceOrder,\n    checkedArr,\n    selectedSubTotal,\n    setLoading,\n    setDeleteOpen,\n    setValidateFailureProducts,\n    setValidateSuccessProducts,\n    isB2BUser,\n    customColor,\n    isCanEditShoppingList,\n    role,\n    backendValidationEnabled,\n  } = props;\n\n  const b2bShoppingListActionsPermission = isB2BUser ? shoppingListCreateActionsPermission : true;\n  const isCanAddToCart = isB2BUser ? purchasabilityPermission : true;\n  const b2bSubmitShoppingListPermission = isB2BUser\n    ? submitShoppingListPermission\n    : Number(role) === 2;\n\n  const handleOpenBtnList = () => {\n    if (checkedArr.length === 0) {\n      snackbar.error(b3Lang('shoppingList.footer.selectOneItem'));\n    } else {\n      setIsOpen(true);\n    }\n  };\n\n  const handleClose = () => {\n    setIsOpen(false);\n  };\n\n  const verifyInventory = (inventoryInfos: ProductsProps[]) => {\n    const validateFailureArr: ProductsProps[] = [];\n    const validateSuccessArr: ProductsProps[] = [];\n\n    checkedArr.forEach((item: ProductsProps) => {\n      const { node } = item;\n\n      const inventoryInfo: CustomFieldItems =\n        inventoryInfos.find((option: CustomFieldItems) => option.variantSku === node.variantSku) ||\n        {};\n\n      if (inventoryInfo) {\n        let isPassVerify = true;\n        if (\n          inventoryInfo.isStock === '1' &&\n          (node?.quantity ? Number(node.quantity) : 0) > inventoryInfo.stock\n        )\n          isPassVerify = false;\n\n        if (\n          inventoryInfo.minQuantity !== 0 &&\n          (node?.quantity ? Number(node.quantity) : 0) < inventoryInfo.minQuantity\n        )\n          isPassVerify = false;\n\n        if (\n          inventoryInfo.maxQuantity !== 0 &&\n          (node?.quantity ? Number(node.quantity) : 0) > inventoryInfo.maxQuantity\n        )\n          isPassVerify = false;\n\n        if (isPassVerify) {\n          validateSuccessArr.push({\n            node,\n          });\n        } else {\n          validateFailureArr.push({\n            node: {\n              ...node,\n            },\n            stock: inventoryInfo.stock,\n            isStock: inventoryInfo.isStock,\n            maxQuantity: inventoryInfo.maxQuantity,\n            minQuantity: inventoryInfo.minQuantity,\n          });\n        }\n      }\n    });\n\n    return {\n      validateFailureArr,\n      validateSuccessArr,\n    };\n  };\n\n  const addToQuote = async (products: CustomFieldItems[]) => {\n    if (featureFlags['B2B-3318.move_stock_and_backorder_validation_to_backend']) {\n      const validatedProducts = await validateProducts(products, b3Lang);\n\n      addQuoteDraftProducts(validatedProducts);\n\n      return validatedProducts.length > 0;\n    }\n\n    addQuoteDraftProducts(products);\n\n    return true;\n  };\n\n  const shouldRedirectCheckout = () => {\n    if (\n      allowJuniorPlaceOrder &&\n      b2bSubmitShoppingListPermission &&\n      shoppingListInfo?.status === ShoppingListStatus.Approved\n    ) {\n      window.location.href = CHECKOUT_URL;\n    } else {\n      snackbar.success(b3Lang('shoppingList.footer.productsAddedToCart'), {\n        action: {\n          label: b3Lang('shoppingList.reAddToCart.viewCart'),\n          onClick: () => {\n            if (window.b2b.callbacks.dispatchEvent('on-click-cart-button')) {\n              window.location.href = CART_URL;\n            }\n          },\n        },\n      });\n      b3TriggerCartNumber();\n    }\n  };\n\n  const handleAddToCartOnFrontend = async () => {\n    try {\n      const skus: string[] = [];\n\n      let cantPurchase = '';\n\n      checkedArr.forEach((item: ProductsProps) => {\n        const { node } = item;\n\n        if (node.productsSearch.availability === 'disabled') {\n          cantPurchase += `${node.variantSku},`;\n        }\n\n        skus.push(node.variantSku);\n      });\n\n      if (cantPurchase) {\n        snackbar.error(\n          b3Lang('shoppingList.footer.unavailableProducts', {\n            skus: cantPurchase.slice(0, -1),\n          }),\n        );\n        return;\n      }\n\n      if (skus.length === 0) {\n        snackbar.error(\n          allowJuniorPlaceOrder\n            ? b3Lang('shoppingList.footer.selectItemsToCheckout')\n            : b3Lang('shoppingList.footer.selectItemsToAddToCart'),\n        );\n        return;\n      }\n\n      const getInventoryInfos = await getVariantInfoBySkus(skus);\n\n      const { validateFailureArr, validateSuccessArr } = verifyInventory(\n        getInventoryInfos?.variantSku || [],\n      );\n\n      if (validateSuccessArr.length !== 0) {\n        const lineItems = addLineItems(validateSuccessArr);\n        const deleteCartObject = deleteCartData(cartEntityId);\n        const cartInfo = await getCart();\n        let res = null;\n        // @ts-expect-error Keeping it like this to avoid breaking changes, will fix in a following commit.\n        if (allowJuniorPlaceOrder && cartInfo.length) {\n          await deleteCart(deleteCartObject);\n          res = await updateCart(cartInfo, lineItems);\n        } else {\n          res = await createOrUpdateExistingCart(lineItems);\n          b3TriggerCartNumber();\n        }\n        if (res && res.errors) {\n          snackbar.error(res.errors[0].message);\n        } else if (validateFailureArr.length === 0) {\n          shouldRedirectCheckout();\n        }\n      }\n\n      setValidateFailureProducts(validateFailureArr);\n      setValidateSuccessProducts(validateSuccessArr);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleAddToCartBackend = async () => {\n    const items = checkedArr.map(({ node }: ProductsProps) => {\n      return { node };\n    });\n    try {\n      const skus = items.map(({ node }: ProductsProps) => node.variantSku);\n\n      if (skus.length === 0) {\n        snackbar.error(\n          allowJuniorPlaceOrder\n            ? b3Lang('shoppingList.footer.selectItemsToCheckout')\n            : b3Lang('shoppingList.footer.selectItemsToAddToCart'),\n        );\n        return;\n      }\n\n      const lineItems = addLineItems(items);\n      const deleteCartObject = deleteCartData(items);\n      const cartInfo = await getCart();\n\n      if (allowJuniorPlaceOrder && cartInfo.data.site.cart) {\n        await deleteCart(deleteCartObject);\n        await updateCart(cartInfo, lineItems);\n      } else {\n        await createOrUpdateExistingCart(lineItems);\n        b3TriggerCartNumber();\n      }\n      shouldRedirectCheckout();\n    } catch (e: unknown) {\n      if (e instanceof Error) {\n        setValidateFailureProducts(items);\n        snackbar.error(e.message);\n      }\n    } finally {\n      setLoading(false);\n    }\n    setValidateSuccessProducts(items);\n  };\n\n  // Add selected product to cart\n  const handleAddProductsToCart = async () => {\n    if (checkedArr.length === 0) {\n      snackbar.error(b3Lang('shoppingList.footer.selectOneItem'));\n      return;\n    }\n\n    handleClose();\n\n    setLoading(true);\n\n    if (backendValidationEnabled) {\n      await handleAddToCartBackend();\n    } else {\n      await handleAddToCartOnFrontend();\n    }\n  };\n\n  // Add selected to quote\n  const getOptionsList = (options: []) => {\n    if (options?.length === 0) return [];\n\n    const option = options.map(\n      ({\n        option_id: optionId,\n        option_value: optionValue,\n      }: {\n        option_id: string | number;\n        option_value: string | number;\n      }) => ({\n        optionId,\n        optionValue,\n      }),\n    );\n\n    return option;\n  };\n\n  const handleAddSelectedToQuote = async () => {\n    if (checkedArr.length === 0) {\n      snackbar.error(b3Lang('shoppingList.footer.selectOneItem'));\n      return;\n    }\n    setLoading(true);\n    handleClose();\n    try {\n      const productsWithSku = checkedArr.filter((checkedItem: ListItemProps) => {\n        const {\n          node: { variantSku },\n        } = checkedItem;\n\n        return variantSku !== '' && variantSku !== null && variantSku !== undefined;\n      });\n\n      const noSkuProducts = checkedArr.filter((checkedItem: ListItemProps) => {\n        const {\n          node: { variantSku },\n        } = checkedItem;\n\n        return !variantSku;\n      });\n      if (noSkuProducts.length > 0) {\n        snackbar.error(b3Lang('shoppingList.footer.cantAddProductsNoSku'));\n      }\n      if (noSkuProducts.length === checkedArr.length) return;\n\n      const productIds: number[] = [];\n      productsWithSku.forEach((product: ListItemProps) => {\n        const { node } = product;\n\n        if (!productIds.includes(Number(node.productId))) {\n          productIds.push(Number(node.productId));\n        }\n      });\n\n      const { productsSearch } = await searchProducts({\n        productIds,\n        companyId,\n        customerGroupId,\n      });\n\n      const newProductInfo: CustomFieldItems = conversionProductsList(productsSearch);\n      let errorMessage = '';\n      let isFondVariant = true;\n\n      const newProducts: CustomFieldItems[] = [];\n      productsWithSku.forEach((product: ListItemProps) => {\n        const {\n          node: {\n            basePrice,\n            optionList,\n            variantSku,\n            productId,\n            productName,\n            quantity,\n            variantId,\n            tax,\n          },\n        } = product;\n\n        const optionsList = getOptionsList(JSON.parse(optionList));\n\n        const currentProductSearch = newProductInfo.find(\n          (product: CustomFieldItems) => Number(product.id) === Number(productId),\n        );\n\n        const variantItem = currentProductSearch?.variants.find(\n          (item: CustomFieldItems) => item.sku === variantSku,\n        );\n\n        if (!variantItem) {\n          errorMessage = b3Lang('shoppingList.footer.notFoundSku', {\n            sku: variantSku,\n          });\n          isFondVariant = false;\n        }\n\n        const quoteListitem = {\n          node: {\n            id: uuid(),\n            variantSku: variantItem?.sku || variantSku,\n            variantId,\n            productsSearch: {\n              ...currentProductSearch,\n              newSelectOptionList: optionsList,\n              variantId,\n            },\n            primaryImage: variantItem?.image_url || PRODUCT_DEFAULT_IMAGE,\n            productName,\n            quantity: Number(quantity) || 1,\n            optionList: JSON.stringify(optionsList),\n            productId,\n            basePrice,\n            tax,\n          },\n        };\n\n        newProducts.push(quoteListitem);\n      });\n\n      const isValidQty = validProductQty(newProducts);\n\n      if (!isFondVariant) {\n        snackbar.error(errorMessage);\n\n        return;\n      }\n\n      if (isValidQty) {\n        await calculateProductListPrice(newProducts, '2');\n\n        const success = await addToQuote(newProducts);\n        if (success) {\n          snackbar.success(b3Lang('shoppingList.footer.productsAddedToQuote'), {\n            action: {\n              label: b3Lang('shoppingList.footer.viewQuote'),\n              onClick: () => {\n                navigate('/quoteDraft');\n              },\n            },\n          });\n        }\n      } else {\n        snackbar.error(b3Lang('shoppingList.footer.productsLimit'), {\n          action: {\n            label: b3Lang('shoppingList.footer.viewQuote'),\n            onClick: () => {\n              navigate('/quoteDraft');\n            },\n          },\n        });\n      }\n    } catch (e) {\n      b2bLogger.error(e);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const buttons = {\n    adSelectedToCart: {\n      name: b3Lang('shoppingList.footer.addToCart'),\n      key: 'add-selected-to-cart',\n      handleClick: handleAddProductsToCart,\n      isDisabled: false,\n    },\n    proceedToCheckout: {\n      name: b3Lang('shoppingList.footer.proceedToCheckout'),\n      key: 'add-select-to-checkout',\n      handleClick: handleAddProductsToCart,\n      isDisabled: false,\n    },\n    addSelectedToQuote: {\n      name: b3Lang('shoppingList.footer.addToQuote'),\n      key: 'add-selected-to-quote',\n      handleClick: handleAddSelectedToQuote,\n      isDisabled: false,\n    },\n  };\n\n  const allowButtonList = () => {\n    if (!(shoppingListInfo?.status === ShoppingListStatus.Approved || !isB2BUser)) return [];\n\n    if (!isCanAddToCart && isB2BUser)\n      return productQuoteEnabled ? [buttons.addSelectedToQuote] : [];\n\n    if (b2bSubmitShoppingListPermission) {\n      if (allowJuniorPlaceOrder && productQuoteEnabled) {\n        return [buttons.proceedToCheckout, buttons.addSelectedToQuote];\n      }\n\n      if (allowJuniorPlaceOrder) return [buttons.proceedToCheckout];\n      if (productQuoteEnabled) {\n        return [buttons.addSelectedToQuote];\n      }\n      return [];\n    }\n\n    return productQuoteEnabled\n      ? [buttons.adSelectedToCart, buttons.addSelectedToQuote]\n      : [buttons.adSelectedToCart];\n  };\n\n  const buttonList = allowButtonList();\n\n  return (\n    <Grid\n      sx={{\n        position: 'fixed',\n        bottom: isMobile && isAgenting ? '52px' : 0,\n        left: 0,\n        backgroundColor: '#fff',\n        width: '100%',\n        padding: isMobile ? '0 0 1rem 0' : '0 40px 1rem 40px',\n        height: isMobile ? '8rem' : 'auto',\n        marginLeft: 0,\n        display: 'flex',\n        flexWrap: 'nowrap',\n        zIndex: '999',\n      }}\n      container\n      spacing={2}\n    >\n      <Grid\n        item\n        sx={{\n          display: isMobile ? 'none' : 'block',\n          width: '290px',\n          paddingLeft: '20px',\n        }}\n      />\n      <Grid\n        item\n        sx={\n          isMobile\n            ? {\n                flexBasis: '100%',\n              }\n            : {\n                flexBasis: '690px',\n                flexGrow: 1,\n              }\n        }\n      >\n        <Box\n          sx={{\n            width: '100%',\n            pr: '20px',\n            display: 'flex',\n            zIndex: '999',\n            justifyContent: 'space-between',\n            ...containerStyle,\n          }}\n        >\n          <Typography\n            sx={{\n              color: '#000000',\n              fontSize: '16px',\n              fontWeight: '400',\n            }}\n          >\n            {b3Lang('shoppingList.footer.selectedProducts', {\n              quantity: checkedArr.length,\n            })}\n          </Typography>\n          <Box\n            sx={{\n              display: 'flex',\n              alignItems: 'center',\n              flexWrap: isMobile ? 'wrap' : 'nowrap',\n            }}\n          >\n            <Typography\n              variant=\"h6\"\n              sx={{\n                fontSize: '16px',\n                fontWeight: '700',\n                color: '#000000',\n              }}\n            >\n              {b3Lang('shoppingList.footer.subtotal', {\n                subtotal: currencyFormat(selectedSubTotal),\n              })}\n            </Typography>\n            <Box\n              sx={{\n                display: 'flex',\n                alignItems: 'center',\n                marginTop: isMobile ? '0.5rem' : 0,\n                width: isMobile ? '100%' : 'auto',\n              }}\n            >\n              {!allowJuniorPlaceOrder &&\n                isCanEditShoppingList &&\n                b2bShoppingListActionsPermission && (\n                  <CustomButton\n                    sx={{\n                      padding: '5px',\n                      border: `1px solid ${customColor || '#1976d2'}`,\n                      margin: isMobile ? '0 1rem 0 0' : '0 1rem',\n                      minWidth: 'auto',\n                    }}\n                    disabled={shoppingListInfo?.status === ShoppingListStatus.ReadyForApproval}\n                  >\n                    <Delete\n                      color=\"primary\"\n                      sx={{\n                        color: customColor,\n                      }}\n                      onClick={() => {\n                        setDeleteOpen(true);\n                      }}\n                    />\n                  </CustomButton>\n                )}\n              {buttonList.length ? (\n                <Box\n                  sx={{\n                    display: 'flex',\n                    alignItems: 'center',\n                    marginTop: isMobile ? '0.5rem' : 0,\n                    marginLeft: isMobile ? 0 : '20px',\n                    width: isMobile ? '100%' : 'auto',\n                  }}\n                >\n                  {buttonList.length === 1 && buttonList[0] && (\n                    <CustomButton\n                      variant=\"contained\"\n                      onClick={buttonList[0].handleClick}\n                      sx={{\n                        marginRight: isMobile ? '1rem' : 0,\n                        width: isMobile ? '100%' : 'auto',\n                      }}\n                    >\n                      {buttonList[0].name}\n                    </CustomButton>\n                  )}\n                  {buttonList.length === 2 && (\n                    <>\n                      <CustomButton\n                        variant=\"contained\"\n                        onClick={handleOpenBtnList}\n                        ref={ref}\n                        sx={{\n                          marginRight: isMobile ? '1rem' : 0,\n                          width: isMobile ? '100%' : 'auto',\n                        }}\n                        endIcon={<ArrowDropDown />}\n                      >\n                        {b3Lang('shoppingList.footer.addSelectedTo')}\n                      </CustomButton>\n                      <Menu\n                        id=\"basic-menu\"\n                        anchorEl={ref.current}\n                        open={isOpen}\n                        onClose={handleClose}\n                        MenuListProps={{\n                          'aria-labelledby': 'basic-button',\n                        }}\n                      >\n                        {buttonList.length > 1 &&\n                          buttonList.map((button) => (\n                            <MenuItem\n                              key={button.key}\n                              onClick={() => {\n                                button.handleClick();\n                              }}\n                            >\n                              {button.name}\n                            </MenuItem>\n                          ))}\n                      </Menu>\n                    </>\n                  )}\n                </Box>\n              ) : null}\n            </Box>\n          </Box>\n        </Box>\n      </Grid>\n      <Grid\n        item\n        sx={\n          isMobile\n            ? {\n                flexBasis: '100%',\n                display: isMobile ? 'none' : 'block',\n              }\n            : {\n                flexBasis: '340px',\n                display: isMobile ? 'none' : 'block',\n              }\n        }\n      />\n    </Grid>\n  );\n}\n\nexport default ShoppingDetailFooter;\n","import { useContext, useMemo } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { ArrowBackIosNew } from '@mui/icons-material';\nimport { Box, Grid, styled, Typography } from '@mui/material';\n\nimport CustomButton from '@/components/button/CustomButton';\nimport { getContrastColor } from '@/components/outSideComponents/utils/b3CustomStyles';\nimport { useMobile } from '@/hooks';\nimport { useB3Lang } from '@/lib/lang';\nimport { type SetOpenPage } from '@/pages/SetOpenPage';\nimport { CustomStyleContext } from '@/shared/customStyleButton';\nimport { rolePermissionSelector, useAppSelector } from '@/store';\nimport { ShoppingListStatus } from '@/types/shoppingList';\nimport { verifyLevelPermission, verifySubmitShoppingListSubsidiariesPermission } from '@/utils';\nimport { b2bPermissionsMap } from '@/utils/b3CheckPermissions/config';\n\nimport { ShoppingListStatusTag } from '../../ShoppingLists/ShoppingListStatusTag';\n\nconst StyledCreateName = styled('div')(() => ({\n  display: 'flex',\n  alignItems: 'center',\n}));\n\ninterface ShoppingDetailHeaderProps {\n  shoppingListInfo: any;\n  role: string | number;\n  customerInfo: any;\n  goToShoppingLists: () => void;\n  handleUpdateShoppingList: (status: number) => void;\n  isB2BUser: boolean;\n  setOpenPage: SetOpenPage;\n  isAgenting: boolean;\n  openAPPParams: {\n    shoppingListBtn: string;\n  };\n  customColor: string;\n}\n\nfunction ShoppingDetailHeader(props: ShoppingDetailHeaderProps) {\n  const b3Lang = useB3Lang();\n  const [isMobile] = useMobile();\n\n  const {\n    shoppingListInfo,\n    customerInfo,\n    handleUpdateShoppingList,\n    goToShoppingLists,\n    isB2BUser,\n    setOpenPage,\n    openAPPParams,\n    customColor,\n  } = props;\n\n  const {\n    state: {\n      portalStyle: { backgroundColor = '#FEF9F5' },\n    },\n  } = useContext(CustomStyleContext);\n  const navigate = useNavigate();\n\n  const { selectCompanyHierarchyId } = useAppSelector(\n    ({ company }) => company.companyHierarchyInfo,\n  );\n\n  const {\n    submitShoppingListPermission: submitShoppingList,\n    approveShoppingListPermission: approveShoppingList,\n  } = useAppSelector(rolePermissionSelector);\n\n  const shoppingListPermissions = useMemo(() => {\n    if (isB2BUser) {\n      const companyInfo = shoppingListInfo?.companyInfo || {};\n\n      const {\n        submitShoppingListPermission: submitShoppingListPermissionCode,\n        approveShoppingListPermission: approveShoppingListPermissionCode,\n      } = b2bPermissionsMap;\n      const submitShoppingListPermissionLevel = verifySubmitShoppingListSubsidiariesPermission({\n        code: submitShoppingListPermissionCode,\n        userId: Number(customerInfo?.userId || 0),\n        selectId: Number(selectCompanyHierarchyId),\n      });\n\n      const approveShoppingListPermissionLevel = verifyLevelPermission({\n        code: approveShoppingListPermissionCode,\n        companyId: Number(companyInfo?.companyId || 0),\n        userId: Number(customerInfo?.userId || 0),\n      });\n\n      return {\n        submitShoppingListPermission: submitShoppingListPermissionLevel,\n        approveShoppingListPermission: approveShoppingListPermissionLevel,\n      };\n    }\n\n    return {\n      submitShoppingListPermission: submitShoppingList,\n      approveShoppingListPermission: approveShoppingList,\n    };\n  }, [\n    customerInfo,\n    isB2BUser,\n    submitShoppingList,\n    approveShoppingList,\n    shoppingListInfo?.companyInfo,\n    selectCompanyHierarchyId,\n  ]);\n\n  const isDisabledBtn = shoppingListInfo?.products?.edges.length === 0;\n\n  const { submitShoppingListPermission, approveShoppingListPermission } = shoppingListPermissions;\n\n  const gridOptions = (xs: number) =>\n    isMobile\n      ? {}\n      : {\n          xs,\n        };\n  return (\n    <>\n      <Box\n        sx={{\n          marginBottom: '16px',\n          width: 'fit-content',\n        }}\n      >\n        <Box\n          sx={{\n            color: '#1976d2',\n            cursor: 'pointer',\n            display: 'flex',\n            alignItems: 'center',\n          }}\n          onClick={() => {\n            if (openAPPParams.shoppingListBtn !== 'add') {\n              goToShoppingLists();\n            } else {\n              navigate('/');\n              setOpenPage({\n                isOpen: false,\n                openUrl: '',\n              });\n            }\n          }}\n        >\n          <ArrowBackIosNew\n            fontSize=\"small\"\n            sx={{\n              fontSize: '12px',\n              marginRight: '0.5rem',\n              color: customColor,\n            }}\n          />\n          <Box\n            sx={{\n              margin: 0,\n              color: customColor,\n              m: '0',\n            }}\n          >\n            {openAPPParams.shoppingListBtn !== 'add'\n              ? b3Lang('shoppingList.header.backToShoppingLists')\n              : b3Lang('shoppingList.header.backToProduct')}\n          </Box>\n        </Box>\n      </Box>\n      <Grid\n        container\n        spacing={2}\n        sx={{\n          display: 'flex',\n          justifyContent: 'space-between',\n          flexDirection: isMobile ? 'column' : 'row',\n          mb: isMobile ? '16px' : '',\n        }}\n      >\n        <Grid\n          item\n          {...gridOptions(8)}\n          sx={{\n            color: getContrastColor(backgroundColor),\n          }}\n        >\n          <Box\n            sx={{\n              display: 'flex',\n              alignItems: isMobile ? 'start' : 'center',\n              flexDirection: isMobile ? 'column' : 'row',\n            }}\n          >\n            <Typography\n              variant=\"h4\"\n              sx={{\n                marginRight: '1rem',\n                wordBreak: 'break-all',\n              }}\n            >\n              {`${shoppingListInfo?.name || ''}`}\n            </Typography>\n            {isB2BUser &&\n              (submitShoppingListPermission ||\n                (approveShoppingListPermission && shoppingListInfo?.approvedFlag)) && (\n                <Typography\n                  sx={{\n                    m: isMobile ? '10px 0' : '0',\n                  }}\n                >\n                  {shoppingListInfo && <ShoppingListStatusTag status={shoppingListInfo?.status} />}\n                </Typography>\n              )}\n          </Box>\n          <Box>\n            <Typography\n              sx={{\n                width: '100%',\n                wordBreak: 'break-all',\n              }}\n            >\n              {shoppingListInfo?.description}\n            </Typography>\n            {isB2BUser && (\n              <StyledCreateName>\n                <Typography\n                  variant=\"subtitle2\"\n                  sx={{\n                    marginRight: '0.5rem',\n                  }}\n                >\n                  {b3Lang('shoppingList.header.createdBy')}\n                </Typography>\n                <span>{`${customerInfo?.firstName || ''} ${customerInfo?.lastName || ''}`}</span>\n              </StyledCreateName>\n            )}\n          </Box>\n        </Grid>\n\n        <Grid\n          item\n          sx={{\n            textAlign: isMobile ? 'none' : 'end',\n          }}\n          {...gridOptions(4)}\n        >\n          {submitShoppingListPermission &&\n            shoppingListInfo?.status === ShoppingListStatus.Draft && (\n              <CustomButton\n                variant=\"outlined\"\n                disabled={isDisabledBtn}\n                onClick={() => {\n                  handleUpdateShoppingList(ShoppingListStatus.ReadyForApproval);\n                }}\n              >\n                {b3Lang('shoppingList.header.submitForApproval')}\n              </CustomButton>\n            )}\n          {approveShoppingListPermission &&\n            shoppingListInfo?.status === ShoppingListStatus.ReadyForApproval && (\n              <Box>\n                <CustomButton\n                  variant=\"outlined\"\n                  sx={{\n                    marginRight: '1rem',\n                  }}\n                  onClick={() => {\n                    handleUpdateShoppingList(ShoppingListStatus.Rejected);\n                  }}\n                >\n                  {b3Lang('shoppingList.header.reject')}\n                </CustomButton>\n                {approveShoppingListPermission && (\n                  <CustomButton\n                    variant=\"outlined\"\n                    onClick={() => {\n                      handleUpdateShoppingList(ShoppingListStatus.Approved);\n                    }}\n                  >\n                    {b3Lang('shoppingList.header.approve')}\n                  </CustomButton>\n                )}\n              </Box>\n            )}\n        </Grid>\n      </Grid>\n    </>\n  );\n}\n\nexport default ShoppingDetailHeader;\n","import { Box, TextField } from '@mui/material';\n\nimport B3Dialog from '@/components/B3Dialog';\nimport { useMobile } from '@/hooks';\nimport { useB3Lang } from '@/lib/lang';\n\ninterface ShoppingDetailAddNotesProps {\n  open: boolean;\n  notes: string;\n  setNotes: (value: string) => void;\n  handleCancelAddNotesClick: () => void;\n  handleAddItemNotesClick: () => void;\n}\n\nfunction ShoppingDetailAddNotes(props: ShoppingDetailAddNotesProps) {\n  const b3Lang = useB3Lang();\n\n  const [isMobile] = useMobile();\n  const { open, notes, setNotes, handleCancelAddNotesClick, handleAddItemNotesClick } = props;\n\n  return (\n    <B3Dialog\n      isOpen={open}\n      title={b3Lang('shoppingList.addItemNotes.title')}\n      leftSizeBtn={b3Lang('shoppingList.addItemNotes.cancel')}\n      rightSizeBtn={b3Lang('shoppingList.addItemNotes.save')}\n      handleLeftClick={handleCancelAddNotesClick}\n      handRightClick={handleAddItemNotesClick}\n      isShowBordered={false}\n    >\n      <Box\n        sx={{\n          display: 'flex',\n          width: isMobile ? '100%' : '450px',\n          height: '100%',\n        }}\n      >\n        <TextField\n          multiline\n          rows={6}\n          defaultValue={notes}\n          onChange={(e) => setNotes(e.target.value)}\n          variant=\"filled\"\n          fullWidth\n          placeholder={b3Lang('shoppingList.addItemNotes.placeholder')}\n        />\n      </Box>\n    </B3Dialog>\n  );\n}\n\nexport default ShoppingDetailAddNotes;\n","import { ReactElement } from 'react';\nimport { Delete, Edit, StickyNote2 } from '@mui/icons-material';\nimport { Box, CardContent, styled, TextField, Typography } from '@mui/material';\n\nimport { PRODUCT_DEFAULT_IMAGE } from '@/constants';\nimport { useB3Lang } from '@/lib/lang';\nimport { currencyFormat } from '@/utils';\nimport b2bGetVariantImageByVariantInfo from '@/utils/b2bGetVariantImageByVariantInfo';\nimport { getBCPrice } from '@/utils/b3Product/b3Product';\n\nimport { getProductOptionsFields } from '../../../utils/b3Product/shared/config';\n\ninterface ShoppingDetailCardProps {\n  item: any;\n  onEdit: (item: any, variantId: number | string, itemId: number | string) => void;\n  onDelete: (itemId: number) => void;\n  handleUpdateProductQty: (id: number | string, value: number | string) => void;\n  handleUpdateShoppingListItem: (itemId: number | string) => void;\n  checkBox?: () => ReactElement;\n  isReadForApprove: boolean;\n  len: number;\n  itemIndex?: number;\n  setDeleteOpen: (value: boolean) => void;\n  setAddNoteItemId: (itemId: number) => void;\n  setAddNoteOpen: (open: boolean) => void;\n  setNotes: (value: string) => void;\n  showPrice: (price: string, row: CustomFieldItems) => string | number;\n  b2bAndBcShoppingListActionsPermissions: boolean;\n}\n\nconst StyledImage = styled('img')(() => ({\n  maxWidth: '60px',\n  height: 'auto',\n  marginRight: '0.5rem',\n}));\n\nfunction ShoppingDetailCard(props: ShoppingDetailCardProps) {\n  const b3Lang = useB3Lang();\n  const {\n    item: shoppingDetail,\n    onEdit,\n    onDelete,\n    checkBox,\n    handleUpdateProductQty,\n    handleUpdateShoppingListItem,\n    isReadForApprove,\n    len,\n    itemIndex,\n    setDeleteOpen,\n    setAddNoteOpen,\n    setAddNoteItemId,\n    setNotes,\n    showPrice,\n    b2bAndBcShoppingListActionsPermissions,\n  } = props;\n\n  const {\n    basePrice,\n    quantity,\n    itemId,\n    variantId,\n    primaryImage,\n    productName,\n    variantSku,\n    productsSearch,\n    productUrl,\n    taxPrice = 0,\n    productNote,\n  } = shoppingDetail;\n\n  const price = getBCPrice(Number(basePrice), Number(taxPrice));\n\n  const total = price * Number(quantity);\n\n  const product: any = {\n    ...shoppingDetail.productsSearch,\n    selectOptions: shoppingDetail.optionList,\n  };\n\n  const productFields = getProductOptionsFields(product, {});\n\n  const optionList = JSON.parse(shoppingDetail.optionList);\n  const optionsValue: CustomFieldItems[] = productFields.filter((item) => item.valueText);\n\n  const canChangeOption =\n    optionList.length > 0 && !isReadForApprove && b2bAndBcShoppingListActionsPermissions;\n\n  const currentVariants = product.variants || [];\n\n  const currentImage =\n    b2bGetVariantImageByVariantInfo(currentVariants, { variantId, variantSku }) || primaryImage;\n\n  return (\n    <Box\n      key={shoppingDetail.id}\n      sx={{\n        borderTop: '1px solid #D9DCE9',\n        borderBottom: itemIndex === len - 1 ? '1px solid #D9DCE9' : '',\n      }}\n    >\n      <CardContent\n        sx={{\n          color: '#313440',\n          display: 'flex',\n          pl: 0,\n        }}\n      >\n        <Box>{checkBox && checkBox()}</Box>\n        <Box>\n          <StyledImage\n            src={currentImage || PRODUCT_DEFAULT_IMAGE}\n            alt=\"Product-img\"\n            loading=\"lazy\"\n          />\n        </Box>\n        <Box\n          sx={{\n            flex: 1,\n          }}\n        >\n          <Typography\n            variant=\"body1\"\n            color=\"#212121\"\n            onClick={() => {\n              const {\n                location: { origin },\n              } = window;\n\n              window.location.href = `${origin}${productUrl}`;\n            }}\n            sx={{\n              cursor: 'pointer',\n            }}\n          >\n            {productName}\n          </Typography>\n          <Typography variant=\"body1\" color=\"#616161\">\n            {variantSku}\n          </Typography>\n          <Box\n            sx={{\n              margin: '0 0 0.5rem 0',\n            }}\n          >\n            {optionList.length > 0 && optionsValue.length > 0 && (\n              <Box>\n                {optionsValue.map((option: any) => (\n                  <Typography\n                    sx={{\n                      fontSize: '0.75rem',\n                      lineHeight: '1.5',\n                      color: '#455A64',\n                    }}\n                    key={option.valueLabel}\n                  >\n                    {`${option.valueLabel}: ${option.valueText}`}\n                  </Typography>\n                ))}\n              </Box>\n            )}\n          </Box>\n\n          {productNote && productNote.trim().length > 0 && (\n            <Typography\n              sx={{\n                fontSize: '0.75rem',\n                color: '#ED6C02',\n                marginTop: '0.3rem',\n                marginBottom: '0.3rem',\n              }}\n            >\n              {productNote}\n            </Typography>\n          )}\n\n          <Typography\n            sx={{\n              color: '#212121',\n              fontSize: '14px',\n            }}\n          >\n            {b3Lang('shoppingList.shoppingDetailCard.price', {\n              price: showPrice(currencyFormat(price), shoppingDetail),\n            })}\n          </Typography>\n\n          <TextField\n            size=\"small\"\n            type=\"number\"\n            variant=\"filled\"\n            label={b3Lang('shoppingList.shoppingDetailCard.quantity')}\n            disabled={b2bAndBcShoppingListActionsPermissions ? isReadForApprove : true}\n            inputProps={{\n              inputMode: 'numeric',\n              pattern: '[0-9]*',\n            }}\n            value={quantity}\n            sx={{\n              margin: '0.5rem 0',\n              width: '60%',\n              maxWidth: '100px',\n              '& label': {\n                zIndex: 0,\n                fontSize: '14px',\n              },\n              '& input': {\n                fontSize: '14px',\n              },\n            }}\n            onChange={(e) => {\n              handleUpdateProductQty(shoppingDetail.id, e.target.value);\n            }}\n            onBlur={() => {\n              handleUpdateShoppingListItem(itemId);\n            }}\n          />\n          <Typography\n            sx={{\n              color: '#212121',\n              fontSize: '14px',\n            }}\n          >\n            {b3Lang('shoppingList.shoppingDetailCard.total', {\n              total: showPrice(currencyFormat(total), shoppingDetail),\n            })}\n          </Typography>\n          <Box\n            sx={{\n              marginTop: '11px',\n              textAlign: 'end',\n            }}\n            id=\"shoppingList-actionList-mobile\"\n          >\n            {b2bAndBcShoppingListActionsPermissions && (\n              <StickyNote2\n                sx={{\n                  marginRight: '0.5rem',\n                  cursor: 'pointer',\n                  color: 'rgba(0, 0, 0, 0.54)',\n                }}\n                onClick={() => {\n                  setAddNoteOpen(true);\n                  setAddNoteItemId(Number(itemId));\n\n                  if (productNote) {\n                    setNotes(productNote);\n                  }\n                }}\n              />\n            )}\n\n            {canChangeOption && (\n              <Edit\n                sx={{\n                  marginRight: canChangeOption ? '0.5rem' : '',\n                  marginLeft: canChangeOption ? '0.3rem' : '',\n                  cursor: 'pointer',\n                  color: 'rgba(0, 0, 0, 0.54)',\n                }}\n                onClick={() => {\n                  onEdit(\n                    {\n                      ...productsSearch,\n                      selectOptions: optionList,\n                      quantity,\n                    },\n                    variantId,\n                    itemId,\n                  );\n                }}\n              />\n            )}\n            {b2bAndBcShoppingListActionsPermissions && !isReadForApprove && (\n              <Delete\n                sx={{\n                  marginLeft: '0.3rem',\n                  cursor: 'pointer',\n                  color: 'rgba(0, 0, 0, 0.54)',\n                }}\n                onClick={() => {\n                  setDeleteOpen(true);\n                  onDelete(Number(itemId));\n                }}\n              />\n            )}\n          </Box>\n        </Box>\n      </CardContent>\n    </Box>\n  );\n}\n\nexport default ShoppingDetailCard;\n","import {\n  Dispatch,\n  forwardRef,\n  Ref,\n  SetStateAction,\n  useEffect,\n  useImperativeHandle,\n  useRef,\n  useState,\n} from 'react';\nimport { Delete, Edit, StickyNote2 } from '@mui/icons-material';\nimport { Box, Grid, styled, TextField, Typography } from '@mui/material';\nimport cloneDeep from 'lodash-es/cloneDeep';\n\nimport {\n  B3PaginationTable,\n  GetRequestList,\n  TableRefreshConfig,\n} from '@/components/table/B3PaginationTable';\nimport { TableColumnItem } from '@/components/table/B3Table';\nimport { PRODUCT_DEFAULT_IMAGE } from '@/constants';\nimport { useMobile, useSort } from '@/hooks';\nimport { useB3Lang } from '@/lib/lang';\nimport { updateB2BShoppingListsItem, updateBcShoppingListsItem } from '@/shared/service/b2b';\nimport { rolePermissionSelector, useAppSelector } from '@/store';\nimport { currencyFormat, snackbar } from '@/utils';\nimport b2bGetVariantImageByVariantInfo from '@/utils/b2bGetVariantImageByVariantInfo';\nimport { getBCPrice, getDisplayPrice, getValidOptionsList } from '@/utils/b3Product/b3Product';\nimport { getProductOptionsFields } from '@/utils/b3Product/shared/config';\n\nimport B3FilterSearch from '../../../components/filter/B3FilterSearch';\n\nimport ChooseOptionsDialog from './ChooseOptionsDialog';\nimport ShoppingDetailAddNotes from './ShoppingDetailAddNotes';\nimport ShoppingDetailCard from './ShoppingDetailCard';\n\ninterface ListItem {\n  [key: string]: string;\n}\n\ninterface ProductInfoProps {\n  basePrice: number | string;\n  baseSku: string;\n  createdAt: number;\n  discount: number | string;\n  enteredInclusive: boolean;\n  id: number | string;\n  itemId: number;\n  optionList: string;\n  primaryImage: string;\n  productId: number;\n  productName: string;\n  productUrl: string;\n  quantity: number | string;\n  tax: number | string;\n  updatedAt: number;\n  variantId: number;\n  variantSku: string;\n  productsSearch: CustomFieldItems;\n  productNote: string;\n  disableCurrentCheckbox?: boolean;\n}\n\ninterface ListItemProps {\n  node: ProductInfoProps;\n}\n\ninterface ShoppingDetailTableProps {\n  shoppingListInfo: any;\n  isRequestLoading: boolean;\n  setIsRequestLoading: Dispatch<SetStateAction<boolean>>;\n  shoppingListId: number | string;\n  getShoppingListDetails: GetRequestList<SearchProps, CustomFieldItems>;\n  setCheckedArr: (values: CustomFieldItems) => void;\n  isReadForApprove: boolean;\n  isJuniorApprove: boolean;\n  allowJuniorPlaceOrder: boolean;\n  setDeleteItemId: (itemId: number | string) => void;\n  setDeleteOpen: (open: boolean) => void;\n  isB2BUser: boolean;\n  productQuoteEnabled: boolean;\n  isCanEditShoppingList: boolean;\n  role: number | string;\n}\n\ninterface SearchProps {\n  search?: string;\n  first?: number;\n  offset?: number;\n  orderBy: string;\n}\n\ninterface PaginationTableRefProps extends HTMLInputElement {\n  getList: () => void;\n  setList: (items?: ListItemProps[]) => void;\n  getSelectedValue: () => void;\n  refresh: (type?: TableRefreshConfig) => void;\n}\n\nconst StyledShoppingListTableContainer = styled('div')(() => ({\n  backgroundColor: '#FFFFFF',\n  padding: '1rem',\n  borderRadius: '4px',\n  boxShadow:\n    '0px 2px 1px -1px rgba(0, 0, 0, 0.2), 0px 1px 1px rgba(0, 0, 0, 0.14), 0px 1px 3px rgba(0, 0, 0, 0.12)',\n\n  '& tbody': {\n    '& tr': {\n      '& td': {\n        verticalAlign: 'top',\n      },\n      '& td: first-of-type': {\n        paddingTop: '25px',\n      },\n    },\n    '& tr: hover': {\n      '& #shoppingList-actionList': {\n        opacity: 1,\n      },\n    },\n  },\n}));\n\nconst StyledImage = styled('img')(() => ({\n  maxWidth: '60px',\n  height: 'auto',\n  marginRight: '0.5rem',\n}));\n\nconst StyledTextField = styled(TextField)(() => ({\n  '& input': {\n    paddingTop: '12px',\n    paddingRight: '6px',\n  },\n}));\n\nconst defaultSortKey = 'updatedAt';\n\nconst sortKeys = {\n  Product: 'productName',\n  updatedAt: 'updatedAt',\n  Qty: 'quantity',\n};\n\nfunction ShoppingDetailTable(props: ShoppingDetailTableProps, ref: Ref<unknown>) {\n  const [isMobile] = useMobile();\n  const b3Lang = useB3Lang();\n\n  const {\n    shoppingListInfo,\n    isRequestLoading,\n    setIsRequestLoading,\n    shoppingListId,\n    getShoppingListDetails,\n    setCheckedArr,\n    isReadForApprove,\n    setDeleteItemId,\n    setDeleteOpen,\n    isJuniorApprove,\n    isB2BUser,\n    allowJuniorPlaceOrder,\n    productQuoteEnabled,\n    isCanEditShoppingList,\n    role,\n  } = props;\n\n  const showInclusiveTaxPrice = useAppSelector(({ global }) => global.showInclusiveTaxPrice);\n\n  const { shoppingListCreateActionsPermission, submitShoppingListPermission } =\n    useAppSelector(rolePermissionSelector);\n\n  const canShoppingListActions = isB2BUser\n    ? shoppingListCreateActionsPermission && isCanEditShoppingList\n    : true;\n  const b2bAndBcShoppingListActionsPermissions = isB2BUser ? canShoppingListActions : true;\n  const b2bSubmitShoppingListPermission = isB2BUser\n    ? submitShoppingListPermission\n    : Number(role) === 2;\n\n  const paginationTableRef = useRef<PaginationTableRefProps | null>(null);\n\n  const [chooseOptionsOpen, setSelectedOptionsOpen] = useState(false);\n  const [optionsProduct, setOptionsProduct] = useState<any>(null);\n  const [editProductItemId, setEditProductItemId] = useState<number | string | null>(null);\n  const [search, setSearch] = useState<SearchProps>({\n    orderBy: `-${sortKeys[defaultSortKey]}`,\n  });\n  const [qtyNotChangeFlag, setQtyNotChangeFlag] = useState<boolean>(true);\n  const [originProducts, setOriginProducts] = useState<ListItemProps[]>([]);\n  const [shoppingListTotalPrice, setShoppingListTotalPrice] = useState<number>(0.0);\n\n  const [addNoteOpen, setAddNoteOpen] = useState<boolean>(false);\n  const [addNoteItemId, setAddNoteItemId] = useState<number | string>('');\n  const [notes, setNotes] = useState<string>('');\n  const [disabledSelectAll, setDisabledSelectAll] = useState<boolean>(false);\n\n  const [priceHidden, setPriceHidden] = useState<boolean>(false);\n\n  const [handleSetOrderBy, order, orderBy] = useSort(sortKeys, defaultSortKey, search, setSearch);\n\n  const handleUpdateProductQty = (id: number | string, value: number | string) => {\n    if (Number(value) < 0) return;\n    const currentItem = originProducts.find((item: ListItemProps) => {\n      const { node } = item;\n\n      return node.id === id;\n    });\n\n    const currentQty = currentItem?.node?.quantity || '';\n    setQtyNotChangeFlag(Number(currentQty) === Number(value));\n\n    const listItems: ListItemProps[] = paginationTableRef.current?.getList() || [];\n    const newListItems = listItems?.map((item: ListItemProps) => {\n      const { node } = item;\n      if (node?.id === id) {\n        node.quantity = `${Number(value)}`;\n        node.disableCurrentCheckbox = Number(value) === 0;\n      }\n\n      return item;\n    });\n\n    const nonNumberProducts = newListItems.filter(\n      (item: ListItemProps) => Number(item.node.quantity) === 0,\n    );\n    setDisabledSelectAll(nonNumberProducts.length === newListItems.length);\n    paginationTableRef.current?.setList([...newListItems]);\n  };\n\n  const initSearch = (type?: TableRefreshConfig) => {\n    paginationTableRef.current?.refresh(type);\n  };\n\n  useImperativeHandle(ref, () => ({\n    initSearch,\n    getList: () => paginationTableRef.current?.getList(),\n    setList: () => paginationTableRef.current?.setList(),\n    getSelectedValue: () => paginationTableRef.current?.getSelectedValue(),\n  }));\n\n  const handleSearchProduct = async (q: string) => {\n    setSearch({\n      ...search,\n      search: q,\n    });\n  };\n\n  const handleChooseOptionsDialogCancel = () => {\n    setEditProductItemId('');\n    setSelectedOptionsOpen(false);\n  };\n\n  const handleOpenProductEdit = (product: any, _: number | string, itemId: number | string) => {\n    setEditProductItemId(itemId);\n    setOptionsProduct(product);\n    setSelectedOptionsOpen(true);\n  };\n\n  const handleChooseOptionsDialogConfirm = async (products: CustomFieldItems[]) => {\n    setIsRequestLoading(true);\n    const updateShoppingListItem = isB2BUser\n      ? updateB2BShoppingListsItem\n      : updateBcShoppingListsItem;\n    try {\n      const newOptionLists = getValidOptionsList(products[0].newSelectOptionList, products[0]);\n      const data = {\n        itemId: editProductItemId,\n        shoppingListId,\n        itemData: {\n          variantId: products[0].variantId,\n          quantity: products[0].quantity,\n          optionList: newOptionLists || [],\n        },\n      };\n\n      await updateShoppingListItem(data);\n      setSelectedOptionsOpen(false);\n      setEditProductItemId('');\n      snackbar.success(b3Lang('shoppingList.table.productUpdated'));\n      initSearch({ keepCheckedItems: true });\n    } finally {\n      setIsRequestLoading(false);\n    }\n  };\n\n  const handleUpdateShoppingListItem = async (itemId: number | string) => {\n    const listItems: ListItemProps[] = paginationTableRef.current?.getList() || [];\n    const currentItem = listItems.find((item: ListItemProps) => {\n      const { node } = item;\n\n      return node.itemId === itemId;\n    });\n    let currentNode;\n\n    if (currentItem) {\n      currentNode = currentItem.node;\n    }\n\n    const options = JSON.parse(currentNode?.optionList || '[]');\n\n    const optionsList = options.map(\n      (option: { option_id: number | string; option_value: number | string }) => ({\n        optionId: option.option_id,\n        optionValue: option.option_value,\n      }),\n    );\n\n    const itemData: CustomFieldItems = {\n      variantId: currentNode?.variantId,\n      quantity: currentNode?.quantity ? Number(currentNode.quantity) : 0,\n      optionList: optionsList || [],\n      productNote: notes,\n    };\n\n    const data = {\n      itemId,\n      shoppingListId,\n      itemData,\n    };\n\n    const updateShoppingListItem = isB2BUser\n      ? updateB2BShoppingListsItem\n      : updateBcShoppingListsItem;\n\n    await updateShoppingListItem(data);\n  };\n\n  const handleUpdateShoppingListItemQty = async (itemId: number | string) => {\n    if (qtyNotChangeFlag) return;\n    setIsRequestLoading(true);\n    try {\n      await handleUpdateShoppingListItem(itemId);\n      snackbar.success(b3Lang('shoppingList.table.quantityUpdated'));\n      setQtyNotChangeFlag(true);\n      initSearch({ keepCheckedItems: true });\n    } finally {\n      setIsRequestLoading(false);\n    }\n  };\n\n  const getSelectCheckbox = (selectCheckbox: Array<string | number>) => {\n    if (selectCheckbox.length > 0) {\n      const productList = paginationTableRef.current?.getList() || [];\n      const checkedItems: CustomFieldItems[] = [];\n      selectCheckbox.forEach((item: number | string) => {\n        const newItems = productList.find((product: ListItemProps) => {\n          const { node } = product;\n\n          return node.id === item;\n        });\n\n        if (newItems) checkedItems.push(newItems);\n      });\n\n      setCheckedArr([...checkedItems]);\n    } else {\n      setCheckedArr([]);\n    }\n  };\n\n  const handleCancelAddNotesClick = () => {\n    setAddNoteOpen(false);\n    setAddNoteItemId('');\n    setNotes('');\n  };\n\n  const handleAddItemNotesClick = async () => {\n    setIsRequestLoading(true);\n    try {\n      handleCancelAddNotesClick();\n      await handleUpdateShoppingListItem(addNoteItemId);\n      snackbar.success(b3Lang('shoppingList.table.productNotesUpdated'));\n      initSearch({ keepCheckedItems: true });\n    } finally {\n      setIsRequestLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    if (shoppingListInfo) {\n      const {\n        products: { edges },\n        grandTotal,\n        totalTax,\n      } = shoppingListInfo;\n\n      const NewShoppingListTotalPrice = showInclusiveTaxPrice\n        ? Number(grandTotal)\n        : Number(grandTotal) - Number(totalTax) || 0.0;\n\n      const isPriceHidden = edges.some((item: CustomFieldItems) => {\n        if (item?.node?.productsSearch) {\n          return item.node.productsSearch?.isPriceHidden || false;\n        }\n\n        return false;\n      });\n\n      setPriceHidden(isPriceHidden);\n      setOriginProducts(cloneDeep(edges));\n      setShoppingListTotalPrice(NewShoppingListTotalPrice);\n    }\n  }, [shoppingListInfo, showInclusiveTaxPrice]);\n\n  useEffect(() => {\n    if (shoppingListInfo) {\n      const {\n        products: { edges },\n      } = shoppingListInfo;\n      const nonNumberProducts = edges.filter((item: ListItemProps) => item.node.quantity === 0);\n      setDisabledSelectAll(nonNumberProducts.length === edges.length);\n    }\n  }, [shoppingListInfo]);\n\n  const showPrice = (price: string, row: CustomFieldItems): string | number => {\n    const {\n      productsSearch: { isPriceHidden },\n    } = row;\n    if (isPriceHidden) return '';\n    return getDisplayPrice({\n      price,\n      productInfo: row,\n      showText: isPriceHidden ? '' : price,\n      forcedSkip: true,\n    });\n  };\n\n  const columnItems: TableColumnItem<ListItem>[] = [\n    {\n      key: 'Product',\n      title: b3Lang('shoppingList.table.product'),\n      render: (row: CustomFieldItems) => {\n        const product: any = {\n          ...row.productsSearch,\n          selectOptions: row.optionList,\n        };\n        const productFields = getProductOptionsFields(product, {});\n\n        const optionList = JSON.parse(row.optionList);\n        const optionsValue: CustomFieldItems[] = productFields.filter((item) => item.valueText);\n\n        const currentVariants = product.variants || [];\n        const currentImage =\n          b2bGetVariantImageByVariantInfo(currentVariants, {\n            variantId: row.variantId,\n            variantSku: row.variantSku,\n          }) || row.primaryImage;\n\n        return (\n          <Box\n            sx={{\n              display: 'flex',\n              alignItems: 'flex-start',\n            }}\n          >\n            <StyledImage\n              src={currentImage || PRODUCT_DEFAULT_IMAGE}\n              alt=\"Product-img\"\n              loading=\"lazy\"\n            />\n            <Box>\n              <Typography\n                variant=\"body1\"\n                color=\"#212121\"\n                onClick={() => {\n                  const {\n                    location: { origin },\n                  } = window;\n\n                  window.location.href = `${origin}${row.productUrl}`;\n                }}\n                sx={{\n                  cursor: 'pointer',\n                }}\n              >\n                {row.productName}\n              </Typography>\n              <Typography variant=\"body1\" color=\"#616161\">\n                {row.variantSku}\n              </Typography>\n              {optionList.length > 0 && optionsValue.length > 0 && (\n                <Box>\n                  {optionsValue.map((option: any) => (\n                    <Typography\n                      sx={{\n                        fontSize: '0.75rem',\n                        lineHeight: '1.5',\n                        color: '#455A64',\n                      }}\n                      key={option.valueLabel}\n                    >\n                      {`${option.valueLabel}: ${option.valueText}`}\n                    </Typography>\n                  ))}\n                </Box>\n              )}\n\n              {row?.productNote && row?.productNote.trim().length > 0 && (\n                <Typography\n                  sx={{\n                    fontSize: '0.75rem',\n                    color: '#ED6C02',\n                    marginTop: '0.3rem',\n                  }}\n                >\n                  {row.productNote}\n                </Typography>\n              )}\n            </Box>\n          </Box>\n        );\n      },\n      width: '45%',\n      isSortable: true,\n    },\n    {\n      key: 'Price',\n      title: b3Lang('shoppingList.table.price'),\n      render: (row: CustomFieldItems) => {\n        const { basePrice, taxPrice = 0 } = row;\n        const inTaxPrice = getBCPrice(Number(basePrice), Number(taxPrice));\n\n        return (\n          <Typography\n            sx={{\n              padding: '12px 0',\n            }}\n          >\n            {showPrice(currencyFormat(inTaxPrice), row)}\n          </Typography>\n        );\n      },\n      width: '15%',\n      style: {\n        textAlign: 'right',\n      },\n    },\n    {\n      key: 'Qty',\n      title: b3Lang('shoppingList.table.quantity'),\n      render: (row) => (\n        <StyledTextField\n          size=\"small\"\n          type=\"number\"\n          variant=\"filled\"\n          sx={{\n            width: '72px',\n          }}\n          disabled={\n            b2bAndBcShoppingListActionsPermissions ? isReadForApprove || isJuniorApprove : true\n          }\n          value={row.quantity}\n          inputProps={{\n            inputMode: 'numeric',\n            pattern: '[0-9]*',\n          }}\n          onChange={(e) => {\n            handleUpdateProductQty(row.id, e.target.value);\n          }}\n          onBlur={() => {\n            handleUpdateShoppingListItemQty(row.itemId);\n          }}\n        />\n      ),\n      width: '15%',\n      style: {\n        textAlign: 'right',\n      },\n      isSortable: true,\n    },\n    {\n      key: 'Total',\n      title: b3Lang('shoppingList.table.total'),\n      render: (row: CustomFieldItems) => {\n        const {\n          basePrice,\n          quantity,\n          itemId,\n          productsSearch: { options },\n          taxPrice = 0,\n        } = row;\n\n        const inTaxPrice = getBCPrice(Number(basePrice), Number(taxPrice));\n\n        const totalPrice = inTaxPrice * Number(quantity);\n\n        const optionList = options || JSON.parse(row.optionList);\n\n        const canChangeOption =\n          optionList.length > 0 &&\n          !isReadForApprove &&\n          !isJuniorApprove &&\n          b2bAndBcShoppingListActionsPermissions;\n\n        return (\n          <Box>\n            <Typography\n              sx={{\n                padding: '12px 0',\n              }}\n            >\n              {showPrice(currencyFormat(totalPrice), row)}\n            </Typography>\n            <Box\n              sx={{\n                marginTop: '1rem',\n                opacity: 0,\n                textAlign: isMobile ? 'end' : 'start',\n                display: 'flex',\n                justifyContent: 'flex-end',\n              }}\n              id=\"shoppingList-actionList\"\n            >\n              {canShoppingListActions && (\n                <>\n                  <Grid\n                    item\n                    sx={{\n                      marginRight: '0.5rem',\n                      minWidth: '32px',\n                    }}\n                  >\n                    <StickyNote2\n                      sx={{\n                        cursor: 'pointer',\n                        color: 'rgba(0, 0, 0, 0.54)',\n                      }}\n                      onClick={() => {\n                        setAddNoteOpen(true);\n                        setAddNoteItemId(Number(itemId));\n\n                        if (row.productNote) {\n                          setNotes(row.productNote);\n                        }\n                      }}\n                    />\n                  </Grid>\n\n                  <Grid\n                    item\n                    sx={{\n                      marginRight: canChangeOption ? '0.5rem' : '',\n                      marginLeft: canChangeOption ? '0.3rem' : '',\n                    }}\n                  >\n                    {canChangeOption && (\n                      <Edit\n                        sx={{\n                          cursor: 'pointer',\n                          color: 'rgba(0, 0, 0, 0.54)',\n                        }}\n                        onClick={() => {\n                          const { productsSearch, variantId, itemId, optionList, quantity } = row;\n\n                          handleOpenProductEdit(\n                            {\n                              ...productsSearch,\n                              selectOptions: optionList,\n                              quantity,\n                            },\n                            variantId,\n                            itemId,\n                          );\n                        }}\n                      />\n                    )}\n                  </Grid>\n                  <Grid\n                    item\n                    sx={{\n                      marginLeft: '0.3rem',\n                    }}\n                  >\n                    {b2bAndBcShoppingListActionsPermissions &&\n                      !isReadForApprove &&\n                      !isJuniorApprove && (\n                        <Delete\n                          sx={{\n                            cursor: 'pointer',\n                            color: 'rgba(0, 0, 0, 0.54)',\n                          }}\n                          onClick={() => {\n                            setDeleteOpen(true);\n                            setDeleteItemId(Number(itemId));\n                          }}\n                        />\n                      )}\n                  </Grid>\n                </>\n              )}\n            </Box>\n          </Box>\n        );\n      },\n      width: '15%',\n      style: {\n        textAlign: 'right',\n      },\n    },\n  ];\n\n  return (\n    <StyledShoppingListTableContainer>\n      <Box\n        sx={{\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'space-between',\n          margin: '0 0 1rem 0',\n        }}\n      >\n        <Typography\n          sx={{\n            fontSize: '24px',\n          }}\n        >\n          {b3Lang('shoppingList.table.totalProductCount', {\n            quantity: shoppingListInfo?.products?.totalCount || 0,\n          })}\n        </Typography>\n        <Typography\n          sx={{\n            fontSize: '24px',\n          }}\n        >\n          {priceHidden ? '' : currencyFormat(shoppingListTotalPrice || 0.0)}\n        </Typography>\n      </Box>\n      <Box\n        sx={{\n          marginBottom: '5px',\n        }}\n      >\n        <B3FilterSearch\n          searchBGColor=\"rgba(0, 0, 0, 0.06)\"\n          handleChange={(e) => {\n            handleSearchProduct(e);\n          }}\n        />\n      </Box>\n\n      <B3PaginationTable\n        ref={paginationTableRef}\n        columnItems={columnItems}\n        rowsPerPageOptions={[10, 20, 50]}\n        getRequestList={getShoppingListDetails}\n        searchParams={search}\n        isCustomRender={false}\n        showCheckbox\n        showSelectAllCheckbox\n        applyAllDisableCheckbox={false}\n        disableCheckbox={\n          disabledSelectAll ||\n          (b2bSubmitShoppingListPermission\n            ? !(allowJuniorPlaceOrder || productQuoteEnabled)\n            : (isReadForApprove || isJuniorApprove) && b2bAndBcShoppingListActionsPermissions)\n        }\n        hover\n        labelRowsPerPage={b3Lang('shoppingList.table.itemsPerPage')}\n        showBorder={false}\n        requestLoading={setIsRequestLoading}\n        getSelectCheckbox={getSelectCheckbox}\n        itemIsMobileSpacing={0}\n        noDataText={b3Lang('shoppingList.table.noProductsFound')}\n        sortDirection={order}\n        orderBy={orderBy}\n        sortByFn={handleSetOrderBy}\n        pageType=\"shoppingListDetailsTable\"\n        renderItem={(row, index, checkBox) => (\n          <ShoppingDetailCard\n            len={shoppingListInfo?.products?.edges.length || 0}\n            item={row}\n            itemIndex={index}\n            showPrice={showPrice}\n            onEdit={handleOpenProductEdit}\n            onDelete={setDeleteItemId}\n            checkBox={checkBox}\n            setDeleteOpen={setDeleteOpen}\n            setAddNoteOpen={setAddNoteOpen}\n            setAddNoteItemId={setAddNoteItemId}\n            setNotes={setNotes}\n            handleUpdateProductQty={handleUpdateProductQty}\n            handleUpdateShoppingListItem={handleUpdateShoppingListItemQty}\n            isReadForApprove={isReadForApprove || isJuniorApprove}\n            b2bAndBcShoppingListActionsPermissions={b2bAndBcShoppingListActionsPermissions}\n          />\n        )}\n      />\n\n      <ChooseOptionsDialog\n        isOpen={chooseOptionsOpen}\n        isLoading={isRequestLoading}\n        setIsLoading={setIsRequestLoading}\n        product={optionsProduct}\n        type=\"shoppingList\"\n        onCancel={handleChooseOptionsDialogCancel}\n        onConfirm={handleChooseOptionsDialogConfirm}\n        isEdit\n      />\n\n      <ShoppingDetailAddNotes\n        open={addNoteOpen}\n        notes={notes}\n        setNotes={setNotes}\n        handleCancelAddNotesClick={handleCancelAddNotesClick}\n        handleAddItemNotesClick={handleAddItemNotesClick}\n      />\n    </StyledShoppingListTableContainer>\n  );\n}\n\nexport default forwardRef(ShoppingDetailTable);\n","import { useContext, useEffect, useMemo, useRef, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { Box, Grid, useTheme } from '@mui/material';\n\nimport B3Spin from '@/components/spin/B3Spin';\nimport { useFeatureFlags, useMobile } from '@/hooks';\nimport { useB3Lang } from '@/lib/lang';\nimport { GlobalContext } from '@/shared/global';\nimport {\n  deleteB2BShoppingListItem,\n  deleteBcShoppingListItem,\n  getB2BJuniorPlaceOrder,\n  getB2BShoppingListDetails,\n  getBcShoppingListDetails,\n  searchProducts,\n  updateB2BShoppingList,\n  updateBcShoppingList,\n} from '@/shared/service/b2b';\nimport {\n  activeCurrencyInfoSelector,\n  isB2BUserSelector,\n  rolePermissionSelector,\n  useAppSelector,\n} from '@/store';\nimport { CustomerRole } from '@/types/company';\nimport { ShoppingListStatus } from '@/types/shoppingList';\nimport { channelId, snackbar, verifyLevelPermission } from '@/utils';\nimport { b2bPermissionsMap } from '@/utils/b3CheckPermissions/config';\nimport { calculateProductListPrice, getBCPrice } from '@/utils/b3Product/b3Product';\nimport {\n  conversionProductsList,\n  CustomerInfoProps,\n  ListItemProps,\n  ProductsProps,\n  SearchProps,\n  ShoppingListInfoProps,\n} from '@/utils/b3Product/shared/config';\n\nimport { type PageProps } from '../PageProps';\n\nimport AddToShoppingList from './components/AddToShoppingList';\nimport ReAddToCart from './components/ReAddToCart';\nimport ShoppingDetailDeleteItems from './components/ShoppingDetailDeleteItems';\nimport ShoppingDetailFooter from './components/ShoppingDetailFooter';\nimport ShoppingDetailHeader from './components/ShoppingDetailHeader';\nimport ShoppingDetailTable from './components/ShoppingDetailTable';\nimport {\n  ShoppingListDetailsContext,\n  ShoppingListDetailsProvider,\n} from './context/ShoppingListDetailsContext';\n\ninterface TableRefProps extends HTMLInputElement {\n  initSearch: () => void;\n}\n\ninterface UpdateShoppingListParamsProps {\n  id: number;\n  name: string;\n  description: string;\n  status?: number;\n  channelId?: number;\n}\n\nconst calculateSubTotal = (checkedArr: CustomFieldItems) => {\n  if (checkedArr.length > 0) {\n    let total = 0.0;\n\n    checkedArr.forEach((item: ListItemProps) => {\n      const {\n        node: { quantity, basePrice, taxPrice },\n      } = item;\n\n      const price = getBCPrice(Number(basePrice), Number(taxPrice));\n\n      total += price * Number(quantity);\n    });\n\n    return (1000 * total) / 1000;\n  }\n  return 0.0;\n};\n\nfunction useData() {\n  const { id = '' } = useParams();\n  const {\n    state: { openAPPParams, productQuoteEnabled = false },\n  } = useContext(GlobalContext);\n  const isB2BUser = useAppSelector(isB2BUserSelector);\n  const { currency_code: currencyCode } = useAppSelector(activeCurrencyInfoSelector);\n  const role = useAppSelector(({ company }) => company.customer.role);\n  const companyId = useAppSelector(({ company }) => company.companyInfo.id);\n  const customerGroupId = useAppSelector(({ company }) => company.customer.customerGroupId);\n\n  const isAgenting = useAppSelector(({ b2bFeatures }) => b2bFeatures.masqueradeCompany.isAgenting);\n\n  const theme = useTheme();\n  const primaryColor = theme.palette.primary.main;\n\n  const {\n    shoppingListCreateActionsPermission,\n    purchasabilityPermission,\n    submitShoppingListPermission,\n  } = useAppSelector(rolePermissionSelector);\n\n  const isCanAddToCart = isB2BUser ? purchasabilityPermission : true;\n\n  const getProducts = async (productIds: number[]) => {\n    const options = { productIds, currencyCode, companyId, customerGroupId };\n    const { productsSearch } = await searchProducts(options);\n\n    return conversionProductsList(productsSearch);\n  };\n\n  const getShoppingList = (params: SearchProps) => {\n    const options = { ...params, id };\n\n    return isB2BUser ? getB2BShoppingListDetails(options) : getBcShoppingListDetails(options);\n  };\n\n  const deleteShoppingListItem = (itemId: string | number) => {\n    const options = { itemId, shoppingListId: id };\n\n    return isB2BUser ? deleteB2BShoppingListItem(options) : deleteBcShoppingListItem(options);\n  };\n\n  return {\n    id,\n    openAPPParams,\n    productQuoteEnabled,\n    isB2BUser,\n    role,\n    isAgenting,\n    primaryColor,\n    shoppingListCreateActionsPermission,\n    submitShoppingListPermission,\n    isCanAddToCart,\n    getProducts,\n    getShoppingList,\n    deleteShoppingListItem,\n  };\n}\n\n// 0: Admin, 1: Senior buyer, 2: Junior buyer, 3: Super admin\n\nfunction ShoppingListDetails({ setOpenPage }: PageProps) {\n  const {\n    id,\n    openAPPParams,\n    productQuoteEnabled,\n    isB2BUser,\n    role,\n    isAgenting,\n    primaryColor,\n    shoppingListCreateActionsPermission,\n    submitShoppingListPermission,\n    isCanAddToCart,\n    getProducts,\n    getShoppingList,\n    deleteShoppingListItem,\n  } = useData();\n  const navigate = useNavigate();\n  const [isMobile] = useMobile();\n  const { dispatch } = useContext(ShoppingListDetailsContext);\n\n  const b3Lang = useB3Lang();\n\n  const tableRef = useRef<TableRefProps | null>(null);\n\n  const featureFlags = useFeatureFlags();\n  const backendValidationEnabled =\n    featureFlags['B2B-3318.move_stock_and_backorder_validation_to_backend'];\n\n  const [checkedArr, setCheckedArr] = useState<CustomFieldItems>([]);\n  const [shoppingListInfo, setShoppingListInfo] = useState<null | ShoppingListInfoProps>(null);\n  const [customerInfo, setCustomerInfo] = useState<null | CustomerInfoProps>(null);\n  const [isRequestLoading, setIsRequestLoading] = useState(false);\n\n  const [deleteOpen, setDeleteOpen] = useState<boolean>(false);\n  const [deleteItemId, setDeleteItemId] = useState<number | string>('');\n\n  const [validateSuccessProducts, setValidateSuccessProducts] = useState<ProductsProps[]>([]);\n  const [validateFailureProducts, setValidateFailureProducts] = useState<ProductsProps[]>([]);\n\n  const [allowJuniorPlaceOrder, setAllowJuniorPlaceOrder] = useState<boolean>(false);\n  const [isCanEditShoppingList, setIsCanEditShoppingList] = useState<boolean>(true);\n\n  const b2bAndBcShoppingListActionsPermissions = isB2BUser\n    ? shoppingListCreateActionsPermission && isCanEditShoppingList\n    : true;\n\n  const submitShoppingList = useMemo(() => {\n    if (isB2BUser && shoppingListInfo) {\n      const { companyInfo, customerInfo } = shoppingListInfo;\n      const { submitShoppingListPermission: submitShoppingListPermissionCode } = b2bPermissionsMap;\n      const submitShoppingListPermissionLevel = verifyLevelPermission({\n        code: submitShoppingListPermissionCode,\n        companyId: Number(companyInfo?.companyId || 0),\n        userId: Number(customerInfo?.userId || 0),\n      });\n\n      return submitShoppingListPermissionLevel;\n    }\n\n    return submitShoppingListPermission;\n  }, [submitShoppingListPermission, isB2BUser, shoppingListInfo]);\n  const b2bSubmitShoppingListPermission = isB2BUser\n    ? submitShoppingList\n    : role === CustomerRole.JUNIOR_BUYER;\n\n  const isJuniorApprove =\n    shoppingListInfo?.status === ShoppingListStatus.Approved && b2bSubmitShoppingListPermission;\n\n  const isReadForApprove =\n    shoppingListInfo?.status === ShoppingListStatus.ReadyForApproval ||\n    shoppingListInfo?.status === ShoppingListStatus.Rejected ||\n    // Status code 20 was previously misused as Rejected in the frontend, which is actually Deleted\n    // We need to add Deleted here so that the shopping lists that were previously rejected remain the same behavior\n    shoppingListInfo?.status === ShoppingListStatus.Deleted;\n\n  const goToShoppingLists = () => {\n    navigate('/shoppingLists');\n  };\n\n  useEffect(() => {\n    dispatch({\n      type: 'init',\n      payload: {\n        id: parseInt(id, 10) || 0,\n      },\n    });\n    // disabling as we don't need a dispatcher here\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [id]);\n\n  const handleGetProductsById = async (listProducts: ListItemProps[]) => {\n    if (listProducts.length > 0) {\n      try {\n        const productIds: number[] = [];\n        listProducts.forEach((item) => {\n          const { node } = item;\n          if (!productIds.includes(node.productId)) {\n            productIds.push(node.productId);\n          }\n        });\n\n        const newProductsSearch = await getProducts(productIds);\n\n        listProducts.forEach((item) => {\n          const { node } = item;\n\n          const productInfo = newProductsSearch.find((search: CustomFieldItems) => {\n            const { id: productId } = search;\n\n            return node.productId === productId;\n          });\n\n          node.productsSearch = productInfo || {};\n          node.productName = productInfo?.name || node.productName;\n          node.productUrl = productInfo?.productUrl || node.productUrl;\n\n          node.disableCurrentCheckbox = false;\n          if (node.quantity === 0) {\n            node.disableCurrentCheckbox = true;\n          }\n        });\n\n        return listProducts;\n      } catch (err: any) {\n        snackbar.error(err);\n      }\n    }\n\n    return [];\n  };\n\n  const getShoppingListDetails = async (params: SearchProps) => {\n    const shoppingListDetailInfo = await getShoppingList(params);\n    setIsRequestLoading(true);\n    const {\n      products: { edges, totalCount },\n    } = shoppingListDetailInfo;\n\n    const listProducts = await handleGetProductsById(edges);\n\n    await calculateProductListPrice(listProducts, '2');\n\n    if (isB2BUser) setCustomerInfo(shoppingListDetailInfo.customerInfo);\n    setShoppingListInfo(shoppingListDetailInfo);\n    setIsRequestLoading(false);\n    if (!listProducts) {\n      return {\n        edges: [],\n        totalCount: 0,\n      };\n    }\n\n    return {\n      edges: listProducts,\n      totalCount,\n    };\n  };\n\n  const handleUpdateShoppingList = async (status: number) => {\n    setIsRequestLoading(true);\n    try {\n      const params: UpdateShoppingListParamsProps = {\n        id: Number(id),\n        name: shoppingListInfo?.name || '',\n        description: shoppingListInfo?.description || '',\n      };\n\n      if (isB2BUser) {\n        await updateB2BShoppingList({\n          ...params,\n          status,\n        });\n      } else {\n        await updateBcShoppingList({\n          ...params,\n          channelId,\n        });\n      }\n\n      snackbar.success(b3Lang('shoppingList.shoppingListStatusUpdated'));\n      tableRef.current?.initSearch();\n    } finally {\n      setIsRequestLoading(false);\n    }\n  };\n\n  const updateList = () => {\n    tableRef.current?.initSearch();\n  };\n\n  const handleCancelClick = () => {\n    setDeleteOpen(false);\n    setDeleteItemId('');\n  };\n\n  const handleDeleteItems = async (itemId: number | string = '') => {\n    setIsRequestLoading(true);\n\n    try {\n      if (itemId) {\n        await deleteShoppingListItem(itemId);\n\n        if (checkedArr.length > 0) {\n          const newCheckedArr = checkedArr.filter((item: ListItemProps) => {\n            const { itemId: checkedItemId } = item.node;\n\n            return itemId !== checkedItemId;\n          });\n\n          setCheckedArr([...newCheckedArr]);\n        }\n      } else {\n        if (checkedArr.length === 0) return;\n        checkedArr.forEach(async (item: ListItemProps) => {\n          const { node } = item;\n\n          await deleteShoppingListItem(node.itemId);\n        });\n\n        setCheckedArr([]);\n      }\n\n      snackbar.success(b3Lang('shoppingList.productRemoved'));\n    } finally {\n      setIsRequestLoading(false);\n      updateList();\n    }\n  };\n\n  const handleDeleteProductClick = async () => {\n    await handleDeleteItems(Number(deleteItemId));\n    await handleCancelClick();\n  };\n\n  const getJuniorPlaceOrder = async () => {\n    const {\n      storeConfigSwitchStatus: { isEnabled },\n    } = await getB2BJuniorPlaceOrder();\n\n    setAllowJuniorPlaceOrder(isEnabled === '1' && isCanAddToCart);\n  };\n\n  useEffect(() => {\n    if (isJuniorApprove) getJuniorPlaceOrder();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isJuniorApprove]);\n\n  useEffect(() => {\n    if (isB2BUser && shoppingListInfo) {\n      const { companyInfo, customerInfo } = shoppingListInfo;\n\n      const { shoppingListCreateActionsPermission } = b2bPermissionsMap;\n      const shoppingListActionsPermission = verifyLevelPermission({\n        code: shoppingListCreateActionsPermission,\n        companyId: Number(companyInfo?.companyId || 0),\n        userId: Number(customerInfo?.userId || 0),\n      });\n\n      setIsCanEditShoppingList(shoppingListActionsPermission);\n    }\n  }, [shoppingListInfo, isB2BUser]);\n\n  return (\n    <>\n      <Box\n        sx={{\n          display: 'flex',\n          flexDirection: 'column',\n          flex: 1,\n        }}\n      >\n        <ShoppingDetailHeader\n          isB2BUser={isB2BUser}\n          shoppingListInfo={shoppingListInfo}\n          customerInfo={customerInfo}\n          role={role}\n          goToShoppingLists={goToShoppingLists}\n          handleUpdateShoppingList={handleUpdateShoppingList}\n          setOpenPage={setOpenPage}\n          isAgenting={isAgenting}\n          openAPPParams={openAPPParams}\n          customColor={primaryColor}\n        />\n\n        <Grid\n          container\n          spacing={2}\n          sx={{\n            marginTop: '0',\n            overflow: 'auto',\n            flexWrap: isMobile ? 'wrap' : 'nowrap',\n            paddingBottom: '20px',\n            marginBottom: isMobile ? '6rem' : 0,\n          }}\n        >\n          <Box\n            sx={\n              isMobile\n                ? {\n                    flexBasis: '100%',\n                    pl: '16px',\n                  }\n                : {\n                    flexBasis: '690px',\n                    flexGrow: 1,\n                    ml: '16px',\n                    pt: '16px',\n                  }\n            }\n          >\n            <B3Spin isSpinning={isRequestLoading} spinningHeight=\"auto\">\n              <Grid\n                item\n                sx={\n                  isMobile\n                    ? {\n                        flexBasis: '100%',\n                      }\n                    : {\n                        flexBasis: '690px',\n                        flexGrow: 1,\n                      }\n                }\n              >\n                <ShoppingDetailTable\n                  ref={tableRef}\n                  isReadForApprove={isReadForApprove}\n                  isJuniorApprove={isJuniorApprove}\n                  allowJuniorPlaceOrder={allowJuniorPlaceOrder}\n                  setCheckedArr={setCheckedArr}\n                  shoppingListInfo={shoppingListInfo}\n                  isRequestLoading={isRequestLoading}\n                  setIsRequestLoading={setIsRequestLoading}\n                  shoppingListId={id}\n                  getShoppingListDetails={getShoppingListDetails}\n                  setDeleteOpen={setDeleteOpen}\n                  setDeleteItemId={setDeleteItemId}\n                  isB2BUser={isB2BUser}\n                  productQuoteEnabled={productQuoteEnabled}\n                  isCanEditShoppingList={isCanEditShoppingList}\n                  role={role}\n                />\n              </Grid>\n            </B3Spin>\n          </Box>\n\n          <Grid\n            item\n            sx={\n              isMobile\n                ? {\n                    flexBasis: '100%',\n                  }\n                : {\n                    flexBasis: '340px',\n                  }\n            }\n          >\n            {b2bAndBcShoppingListActionsPermissions && !isReadForApprove && !isJuniorApprove && (\n              <AddToShoppingList\n                updateList={updateList}\n                type=\"shoppingList\"\n                isB2BUser={isB2BUser}\n              />\n            )}\n          </Grid>\n        </Grid>\n\n        {!isReadForApprove &&\n          (allowJuniorPlaceOrder || productQuoteEnabled || !isJuniorApprove) && (\n            <ShoppingDetailFooter\n              shoppingListInfo={shoppingListInfo}\n              allowJuniorPlaceOrder={allowJuniorPlaceOrder}\n              checkedArr={checkedArr}\n              selectedSubTotal={calculateSubTotal(checkedArr)}\n              setLoading={setIsRequestLoading}\n              setDeleteOpen={setDeleteOpen}\n              setValidateFailureProducts={setValidateFailureProducts}\n              setValidateSuccessProducts={setValidateSuccessProducts}\n              isB2BUser={isB2BUser}\n              customColor={primaryColor}\n              isCanEditShoppingList={isCanEditShoppingList}\n              role={role}\n              backendValidationEnabled={backendValidationEnabled}\n            />\n          )}\n      </Box>\n\n      <ReAddToCart\n        shoppingListInfo={shoppingListInfo}\n        role={role}\n        products={validateFailureProducts}\n        successProducts={validateSuccessProducts.length}\n        allowJuniorPlaceOrder={allowJuniorPlaceOrder}\n        setValidateFailureProducts={setValidateFailureProducts}\n        setValidateSuccessProducts={setValidateSuccessProducts}\n        textAlign={isMobile ? 'left' : 'right'}\n        backendValidationEnabled={backendValidationEnabled}\n      />\n\n      <ShoppingDetailDeleteItems\n        open={deleteOpen}\n        handleCancelClick={handleCancelClick}\n        handleDeleteProductClick={handleDeleteProductClick}\n      />\n    </>\n  );\n}\n\nfunction ShoppingListDetailsContent({ setOpenPage }: PageProps) {\n  return (\n    <ShoppingListDetailsProvider>\n      <ShoppingListDetails setOpenPage={setOpenPage} />\n    </ShoppingListDetailsProvider>\n  );\n}\n\nexport default ShoppingListDetailsContent;\n"],"names":["B3QuantityTextField","props","isMobile","useMobile","disabled","label","value","maxQuantity","minQuantity","isStock","stock","hiddenLabel","onChange","sx","validMessage","setValidMessage","useState","validateQuantity","useCallback","quantity","handleChange","handleBlur","useEffect","jsx","StyledNumberNoTopTextField","e","AddToShoppingList","id","useContext","ShoppingListDetailsContext","companyStatus","useAppSelector","company","updateList","isB2BUser","pageType","b3Lang","useB3Lang","isOpenBulkLoadCSV","setIsOpenBulkLoadCSV","isLoading","setIsLoading","blockPendingAccountViewPrice","useBlockPendingAccountViewPrice","addItemsToShoppingList","addProductToShoppingList","addProductToBcShoppingList","addToList","products","dispatchEvent","items","product","getValidOptionsList","snackbar","quickAddToList","getValidProducts","notPurchaseSku","productItems","notAddAble","item","currentProduct","qty","option","purchasingDisabled","variantSku","variantId","productId","modifiers","defaultModifiers","getAllModifierDefaultValue","modifier","optionsList","type","defaultValue","key","handleCSVAddToList","productsData","validProduct","handleOpenUploadDiag","Card","CardContent","jsxs","Box","Typography","SearchProduct","Divider","QuickAdd","CustomButton","UploadFileIcon","B3Upload","Flex","styled","isHeader","FlexItem","width","padding","flexBasis","flexDirection","alignItems","textAlignLocation","ProductHead","ProductImage","defaultItemStyle","mobileItemStyle","ReAddToCart","shoppingListInfo","successProducts","allowJuniorPlaceOrder","setValidateFailureProducts","setValidateSuccessProducts","textAlign","backendValidationEnabled","submitShoppingListPermission","rolePermissionSelector","isOpen","setOpen","loading","setLoading","decimalPlaces","activeCurrencyInfoSelector","itemStyle","handleUpdateProductQty","index","isValid","newProduct","calculateProduct","setModifierQtyPrice","handleCancelClicked","deleteProduct","shouldRedirectToCheckout","ShoppingListStatus","CHECKOUT_URL","CART_URL","b3TriggerCartNumber","handlePrimaryAction","lineItems","addLineItems","res","createOrUpdateExistingCart","handleReAddToCartBackend","addOrProceedToCheckout","handleClearNoStock","requestArr","quantityNumber","_a","B3Dialog","Grid","Alert","B3Spin","primaryImage","productName","optionList","productsSearch","basePrice","price","total","productFields","getProductOptionsFields","newOptionList","optionsValue","PRODUCT_DEFAULT_IMAGE","currencyFormat","Delete","ShoppingDetailDeleteItems","open","handleCancelClick","handleDeleteProductClick","ShoppingDetailFooter","navigate","useNavigate","featureFlags","useFeatureFlags","productQuoteEnabled","GlobalContext","isAgenting","b2bFeatures","companyId","customerGroupId","shoppingListCreateActionsPermission","purchasabilityPermission","ref","useRef","setIsOpen","cartEntityId","Cookies","containerStyle","checkedArr","selectedSubTotal","setDeleteOpen","customColor","isCanEditShoppingList","role","b2bShoppingListActionsPermission","isCanAddToCart","b2bSubmitShoppingListPermission","handleOpenBtnList","handleClose","verifyInventory","inventoryInfos","validateFailureArr","validateSuccessArr","node","inventoryInfo","isPassVerify","addToQuote","validatedProducts","validateProducts","addQuoteDraftProducts","shouldRedirectCheckout","handleAddToCartOnFrontend","skus","cantPurchase","getInventoryInfos","getVariantInfoBySkus","deleteCartObject","deleteCartData","cartInfo","getCart","deleteCart","updateCart","handleAddToCartBackend","handleAddProductsToCart","getOptionsList","options","optionId","optionValue","handleAddSelectedToQuote","productsWithSku","checkedItem","noSkuProducts","productIds","searchProducts","newProductInfo","conversionProductsList","errorMessage","isFondVariant","newProducts","tax","currentProductSearch","variantItem","quoteListitem","uuid","isValidQty","validProductQty","calculateProductListPrice","b2bLogger","buttons","buttonList","Fragment","ArrowDropDown","Menu","button","MenuItem","StyledCreateName","ShoppingDetailHeader","customerInfo","handleUpdateShoppingList","goToShoppingLists","setOpenPage","openAPPParams","backgroundColor","CustomStyleContext","selectCompanyHierarchyId","submitShoppingList","approveShoppingList","shoppingListPermissions","useMemo","companyInfo","submitShoppingListPermissionCode","approveShoppingListPermissionCode","b2bPermissionsMap","submitShoppingListPermissionLevel","verifySubmitShoppingListSubsidiariesPermission","approveShoppingListPermissionLevel","verifyLevelPermission","isDisabledBtn","approveShoppingListPermission","gridOptions","xs","ArrowBackIosNew","getContrastColor","ShoppingListStatusTag","ShoppingDetailAddNotes","notes","setNotes","handleCancelAddNotesClick","handleAddItemNotesClick","TextField","StyledImage","ShoppingDetailCard","shoppingDetail","onEdit","onDelete","checkBox","handleUpdateShoppingListItem","isReadForApprove","len","itemIndex","setAddNoteOpen","setAddNoteItemId","showPrice","b2bAndBcShoppingListActionsPermissions","itemId","productUrl","taxPrice","productNote","getBCPrice","canChangeOption","currentVariants","currentImage","b2bGetVariantImageByVariantInfo","origin","StickyNote2","Edit","StyledShoppingListTableContainer","StyledTextField","defaultSortKey","sortKeys","ShoppingDetailTable","isRequestLoading","setIsRequestLoading","shoppingListId","getShoppingListDetails","setCheckedArr","setDeleteItemId","isJuniorApprove","showInclusiveTaxPrice","global","canShoppingListActions","paginationTableRef","chooseOptionsOpen","setSelectedOptionsOpen","optionsProduct","setOptionsProduct","editProductItemId","setEditProductItemId","search","setSearch","qtyNotChangeFlag","setQtyNotChangeFlag","originProducts","setOriginProducts","shoppingListTotalPrice","setShoppingListTotalPrice","addNoteOpen","addNoteItemId","disabledSelectAll","setDisabledSelectAll","priceHidden","setPriceHidden","handleSetOrderBy","order","orderBy","useSort","currentItem","currentQty","listItems","_b","newListItems","nonNumberProducts","_c","initSearch","useImperativeHandle","handleSearchProduct","q","handleChooseOptionsDialogCancel","handleOpenProductEdit","_","handleChooseOptionsDialogConfirm","updateShoppingListItem","updateB2BShoppingListsItem","updateBcShoppingListsItem","newOptionLists","data","currentNode","itemData","handleUpdateShoppingListItemQty","getSelectCheckbox","selectCheckbox","productList","checkedItems","newItems","edges","grandTotal","totalTax","NewShoppingListTotalPrice","isPriceHidden","cloneDeep","row","getDisplayPrice","columnItems","inTaxPrice","totalPrice","B3FilterSearch","B3PaginationTable","ChooseOptionsDialog","ShoppingDetailTable$1","forwardRef","calculateSubTotal","useData","useParams","isB2BUserSelector","currencyCode","primaryColor","useTheme","params","getB2BShoppingListDetails","getBcShoppingListDetails","deleteB2BShoppingListItem","deleteBcShoppingListItem","ShoppingListDetails","getProducts","getShoppingList","deleteShoppingListItem","dispatch","tableRef","setShoppingListInfo","setCustomerInfo","deleteOpen","deleteItemId","validateSuccessProducts","validateFailureProducts","setAllowJuniorPlaceOrder","setIsCanEditShoppingList","CustomerRole","handleGetProductsById","listProducts","newProductsSearch","productInfo","err","shoppingListDetailInfo","totalCount","status","updateB2BShoppingList","updateBcShoppingList","channelId","handleDeleteItems","newCheckedArr","checkedItemId","getJuniorPlaceOrder","isEnabled","getB2BJuniorPlaceOrder","shoppingListActionsPermission","ShoppingListDetailsContent","ShoppingListDetailsProvider"],"mappings":"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"}