System.register(["./mui-legacy-Co1sKVsS.js","./intl-legacy-f5dGU49Z.js","./router-legacy-CQEMCAt4.js","./getAssetUrl-legacy-Br2uuqlc.js","./B3Card-legacy-DRA-Op8r.js","./react-setup-legacy-CKF-9cua.js","./base-legacy-DAqmyLJs.js","./load-functions-legacy-B3DSplhu.js","./b3Login-legacy-Dv9m0gQv.js","./login-legacy-CekhwUsI.js","./config-legacy-DFBcCeiq.js","./form-legacy-LlvE08FY.js","./B3CustomForm-legacy-iy2Vgra_.js","./styled-legacy-DUIpg82W.js","./reactVendor-legacy-C5drotBr.js","./eCache-legacy-QcRlogRO.js","./redux-legacy-DH94TLLa.js","./toolkit-legacy-DO7GmFjE.js","./lodashEs-legacy-BTGS6uHg.js","../index-legacy.JvindH6T.js","./global-legacy-vVqwfyov.js","./muiIcon-legacy-C-h6sDde.js","./dropzone-legacy-B1uEXZk9.js","./dateFns-legacy-DHywh9DD.js","./validatorRules-legacy-CnaQOFg7.js"],function(e,t){"use strict";var n,o,a,s,i,r,l,c,u,g,d,x,p,m,f,y,h,b,j,w,T,C,v,B,F,H,I,k,A,P,S,E,L,R,D,_,O,q,N,U,V,Y,G,M,W,z,K,J,Q,X,Z,$,ee,te,ne,oe,ae,se,ie;return{setters:[e=>{n=e.j,o=e.B,a=e.O,s=e.T,i=e.y,r=e.a0,l=e.a1,c=e.a7},e=>{u=e.r},e=>{g=e.a,d=e.d,x=e.L},e=>{p=e.g,m=e.b},e=>{f=e.B},e=>{y=e.u,h=e.aE,b=e.a7,j=e.aF,w=e.aC,T=e.n,C=e.aG,v=e.j,B=e.l,F=e.a,H=e.K,I=e.a3,k=e.i,A=e.r,P=e.w,S=e.G,E=e.C,L=e.ak,R=e.af,D=e.aH,_=e.e,O=e.I,q=e.aI,N=e.L,U=e.aJ,V=e.M,Y=e.ai,G=e.ah,M=e.P,W=e.aK,z=e.aL},e=>{K=e.b},null,e=>{J=e.l},e=>{Q=e.b,X=e.a,Z=e.c},e=>{$=e.a,ee=e.i,te=e.l,ne=e.b},e=>{oe=e.u},e=>{ae=e.B},e=>{se=e.a,ie=e.L},null,null,null,null,null,null,null,null,null,null,null],execute:function(){function t(e){const{html:t,sx:a}=e;return n.jsx(o,{sx:{...a},dangerouslySetInnerHTML:{__html:t}})}e("default",function(e){return"catalyst"===P?n.jsx(ue,{}):n.jsx(me,{...e})});const re=()=>Q().then(e=>{if("success"!==e.data.logout.result)throw new Error("Failed to logout")}),le=()=>{const e=y(({b2bFeatures:e})=>e.masqueradeCompany.isAgenting),t=y(({b2bFeatures:e})=>e.masqueradeCompany.id);return u.useCallback(async()=>{e&&T(Number(t))},[e,t])},ce=()=>{const{selectCompanyHierarchyId:e}=y(({company:e})=>e.companyHierarchyInfo);return u.useCallback(async()=>{e&&await C()},[e])};function ue(){const e=g(),t=le(),o=ce(),a=y(h),s=y(({company:e})=>e.tokens.B2BToken),[i]=d(),r=i.get("loginFlag");return u.useEffect(()=>{const e=setTimeout(()=>{window.location.href="/login"},3e3);return()=>{clearTimeout(e)}},[s]),u.useEffect(()=>{"loggedOutLogin"!==r&&s?a&&e("/orders"):Promise.all([re(),t(),o()]).catch(()=>{e("/orders")}).then(()=>{window.sessionStorage.clear(),b.dispatch(j()),window.b2b.callbacks.dispatchEvent("on-logout")})},[o,t,a,r,e,s]),n.jsx(w,{})}function ge(e){const{loginBtn:t,handleLoginSubmit:l,backgroundColor:c}=e,u=v(),g=a(),{control:d,handleSubmit:p,getValues:m,formState:{errors:f},setValue:y}=oe({mode:"onSubmit"}),h=e=>{l(e)},b=$(u,p(h));return n.jsxs(o,{sx:{display:"flex",flexDirection:"column"},children:[n.jsx(s,{variant:"h5",sx:{margin:"20px 0",display:"flex",justifyContent:"center",alignItems:"center"},children:u("login.loginText.signInHeader")}),n.jsx(o,{sx:{width:"100%","& input":{bgcolor:"#F5F5F5",borderRadius:"4px",borderBottomLeftRadius:"0",borderBottomRightRadius:"0"}},children:n.jsxs("form",{onSubmit:p(h),children:[n.jsx(ae,{formFields:b,errors:f,control:d,getValues:m,setValue:y}),n.jsxs(o,{sx:{display:"flex",justifyContent:"flex-start ",alignItems:"center",mt:2,gap:2},children:[n.jsx(i,{type:"submit",variant:"contained",sx:{backgroundColor:g.palette.primary.main},children:t}),n.jsx(r,{component:x,color:B(c),to:"/forgotPassword",children:u("login.loginText.forgotPasswordText")})]})]})})]})}function de(e){const{widgetBodyText:s,createAccountButtonText:r}=e,l=a(),[c]=F();return n.jsxs(o,{sx:{padding:c?"16px":"20px",borderRadius:"4px",mt:c?"0":"-25px"},children:[n.jsx(t,{sx:{minHeight:"250px","& .panel":{".panel-title":{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",fontWeight:400,fontSize:"24px"}}},html:s}),n.jsx(o,{sx:{marginTop:"5px"},children:n.jsx(i,{component:x,to:"/register",variant:"contained",sx:{ml:c?0:1,backgroundColor:l.palette.primary.main},children:r})})]})}const xe=()=>{const e=(()=>{const e=y(({b2bFeatures:e})=>e.masqueradeCompany.isAgenting),t=y(({b2bFeatures:e})=>e.masqueradeCompany.id),n=k();return u.useCallback(async()=>{e&&(await T(Number(t)),n(A()))},[t,n,e])})(),t=(()=>{const{selectCompanyHierarchyId:e}=y(({company:e})=>e.companyHierarchyInfo);return u.useCallback(async()=>{e&&await C()},[e])})();return async(n=!0)=>{try{const{result:n}=(await Q()).data.logout;if("success"!==n)return;await Promise.all([t(),e()])}catch(o){K.error(o)}finally{window.sessionStorage.clear(),H(),n&&I("on-logout")}}},pe={"Your business account is pending approval. You will gain access to business account features, products, and pricing after account approval.":"global.statusNotifications.willGainAccessToBusinessFeatProductsAndPricingAfterApproval","Your business account is pending approval. Products, pricing, and ordering will be enabled after account approval.":"global.statusNotifications.productsPricingAndOrderingWillBeEnabledAfterApproval","Your business account is pending approval. You will gain access to business account features after account approval.":"global.statusNotifications.willGainAccessToBusinessFeatAfterApproval"};function me(e){const{setOpenPage:a}=e,s=k(),i=xe(),r=y(h),x=y(({quoteInfo:e})=>e.quoteDetailToCheckoutUrl),[b,j]=u.useState(!0),[w]=F(),[T,C]=u.useState(!0),[B,H]=u.useState(),[A,P]=u.useState({email:"",password:""}),Q=g(),$=v(),[oe,ae]=d(),{state:{isCheckout:re,logo:le,registerEnabled:ce}}=u.useContext(S),{state:{loginPageButton:ue,loginPageDisplay:me,loginPageHtml:fe,portalStyle:{backgroundColor:ye="FEF9F5"}}}=u.useContext(E),{createAccountButtonText:he,primaryButtonColor:be,signInButtonText:je}=ue,{displayStoreLogo:we,pageTitle:Te}=me,{bottomHtmlRegionEnabled:Ce,bottomHtmlRegionHtml:ve,createAccountPanelHtml:Be,topHtmlRegionEnabled:Fe,topHtmlRegionHtml:He}=fe,Ie={loginTitle:Te||$("login.button.signIn"),loginBtn:je||$("login.button.signInUppercase"),createAccountButtonText:he||$("login.button.createAccount"),btnColor:be||"",widgetHeadText:Fe?He:void 0,widgetBodyText:Be||D,widgetFooterText:Ce?ve:void 0,logo:we?le:void 0};u.useEffect(()=>{(async()=>{try{const e=oe.get("loginFlag"),t="false"!==oe.get("showTip");if(C(t),ee(e)&&H(e),"invoiceErrorTip"===e){const{tip:t}=te[e];L.error($(t))}"loggedOutLogin"===e&&r&&await i(),j(!1)}finally{j(!1)}})()},[$,r,i,oe]);const ke=async e=>{const t=await z(e);H(t?"resetPassword":"accountIncorrect")},Ae=ce?"100%":"50%",Pe=ce?"50%":"auto",Se=B&&((e,t="")=>{const{tip:n,alertType:o}=te[e];return{message:$(n,{email:t}),severity:o}})(B,A?.email);return n.jsx(f,{setOpenPage:a,children:n.jsx(se,{paddings:w?"0":"20px 20px",children:n.jsx(R,{isSpinning:b,tip:$("global.tips.loading"),background:"transparent",children:n.jsx(o,{sx:{display:"flex",flexDirection:"column",width:"100%",minHeight:"400px",minWidth:"343px"},children:Ie&&n.jsxs(n.Fragment,{children:[B&&T&&n.jsx(o,{sx:{padding:w?0:"0 5%",margin:"30px 0 0 0"},children:Se&&n.jsx(l,{severity:Se.severity,variant:"filled",children:Se.message})}),x&&n.jsx(l,{severity:"error",variant:"filled",children:$("login.loginText.quoteDetailToCheckoutUrl")}),n.jsx(o,{sx:{margin:"20px 0",minHeight:"150px"},children:n.jsx(ie,{children:n.jsx(c,{sx:{maxWidth:w?"70%":"250px"},onClick:()=>{window.location.href="/"},children:n.jsx("img",{src:Ie.logo||p(m),alt:$("login.registerLogo"),loading:"lazy"})})})}),Ie.widgetHeadText&&n.jsx(t,{sx:{minHeight:"48px",width:ce||w?"100%":"50%"},html:Ie.widgetHeadText}),n.jsx(o,{sx:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:n.jsx(o,{sx:{bgcolor:"#FFFFFF",borderRadius:"4px",margin:"20px 0",display:"flex",flexDirection:"column",justifyContent:"center",width:w?"auto":Ae},children:n.jsxs(o,{sx:{mb:"20px",display:"flex",flexDirection:w?"column":"row",justifyContent:"center",width:w?"auto":"100%"},children:[n.jsx(o,{sx:{width:w?"auto":Pe,paddingRight:w?0:"2%",ml:"16px",mr:w?"16px":"",pb:ce?"":"36px"},children:n.jsx(ge,{loginBtn:Ie.loginBtn,handleLoginSubmit:async e=>{if(j(!0),P(e),ae(e=>(e.delete("loginFlag"),e)),re)try{const t=await ne(e);400===t.status&&"reset_password_before_login"===t.type?H("resetPassword"):"invalid_login"===t.type?H("accountIncorrect"):window.location.href=_}catch(t){K.error(t),await ke(e.email)}finally{j(!1)}else try{const t={email:e.email,password:e.password,storeHash:q,channelId:O};if(await(async(e,t)=>{const{errors:n}=await Z({email:e,password:t});if(n?.[0]){const{message:t}=n[0];if("Reset password"===t)return ke(e),!0}return!1})(e.email,e.password))return;const{login:{result:{token:n,storefrontLoginToken:o},errors:a}}=await X({loginData:t});if(s(N(n)),U(o),I("on-login",{storefrontToken:o}),a?.[0]||!n){if(a?.[0]){const{message:e}=a[0];if("Operation cannot be performed as the storefront channel is not live"===e)return H("accountPrelaunch"),void j(!1)}ke(e.email)}else{const e=await V(n);if(x)return void Q(x);if(e?.userType===Y.MULTIPLE_B2C&&e?.role===G.SUPER_ADMIN)return void Q("/dashboard");if(!J(Q))return;e?.userType===Y.B2C&&Q(M.ORDERS);const t=W(Number(e?.role));Q(t)}}catch(t){if(t instanceof Error){const e=pe[t.message];e?(L.error($(e)),await i(!1)):L.error($("login.loginTipInfo.accountIncorrect"))}}finally{j(!1)}},backgroundColor:ye})}),ce&&n.jsx(o,{sx:{flex:"1",paddingLeft:w?0:"2%"},children:n.jsx(de,{createAccountButtonText:Ie.createAccountButtonText,widgetBodyText:Ie.widgetBodyText})})]})})}),Ie.widgetFooterText&&n.jsx(t,{sx:{minHeight:"48px",width:ce||w?"100%":"50%"},html:Ie.widgetFooterText})]})})})})})}}}});
//# sourceMappingURL=index-legacy-4TrrIjom.js.map
