var Le=e=>{throw TypeError(e)};var me=(e,t,s)=>t.has(e)||Le("Cannot "+s);var r=(e,t,s)=>(me(e,t,"read from private field"),s?s.call(e):t.get(e)),B=(e,t,s)=>t.has(e)?Le("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),x=(e,t,s,n)=>(me(e,t,"write to private field"),n?n.call(e,s):t.set(e,s),s),S=(e,t,s)=>(me(e,t,"access private method"),s);import{j as l,w as Ne,G as Me,z as Ae,A as ze,D as lt,E as ct,H as dt,J as Ge,K as Ve,L as ht,M as ut,O as ft,ae as pt,B as H,T as ae}from"./mui-DjJKBaL-.js";import{r as O}from"./intl-D34a3Rgg.js";import{aV as mt,aW as ke,aX as M,aY as ge,aZ as oe,a_ as be,a$ as ye,b0 as $e,b1 as gt,b2 as ue,b3 as bt,b4 as yt,b5 as Fe,b6 as Ke,b7 as xt,b8 as Ct,j as Ee,C as St,l as It,a as Je,aa as Ue,ah as je,u as $,y as Xe,ay as Ye,aw as Ze,B as de,aD as Rt,aR as wt,af as Bt}from"./react-setup-Bynf4djQ.js";import"./load-functions-BXOIym8k.js";import"./base-CC7kTJh2.js";import{B as Ot}from"./B2BAutoCompleteCheckbox-BBMrgyG7.js";import{B as Tt}from"./B3Filter-DObKChJb.js";import{O as et,o as Nt}from"./OrderStatus-C_kRwVFr.js";import{D as Et}from"./muiIcon-BBtg8u0V.js";import{a as jt}from"./router-DcuTQ_yx.js";var v,h,le,j,G,Z,F,W,ce,ee,te,V,K,z,se,f,ie,xe,Ce,Se,Ie,Re,we,Be,tt,We,Pt=(We=class extends mt{constructor(t,s){super();B(this,f);B(this,v);B(this,h);B(this,le);B(this,j);B(this,G);B(this,Z);B(this,F);B(this,W);B(this,ce);B(this,ee);B(this,te);B(this,V);B(this,K);B(this,z);B(this,se,new Set);this.options=s,x(this,v,t),x(this,W,null),x(this,F,ke()),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(r(this,h).addObserver(this),_e(r(this,h),this.options)?S(this,f,ie).call(this):this.updateResult(),S(this,f,Ie).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Oe(r(this,h),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Oe(r(this,h),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,S(this,f,Re).call(this),S(this,f,we).call(this),r(this,h).removeObserver(this)}setOptions(t){const s=this.options,n=r(this,h);if(this.options=r(this,v).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof M(this.options.enabled,r(this,h))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");S(this,f,Be).call(this),r(this,h).setOptions(this.options),s._defaulted&&!ge(this.options,s)&&r(this,v).getQueryCache().notify({type:"observerOptionsUpdated",query:r(this,h),observer:this});const i=this.hasListeners();i&&Qe(r(this,h),n,this.options,s)&&S(this,f,ie).call(this),this.updateResult(),i&&(r(this,h)!==n||M(this.options.enabled,r(this,h))!==M(s.enabled,r(this,h))||oe(this.options.staleTime,r(this,h))!==oe(s.staleTime,r(this,h)))&&S(this,f,xe).call(this);const c=S(this,f,Ce).call(this);i&&(r(this,h)!==n||M(this.options.enabled,r(this,h))!==M(s.enabled,r(this,h))||c!==r(this,z))&&S(this,f,Se).call(this,c)}getOptimisticResult(t){const s=r(this,v).getQueryCache().build(r(this,v),t),n=this.createResult(s,t);return Dt(this,n)&&(x(this,j,n),x(this,Z,this.options),x(this,G,r(this,h).state)),n}getCurrentResult(){return r(this,j)}trackResult(t,s){return new Proxy(t,{get:(n,i)=>(this.trackProp(i),s==null||s(i),i==="promise"&&!this.options.experimental_prefetchInRender&&r(this,F).status==="pending"&&r(this,F).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(n,i))})}trackProp(t){r(this,se).add(t)}getCurrentQuery(){return r(this,h)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const s=r(this,v).defaultQueryOptions(t),n=r(this,v).getQueryCache().build(r(this,v),s);return n.fetch().then(()=>this.createResult(n,s))}fetch(t){var s;return S(this,f,ie).call(this,{...t,cancelRefetch:(s=t.cancelRefetch)!=null?s:!0}).then(()=>(this.updateResult(),r(this,j)))}createResult(t,s){var he;const n=r(this,h),i=this.options,c=r(this,j),o=r(this,G),T=r(this,Z),b=t!==n?t.state:r(this,le),{state:y}=t;let m={...y},C=!1,d;if(s._optimisticResults){const P=this.hasListeners(),J=!P&&_e(t,s),Q=P&&Qe(t,n,s,i);(J||Q)&&(m={...m,...yt(y.data,t.options)}),s._optimisticResults==="isRestoring"&&(m.fetchStatus="idle")}let{error:E,errorUpdatedAt:A,status:I}=m;d=m.data;let N=!1;if(s.placeholderData!==void 0&&d===void 0&&I==="pending"){let P;c!=null&&c.isPlaceholderData&&s.placeholderData===(T==null?void 0:T.placeholderData)?(P=c.data,N=!0):P=typeof s.placeholderData=="function"?s.placeholderData((he=r(this,te))==null?void 0:he.state.data,r(this,te)):s.placeholderData,P!==void 0&&(I="success",d=Fe(c==null?void 0:c.data,P,s),C=!0)}if(s.select&&d!==void 0&&!N)if(c&&d===(o==null?void 0:o.data)&&s.select===r(this,ce))d=r(this,ee);else try{x(this,ce,s.select),d=s.select(d),d=Fe(c==null?void 0:c.data,d,s),x(this,ee,d),x(this,W,null)}catch(P){x(this,W,P)}r(this,W)&&(E=r(this,W),d=r(this,ee),A=Date.now(),I="error");const U=m.fetchStatus==="fetching",L=I==="pending",_=I==="error",u=L&&U,R=d!==void 0,D={status:I,fetchStatus:m.fetchStatus,isPending:L,isSuccess:I==="success",isError:_,isInitialLoading:u,isLoading:u,data:d,dataUpdatedAt:m.dataUpdatedAt,error:E,errorUpdatedAt:A,failureCount:m.fetchFailureCount,failureReason:m.fetchFailureReason,errorUpdateCount:m.errorUpdateCount,isFetched:m.dataUpdateCount>0||m.errorUpdateCount>0,isFetchedAfterMount:m.dataUpdateCount>b.dataUpdateCount||m.errorUpdateCount>b.errorUpdateCount,isFetching:U,isRefetching:U&&!L,isLoadingError:_&&!R,isPaused:m.fetchStatus==="paused",isPlaceholderData:C,isRefetchError:_&&R,isStale:Pe(t,s),refetch:this.refetch,promise:r(this,F),isEnabled:M(s.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const P=X=>{D.status==="error"?X.reject(D.error):D.data!==void 0&&X.resolve(D.data)},J=()=>{const X=x(this,F,D.promise=ke());P(X)},Q=r(this,F);switch(Q.status){case"pending":t.queryHash===n.queryHash&&P(Q);break;case"fulfilled":(D.status==="error"||D.data!==Q.value)&&J();break;case"rejected":(D.status!=="error"||D.error!==Q.reason)&&J();break}}return D}updateResult(){const t=r(this,j),s=this.createResult(r(this,h),this.options);if(x(this,G,r(this,h).state),x(this,Z,this.options),r(this,G).data!==void 0&&x(this,te,r(this,h)),ge(s,t))return;x(this,j,s);const n=()=>{if(!t)return!0;const{notifyOnChangeProps:i}=this.options,c=typeof i=="function"?i():i;if(c==="all"||!c&&!r(this,se).size)return!0;const o=new Set(c!=null?c:r(this,se));return this.options.throwOnError&&o.add("error"),Object.keys(r(this,j)).some(T=>{const p=T;return r(this,j)[p]!==t[p]&&o.has(p)})};S(this,f,tt).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&S(this,f,Ie).call(this)}},v=new WeakMap,h=new WeakMap,le=new WeakMap,j=new WeakMap,G=new WeakMap,Z=new WeakMap,F=new WeakMap,W=new WeakMap,ce=new WeakMap,ee=new WeakMap,te=new WeakMap,V=new WeakMap,K=new WeakMap,z=new WeakMap,se=new WeakMap,f=new WeakSet,ie=function(t){S(this,f,Be).call(this);let s=r(this,h).fetch(this.options,t);return t!=null&&t.throwOnError||(s=s.catch(be)),s},xe=function(){S(this,f,Re).call(this);const t=oe(this.options.staleTime,r(this,h));if(ye||r(this,j).isStale||!$e(t))return;const n=gt(r(this,j).dataUpdatedAt,t)+1;x(this,V,ue.setTimeout(()=>{r(this,j).isStale||this.updateResult()},n))},Ce=function(){var t;return(t=typeof this.options.refetchInterval=="function"?this.options.refetchInterval(r(this,h)):this.options.refetchInterval)!=null?t:!1},Se=function(t){S(this,f,we).call(this),x(this,z,t),!(ye||M(this.options.enabled,r(this,h))===!1||!$e(r(this,z))||r(this,z)===0)&&x(this,K,ue.setInterval(()=>{(this.options.refetchIntervalInBackground||bt.isFocused())&&S(this,f,ie).call(this)},r(this,z)))},Ie=function(){S(this,f,xe).call(this),S(this,f,Se).call(this,S(this,f,Ce).call(this))},Re=function(){r(this,V)&&(ue.clearTimeout(r(this,V)),x(this,V,void 0))},we=function(){r(this,K)&&(ue.clearInterval(r(this,K)),x(this,K,void 0))},Be=function(){const t=r(this,v).getQueryCache().build(r(this,v),this.options);if(t===r(this,h))return;const s=r(this,h);x(this,h,t),x(this,le,t.state),this.hasListeners()&&(s==null||s.removeObserver(this),t.addObserver(this))},tt=function(t){Ke.batch(()=>{t.listeners&&this.listeners.forEach(s=>{s(r(this,j))}),r(this,v).getQueryCache().notify({query:r(this,h),type:"observerResultsUpdated"})})},We);function vt(e,t){return M(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function _e(e,t){return vt(e,t)||e.state.data!==void 0&&Oe(e,t,t.refetchOnMount)}function Oe(e,t,s){if(M(t.enabled,e)!==!1&&oe(t.staleTime,e)!=="static"){const n=typeof s=="function"?s(e):s;return n==="always"||n!==!1&&Pe(e,t)}return!1}function Qe(e,t,s,n){return(e!==t||M(n.enabled,e)===!1)&&(!s.suspense||e.state.status!=="error")&&Pe(e,s)}function Pe(e,t){return M(t.enabled,e)!==!1&&e.isStaleByTime(oe(t.staleTime,e))}function Dt(e,t){return!ge(e.getCurrentResult(),t)}var st=O.createContext(!1),Lt=()=>O.useContext(st);st.Provider;function Mt(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var At=O.createContext(Mt()),kt=()=>O.useContext(At),$t=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},Ft=e=>{O.useEffect(()=>{e.clearReset()},[e])},Ut=({result:e,errorResetBoundary:t,throwOnError:s,query:n,suspense:i})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&(i&&e.data===void 0||xt(s,[e.error,n])),_t=e=>{if(e.suspense){const s=i=>i==="static"?i:Math.max(i!=null?i:1e3,1e3),n=e.staleTime;e.staleTime=typeof n=="function"?(...i)=>s(n(...i)):s(n),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},Qt=(e,t)=>e.isLoading&&e.isFetching&&!t,qt=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,qe=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});function Ht(e,t,s){var m,C,d,E,A;const n=Lt(),i=kt(),c=Ct(),o=c.defaultQueryOptions(e);(C=(m=c.getDefaultOptions().queries)==null?void 0:m._experimental_beforeQuery)==null||C.call(m,o),o._optimisticResults=n?"isRestoring":"optimistic",_t(o),$t(o,i),Ft(i);const T=!c.getQueryCache().get(o.queryHash),[p]=O.useState(()=>new t(c,o)),b=p.getOptimisticResult(o),y=!n&&e.subscribed!==!1;if(O.useSyncExternalStore(O.useCallback(I=>{const N=y?p.subscribe(Ke.batchCalls(I)):be;return p.updateResult(),N},[p,y]),()=>p.getCurrentResult(),()=>p.getCurrentResult()),O.useEffect(()=>{p.setOptions(o)},[o,p]),qt(o,b))throw qe(o,p,i);if(Ut({result:b,errorResetBoundary:i,throwOnError:o.throwOnError,query:c.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw b.error;if((E=(d=c.getDefaultOptions().queries)==null?void 0:d._experimental_afterQuery)==null||E.call(d,o,b),o.experimental_prefetchInRender&&!ye&&Qt(b,n)){const I=T?qe(o,p,i):(A=c.getQueryCache().get(o.queryHash))==null?void 0:A.promise;I==null||I.catch(be).finally(()=>{p.updateResult()})}return o.notifyOnChangeProps?b:p.trackResult(b)}function Wt(e,t){return Ht(e,Pt)}const zt=Ne("div")(()=>({height:"100%",minHeight:"400px",backgroundColor:"#fff",display:"flex",justifyContent:"center",alignItems:"center",color:"#aaa",fontSize:"18px"})),Gt=Ne("span")(()=>({marginLeft:"10px"}));function Vt(){const e=Ee();return l.jsxs(zt,{children:[l.jsx(Et,{fontSize:"large"}),l.jsx(Gt,{children:e("global.table.noData")})]})}const Kt=e=>"node"in e;function Jt({columnItems:e,node:t,onClickRow:s}){return l.jsx(Ge,{hover:!0,onClick:s,sx:{cursor:"pointer"},"data-testid":"tableBody-Row",children:e.map(n=>{var i;return l.jsx(Ve,{align:(i=n.align)!=null?i:"left","data-testid":n.key?"tableBody-".concat(n.key):"",children:n.render(t)},n.title)})})}function Xt({columnItems:e,listItems:t=[],pagination:s={offset:0,count:0,first:10},onPaginationChange:n=()=>{},renderItem:i,isInfiniteScroll:c=!1,onClickRow:o,sortDirection:T="asc",sortByFn:p,orderBy:b=""}){const y=[10,20,30],{state:{portalStyle:{backgroundColor:m="#FEF9F5"}}}=O.useContext(St),C=It(m),[d]=Je(),E=Ee(),{offset:A,count:I,first:N}=s,U=u=>{n(u)},L=(u,R)=>{U({...s,offset:R*N})},_=u=>{U({...s,offset:0,first:parseInt(u.target.value,10)||N})};return t.length>0?l.jsxs(l.Fragment,{children:[c&&l.jsxs(l.Fragment,{children:[l.jsx(Me,{container:!0,spacing:2,children:t.map((u,R)=>l.jsx(Me,{item:!0,xs:12,children:i(u,R)},u.orderId))}),l.jsx(Ae,{labelDisplayedRows:({from:u,to:R,count:k})=>E("global.pagination.pageXOfY",{from:u,to:R,count:k}),rowsPerPageOptions:y,labelRowsPerPage:E("global.pagination.perPage"),component:"div",sx:{color:d?Ue(C,.87):"rgba(0, 0, 0, 0.87)",marginTop:"1.5rem","::-webkit-scrollbar":{display:"none"},"& svg":{color:d?Ue(C,.87):"rgba(0, 0, 0, 0.87)"}},count:I,rowsPerPage:N,page:N===0?0:A/N,onPageChange:L,onRowsPerPageChange:_})]}),!c&&l.jsxs(ze,{sx:{height:"100%",boxShadow:"0px 2px 1px -1px rgb(0 0 0 / 20%), 0px 1px 1px 0px rgb(0 0 0 / 14%), 0px 1px 3px 0px rgb(0 0 0 / 12%)"},children:[l.jsx(lt,{children:l.jsxs(ct,{sx:{tableLayout:"initial"},children:[l.jsx(dt,{children:l.jsx(Ge,{"data-testid":"tableHead-Row",children:e.map(u=>{var R;return l.jsx(Ve,{width:u.width,align:(R=u.align)!=null?R:"left",sortDirection:u.key===b?T:!1,"data-testid":u.key?"tableHead-".concat(u.key):"",children:u.isSortable?l.jsx(ht,{active:u.key===b,direction:u.key===b?T:"desc",hideSortIcon:u.key!==b,onClick:()=>p==null?void 0:p(u.key),children:u.title}):u.title},u.title)})})}),l.jsx(ut,{children:t.map((u,R)=>{const k=Kt(u)?u.node:u;return l.jsx(Jt,{columnItems:e,node:k,onClickRow:()=>o(k,R)},"row-".concat(k.orderId))})})]})}),l.jsx(Ae,{labelDisplayedRows:({from:u,to:R,count:k})=>E("global.pagination.pageXOfY",{from:u,to:R,count:k}),rowsPerPageOptions:y,labelRowsPerPage:E("global.pagination.rowsPerPage"),component:"div",sx:{marginTop:"1.5rem","::-webkit-scrollbar":{display:"none"}},count:I,rowsPerPage:N,page:N===0?0:A/N,onPageChange:L,onRowsPerPageChange:_})]})]}):l.jsx(Vt,{})}const Te={orderId:"bcOrderId",poNumber:"poNumber",totalIncTax:"totalIncTax",status:"status",placedBy:"placedBy",createdAt:"createdAt"};function Yt(e){if(!Object.keys(Te).includes(e))throw new Error("Invalid sort key: ".concat(e))}const Zt=(e,t,s,n,i,c=[])=>{var m;const o=c.filter(C=>C.statusCode!=="0"&&C.statusCode!=="1"),T=((m=i==null?void 0:i.createdByUser)==null?void 0:m.results.map(C=>({createdBy:"".concat(C.firstName," ").concat(C.lastName," (").concat(C.email,")")})))||[],p=[{name:"company",label:"Company",required:!1,default:"",fieldType:"text",xs:12,variant:"filled",size:"small",idLang:"orders.company"},{name:"orderStatus",label:"Order status",required:!1,default:"",fieldType:"dropdown",options:o,replaceOptions:{label:"customLabel",value:"customLabel"},xs:12,variant:"filled",size:"small",idLang:"orders.orderStatus"},{name:"PlacedBy",label:"Placed by",required:!1,default:"",fieldType:"dropdown",options:T,replaceOptions:{label:"createdBy",value:"createdBy"},xs:12,variant:"filled",size:"small",idLang:"orders.placedBy"}],b=e&&!(Number(t)===3&&!n);return p.filter(C=>!((!e||b)&&!s&&(C.name==="company"||C.name==="PlacedBy")||Number(t)===3&&!n&&C.name==="PlacedBy"||(e||Number(t)===je.SUPER_ADMIN&&n)&&s&&C.name==="company"))},es=()=>({beginDateAt:null,endDateAt:null,createdBy:"",q:""}),ts=(e,t)=>({companyId:"",beginDateAt:null,endDateAt:null,companyName:"",createdBy:"",orderNumber:"",poNumber:"",companyIds:[t],isShowMy:e?0:1,q:""}),ss=(e,t)=>{var s;return((s=t.find(n=>n.systemLabel===e))==null?void 0:s.customLabel)||""},rs=Ne("div")(()=>({display:"flex",alignItems:"center","&.between-flex":{justifyContent:"space-between"}}));function ns({item:e,goToDetail:t}){const s=ft(),n=$(Xe),i=$(({company:o})=>o.customer),c=o=>n?"by ".concat(o.firstName," ").concat(o.lastName):"by ".concat(i.firstName," ").concat(i.lastName);return l.jsx(ze,{children:l.jsxs(pt,{sx:{color:"rgba(0, 0, 0, 0.6)"},onClick:t,children:[l.jsxs(rs,{className:"between-flex",children:[l.jsxs(H,{sx:{display:"flex",alignItems:"center"},children:[l.jsx(ae,{variant:"h5",sx:{color:"rgba(0, 0, 0, 0.87)"},children:"# ".concat(e.orderId)}),l.jsx(ae,{sx:{ml:1},variant:"body2",children:e.poNumber?e.poNumber:"–"})]}),l.jsx(H,{children:l.jsx(et,{code:e.status})})]}),l.jsx(ae,{variant:"h6",sx:{marginBottom:s.spacing(2.5),mt:s.spacing(1.5),minHeight:"1.43em"},children:Ye(e.totalIncTax)}),l.jsxs(H,{sx:{display:"flex",justifyContent:"space-between"},children:[l.jsx(ae,{variant:"body2",sx:{fontWeight:"normal",marginRight:s.spacing(2)},children:c(e)}),l.jsx(ae,{children:"".concat(Ze(e.createdAt))})]})]})},e.orderId)}const rt=(e,t)=>"\nquery ".concat(t==="allOrders"?"GetAllOrders":"GetCustomerOrders"," {\n  ").concat(t,'(\n    search: "').concat(e.q||"",'"\n    status: "').concat((e==null?void 0:e.statusCode)||"",'"\n    first: ').concat(e.first,"\n    offset: ").concat(e.offset,"\n    beginDateAt: ").concat(e!=null&&e.beginDateAt?JSON.stringify(e.beginDateAt):null,"\n    endDateAt: ").concat(e!=null&&e.endDateAt?JSON.stringify(e.endDateAt):null,'\n    companyName: "').concat((e==null?void 0:e.companyName)||"",'"\n    createdBy: "').concat((e==null?void 0:e.createdBy)||"",'"\n    isShowMy: "').concat((e==null?void 0:e.isShowMy)||0,'"\n    orderBy: "').concat(e.orderBy,'"\n    email: "').concat((e==null?void 0:e.email)||"",'"\n    ').concat(e!=null&&e.companyIds?"companyIds: ".concat(Rt(e.companyIds||[])):"","\n  ){\n    totalCount,\n    edges{\n      node {\n        orderId,\n        createdAt,\n        totalIncTax,\n        money,\n        poNumber,\n        status,\n        firstName,\n        lastName,\n        companyInfo {\n          companyName,\n        }\n      }\n    }\n  }\n}"),nt=e=>"\nquery ".concat(e==="orderStatuses"?"GetOrderStatuses":"GetCustomerOrderStatuses"," {\n  ").concat(e," {\n    systemLabel,\n    customLabel,\n    statusCode,\n  }\n}"),as=e=>"\n  query GetOrdersCreatedByUser {\n    createdByUser (\n      companyId: ".concat(e,",\n      module: 0,\n    ){\n      results,\n    }\n  }\n"),is=e=>de.graphqlB2B({query:rt(e,"allOrders")}).then(t=>t.allOrders),os=e=>de.graphqlB2B({query:rt(e,"customerOrders")}).then(t=>t.customerOrders),ls=()=>de.graphqlB2B({query:nt("orderStatuses")}).then(e=>e.orderStatuses),cs=()=>de.graphqlB2B({query:nt("bcOrderStatuses")}).then(e=>e.bcOrderStatuses),ds=e=>de.graphqlB2B({query:as(e)});function hs(){const e=$(Xe),t=$(({company:y})=>y.companyInfo.id),s=$(({company:y})=>y.customer.role),n=$(({b2bFeatures:y})=>y.masqueradeCompany.id),i=$(({b2bFeatures:y})=>y.masqueradeCompany.isAgenting),{order:c}=$(({company:y})=>y.pagesSubsidiariesPermission),{selectCompanyHierarchyId:o,isEnabledCompanyHierarchy:T}=$(({company:y})=>y.companyHierarchyInfo),p=s===je.SUPER_ADMIN&&i?Number(n):Number(t),b=t||n;return{role:s,isAgenting:i,isB2BUser:e,isEnabledCompanyHierarchy:T&&c,selectedCompanyId:Number(o)||p,companyId:b}}const us=(e="")=>{const s=/\((.+)\)/g.exec(e);return s!=null&&s.length?s[1]:""},fs=(e="")=>{const s=/^[^(]+/.exec(e);return s!=null&&s.length?s[0].trim():""},He=({key:e,dir:t})=>t==="desc"?"-".concat(Te[e]):Te[e];function Bs({isCompanyOrder:e=!1}){const t=Ee(),[s]=Je(),{role:n,isAgenting:i,companyId:c,isB2BUser:o,isEnabledCompanyHierarchy:T,selectedCompanyId:p}=hs(),[b,y]=O.useState({offset:0,first:10}),[m,C]=O.useState(0),[d,E]=O.useState(),[A,I]=O.useState([]),[N,U]=O.useState([]),[L,_]=O.useState({key:"orderId",dir:"desc"}),u=a=>{_(g=>(Yt(a),g.key===a?{key:a,dir:g.dir==="asc"?"desc":"asc"}:{key:a,dir:"desc"}))};O.useEffect(()=>{const a=o?ts(e,p):es();if(E(a),n===je.GUEST)return;(async()=>{const w=o&&e?await ds(Number(c)):{},q=o?await ls():await cs(),re=Zt(o,n,e,i,w,q);U(q);const ot=re.map(ne=>{const ve=ne;return ve.label=t(ne.idLang),ne.name==="orderStatus"&&(ve.options=ne.options.map(fe=>{const De=Nt[fe.systemLabel],pe=fe;return pe.customLabel=t(De)===pe.systemLabel?pe.customLabel:t(De),fe})),ne});I(ot)})()},[t,c,i,o,e,n,p]);const R=async({createdBy:a,...g})=>{const{edges:w=[],totalCount:q}=o?await is({...g,email:us(a),createdBy:fs(a)}):await os(g);return C(q),{edges:w.map(re=>"node"in re?re.node:re),totalCount:q}},k=jt(),D=(a,g)=>{k("/orderDetail/".concat(a.orderId),{state:{currentIndex:g,searchParams:{...d,orderBy:He(L)},totalCount:m,isCompanyOrder:e,beginDateAt:d==null?void 0:d.beginDateAt,endDateAt:d==null?void 0:d.endDateAt}})},he=[{key:"orderId",title:t("orders.order"),width:"10%",isSortable:!0,render:({orderId:a})=>a},{key:"companyName",title:t("orders.company"),width:"10%",isSortable:!1,render:({companyInfo:a})=>l.jsx(H,{children:(a==null?void 0:a.companyName)||"–"})},{key:"poNumber",title:t("orders.poReference"),render:({poNumber:a})=>l.jsx(H,{children:a||"–"}),width:"10%",isSortable:!0},{key:"totalIncTax",title:t("orders.grandTotal"),render:({money:a,totalIncTax:g})=>a?wt(JSON.parse(JSON.parse(a)),g):Ye(g),align:"right",width:"8%",isSortable:!0},{key:"status",title:t("orders.orderStatus"),render:({status:a})=>l.jsx(et,{text:ss(a,N),code:a}),width:"10%",isSortable:!0},{key:"placedBy",title:t("orders.placedBy"),render:({firstName:a,lastName:g})=>"".concat(a," ").concat(g),width:"10%",isSortable:!0},{key:"createdAt",title:t("orders.createdOn"),render:({createdAt:a})=>"".concat(Ze(Number(a))),width:"10%",isSortable:!0}],P=()=>he.filter(g=>{const{key:w}=g;return!(!o&&w==="companyName"||(!o||Number(n)===3&&!i)&&w==="placedBy"||w==="placedBy"&&!(Number(n)===3&&!i)&&!e)}),J=(a,g)=>{a==="search"&&E(w=>({...w,q:g}))},Q=a=>{let g=(a==null?void 0:a.orderStatus)||"";if(g){const w=N.find(q=>q.customLabel===g||q.systemLabel===g);g=(w==null?void 0:w.systemLabel)||g}E(w=>({...w,beginDateAt:(a==null?void 0:a.startValue)||null,endDateAt:(a==null?void 0:a.endValue)||null,createdBy:(a==null?void 0:a.PlacedBy)||"",statusCode:g,companyName:(a==null?void 0:a.company)||""}))},X=P(),at=a=>{const g=a.includes(-1)?[]:a;E(w=>({...w,companyIds:g}))},{data:Y,isFetching:it}=Wt({queryKey:["orderList",d,b,L],enabled:!!d,queryFn:()=>R({...d,...b,orderBy:He(L)})});return l.jsx(Bt,{isSpinning:it,children:l.jsxs(H,{sx:{display:"flex",flexDirection:"column",flex:1,width:"100%"},children:[l.jsxs(H,{sx:{width:s?"100%":"auto",display:"flex",justifyContent:"flex-start",alignItems:s?"flex-start":"center",flexDirection:s?"column":"row","& > div":{width:s?"100%":"auto"}},children:[T&&l.jsx(H,{sx:{mr:s?0:"10px",mb:"30px"},children:l.jsx(Ot,{handleChangeCompanyIds:at})}),l.jsx(Tt,{startPicker:{isEnabled:!0,label:t("orders.from"),defaultValue:(d==null?void 0:d.beginDateAt)||null,pickerKey:"start"},endPicker:{isEnabled:!0,label:t("orders.to"),defaultValue:(d==null?void 0:d.endDateAt)||null,pickerKey:"end"},filterMoreInfo:A,handleChange:J,handleFilterChange:Q,pcTotalWidth:"100%",pcContainerWidth:"100%",pcSearchContainerWidth:"100%"})]}),l.jsx(Xt,{columnItems:X,listItems:(Y==null?void 0:Y.edges)||[],pagination:{...b,count:(Y==null?void 0:Y.totalCount)||0},onPaginationChange:y,isInfiniteScroll:s,renderItem:(a,g)=>l.jsx(ns,{goToDetail:()=>D(a,g),item:a},a.orderId),onClickRow:D,sortDirection:L.dir,sortByFn:u,orderBy:L.key})]})})}export{Bs as O};
//# sourceMappingURL=Order-ZMaIPCd_.js.map
