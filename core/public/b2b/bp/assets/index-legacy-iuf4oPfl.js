System.register(["./mui-legacy-Co1sKVsS.js","./intl-legacy-f5dGU49Z.js","./form-legacy-LlvE08FY.js","./lodashEs-legacy-BTGS6uHg.js","./B3Card-legacy-DRA-Op8r.js","./B3CustomForm-legacy-iy2Vgra_.js","./react-setup-legacy-CKF-9cua.js","./load-functions-legacy-B3DSplhu.js","./base-legacy-DAqmyLJs.js","./b3Login-legacy-Dv9m0gQv.js","./config-legacy-BtHQq4oE.js","./RegisteredFinish-legacy-BCkU7qyS.js","./router-legacy-CQEMCAt4.js","./reactVendor-legacy-C5drotBr.js","./eCache-legacy-QcRlogRO.js","./muiIcon-legacy-C-h6sDde.js","./redux-legacy-DH94TLLa.js","./toolkit-legacy-DO7GmFjE.js","../index-legacy.JvindH6T.js","./global-legacy-vVqwfyov.js","./dropzone-legacy-B1uEXZk9.js","./dateFns-legacy-DHywh9DD.js","./validatorRules-legacy-CnaQOFg7.js"],function(e,t){"use strict";var a,s,n,r,l,o,i,c,d,u,m,f,p,g,h,b,y,x,j,F,w,C,T,I,E,S,B,L,N,V,A,M,k,v,R,q,z,O,P,D,_,U;return{setters:[e=>{a=e.j,s=e.B,n=e.a7,r=e.w,l=e.a1},e=>{o=e.r},e=>{i=e.u},e=>{c=e.e},e=>{d=e.B},e=>{u=e.B},e=>{m=e.j,f=e.a,p=e.G,g=e.u,h=e.bW,b=e.C,y=e.l,x=e.af,j=e.ag,F=e.aj,w=e.an,C=e.M,T=e.bT,I=e.I,E=e.bY,S=e.aI},null,e=>{B=e.b},e=>{L=e.l},e=>{N=e.c,V=e.g,A=e.d,M=e.h,k=e.a,v=e.B,R=e.t},e=>{q=e.a,z=e.b,O=e.R,P=e.c,D=e.T,_=e.I},e=>{U=e.a},null,null,null,null,null,null,null,null,null,null],execute:function(){e("default",function(e){const[r,W]=o.useState(""),[G,H]=o.useState(!1),{setOpenPage:Y}=e,Z=m(),[$]=f(),{control:J,handleSubmit:K,getValues:Q,formState:{errors:X},setValue:ee,setError:te,watch:ae}=i({mode:"onSubmit"}),{state:{logo:se,blockPendingAccountOrderCreation:ne,registerEnabled:re}}=o.useContext(p),le=U(),oe=g(({company:e})=>e.customer),{id:ie,firstName:ce,lastName:de,emailAddress:ue,phoneNumber:me}=oe,{state:fe,dispatch:pe}=o.useContext(h),{state:{companyAutoApproval:ge,portalStyle:{backgroundColor:he="#FEF9F5"}}}=o.useContext(b),be=y(he),ye=(e=!1)=>{pe({type:"loading",payload:{isLoading:e}})};o.useEffect(()=>{ye(!1),re||le("/login")},[re]),o.useEffect(()=>{(async()=>{try{pe&&(ye(!0),pe({type:"finishInfo",payload:{submitSuccess:!1}}));const e=await F(3),t=(e?.accountFormFields||[]).map(e=>{const t=e;return N.includes(e?.fieldId||"")&&4===e.groupId&&(t.isRequired=!0,t.visible=!0),e}),a=V(t||[]),{countries:s}=await w(),n=a.address.map(e=>{const t=e;return"country"===e.name&&(t.options=s,t.replaceOptions={label:"countryName",value:"countryName"}),e}),r={phone:me,first_name:ce,last_name:de,email:ue},l=a.contactInformation.map(e=>{const t=e;return t.disabled=!0,t.default=r[A(e.name)]||e.default,e.required&&!e?.default&&(t.disabled=!1),e});pe&&pe({type:"all",payload:{isLoading:!1,bcTob2bContactInformation:[...l],bcTob2bCompanyExtraFields:[],bcTob2bCompanyInformation:[...a.businessDetails],bcTob2bAddressBasicFields:[...n],countryList:[...s]}})}catch(e){B.error(e)}})()},[]);const{bcTob2bContactInformation:xe,isLoading:je,bcTob2bCompanyInformation:Fe=[],bcTob2bAddressBasicFields:we=[],countryList:Ce=[],bcTob2bCompanyExtraFields:Te=[]}=fe;o.useEffect(()=>{const e=(e,t="")=>{const a=Ce.find(t=>t.countryCode===e||t.countryName===e)?.states||[],s=we.find(e=>"state"===e.name);s&&(a.length>0?(s.fieldType="dropdown",s.options=a,s.required=!0):(s.fieldType="text",s.options=[],s.required=!1)),ee("state",t&&e&&(a.find(e=>e.stateCode===t)||0===a.length)?t:""),pe({type:"stateList",payload:{stateList:a,bcTob2bAddressBasicFields:[...we]}})};(()=>{const t=Q("country"),a=Q("state");e(t,a)})();const t=ae((t,{name:a,type:s})=>{const{country:n,state:r}=t;"country"===a&&"change"===s&&e(n,r)});return()=>t.unsubscribe()},[Ce]);const Ie=async e=>{try{const t=await k({extraFields:e});if(200!==t.code){const e=t.data?.errMsg||t.message||"",a=e.split(":");if(a.length>=2){const e=xe?.find(e=>e.custom&&v.decode(e.name)===a[0]);if(e)return te(e.name,{type:"manual",message:a[1]}),(e=>{if(xe){const t=xe.map(t=>t.name===e?{...t,disabled:!1}:t);pe&&pe({type:"all",payload:{bcTob2bContactInformation:[...t]}})}})(e.name),ye(!1),!1}return W(e),ye(!1),!1}return W(""),!0}catch(t){return!1}};return a.jsx(d,{setOpenPage:Y,children:a.jsx(q,{isMobile:$,children:a.jsx(x,{isSpinning:je,tip:Z("global.tips.loading"),transparency:"0",children:a.jsxs(s,{sx:{display:"flex",flexDirection:"column",width:"100%",alignItems:"center","& h4":{color:be},"& input, & .MuiFormControl-root .MuiTextField-root, & .MuiDropzoneArea-textContainer, & .MuiSelect-select.MuiSelect-filled, & .MuiTextField-root .MuiInputBase-multiline":{borderRadius:"4px",borderBottomLeftRadius:"0",borderBottomRightRadius:"0"}},children:[se&&a.jsx(z,{children:a.jsx(n,{sx:{maxWidth:"250px"},onClick:()=>{window.location.href="/"},children:a.jsx("img",{src:se,alt:Z("global.tips.registerLogo"),loading:"lazy"})})}),G?a.jsx(O,{handleFinish:()=>{L(le,!0)&&(ge.enabled?le("/orders"):window.location.href="/")},isBCToB2B:!0}):a.jsxs(t,{sx:{width:$?"100%":"537px",boxShadow:"0px 2px 1px -1px rgba(0, 0, 0, 0.2), 0px 1px 1px rgba(0, 0, 0, 0.14), 0px 1px 3px rgba(0, 0, 0, 0.12)",borderRadius:"4px",marginTop:"1rem",background:"#FFFFFF",padding:"0 0.8rem 1rem 0.8rem"},children:[a.jsx(P,{children:Z("registeredbctob2b.title")}),r&&a.jsx(l,{severity:"error",children:a.jsx(D,{children:r})}),a.jsxs(s,{sx:{width:"100%"},children:[a.jsx(_,{children:xe?.length?xe[0]?.groupName:""}),a.jsx(u,{formFields:xe||[],errors:X,control:J,getValues:Q,setValue:ee})]}),a.jsxs(s,{sx:{width:"100%"},children:[a.jsx(_,{children:Fe?.length?Fe[0]?.groupName:""}),a.jsx(u,{formFields:[...Fe,...Te],errors:X,control:J,getValues:Q,setValue:ee,setError:te})]}),a.jsxs(s,{sx:{width:"100%"},children:[a.jsx(_,{children:we?.length?we[0]?.groupName:""}),a.jsx(u,{formFields:we,errors:X,control:J,getValues:Q,setValue:ee})]}),!G&&a.jsx(s,{sx:{display:"flex",flexDirection:"row-reverse",pt:2,width:"100%"},children:a.jsx(j,{variant:"contained",onClick:e=>{const t=(()=>{const e=Q(),t=Fe.find(e=>"field_attachments"===e.fieldId);return!(c(t)||!t.required||0!==e[t.name].length||(te(t.name,{type:"required",message:Z("global.validate.required",{label:t.label??""})}),ye(!1),0))})();K(async e=>{if(!t){ye(!0);try{const t=await(async e=>{try{const t=Fe.filter(e=>!!e.custom),a=t.map(t=>({fieldName:A(t.name),fieldValue:e[t.name]||t.default})),s=await M({extraFields:a});if(200!==s.code){const e=s.data?.errMsg||s.message||"",a=e.split(":");if(a.length>=2){const e=t.find(e=>A(e.name)===a[0]);if(e)return te(e.name,{type:"manual",message:a[1]}),ye(!1),!1}throw e}return W(""),!0}catch(t){throw B.error(t),t}})(e);if(!t)return;const a=(xe||[]).filter(e=>!!e.custom),s=[];a.length&&a.forEach(t=>{const a={};a.fieldName=A(t.name),a.fieldValue=e[t.name]||t?.default||"",s.push(a)});let n=!0;if(s.length>0&&(n=await Ie(s)),!n)return;const r=Fe.filter(e=>"files"===e.fieldType),l=await(async(e,t)=>{let a=[];if(e.length){e.forEach(e=>{a=t[e.name]||[]});try{return(await Promise.all(a.map(e=>T({file:e,type:"companyAttachedFile"})))).reduce((e,t)=>{let a=e;if(200!==t.code)throw t.data.errMsg||t.message||Z("intl.global.fileUpload.fileUploadFailure");{const s={...t.data};s.fileSize=s.fileSize?`${s.fileSize}`:"",a=[...e,s]}return a},[])}catch(s){throw B.error(s),s}}})(r||[],e);await(async(e,t,a,s)=>{const n={};n.customerId=t||"",n.storeHash=S,n.userExtraFields=s;const r=Fe.filter(e=>!e.custom&&"files"!==e.fieldType),l=Fe.filter(e=>!!e.custom);if(r.length&&r.forEach(t=>{n[R(A(t.name))]=e[t.name]||""}),l.length){const t=[];l.forEach(a=>{const s={};s.fieldName=A(a.name),s.fieldValue=e[a.name]||"",t.push(s)}),n.extraFields=t}const o=we.filter(e=>!e.custom),i=we.filter(e=>!!e.custom);if(o.length&&o.forEach(t=>{const a=A(t.name);"address1"===a&&(n.addressLine1=e[t.name]||""),"address2"===a&&(n.addressLine2=e[t.name]||""),n[a]=e[t.name]||""}),i.length){const t=[];i.forEach(a=>{const s={};s.fieldName=A(a.name),s.fieldValue=e[a.name]||"",t.push(s)}),n.addressExtraFields=t}return n.fileList=a,n.channelId=I,E(n)})(e,ie,l,s);const o=ge.enabled;ue&&(pe({type:"finishInfo",payload:{submitSuccess:!0,isAutoApproval:o,blockPendingAccountOrderCreation:ne}}),pe({type:"all",payload:{accountType:"1"}}),await C(),H(!0))}catch(a){B.error(a),W(a?.message||a)}finally{ye(!1)}}})(e)},children:Z("global.button.submit")})})]})]})})})})});const t=r(s)({"& #b3-customForm-id-name":{'& label[data-shrink="true"]':{whiteSpace:"break-spaces",minWidth:"calc(133% - 24px)",transition:"unset"},'& label[data-shrink="false"]':{whiteSpace:"break-spaces"}}})}}});
//# sourceMappingURL=index-legacy-iuf4oPfl.js.map
