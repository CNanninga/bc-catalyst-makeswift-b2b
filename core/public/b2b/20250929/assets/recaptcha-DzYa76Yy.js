import{j as C}from"./mui-DjJKBaL-.js";import{r as c}from"./intl-D34a3Rgg.js";import{u as R,b_ as f,B as w}from"./react-setup-Ctz-bmMs.js";const h="/* eslint-disable */\n\nwindow.INITIALIZE_CAPTCHA_PREFIX = function () {\n  if (window.grecaptcha?.render === undefined) {\n    return\n  }\n\n  if (window.WIDGET_TIMER_PREFIX !== null) {\n    window.clearInterval(window.WIDGET_TIMER_PREFIX)\n    window.WIDGET_TIMER_PREFIX = null\n  }\n\n  var sendMessage = function (eventType, payload) {\n    window.parent.postMessage(\n      'PREFIX' +\n        JSON.stringify({\n          type: eventType,\n          payload: payload,\n        }),\n      'PARENT_ORIGIN'\n    )\n  }\n\n  window.grecaptcha.render(\n    'PREFIX',\n    {\n      callback: function (token) {\n        sendMessage('CAPTCHA_SUCCESS', token)\n      },\n      'error-callback': function () {\n        sendMessage('CAPTCHA_ERROR', null)\n      },\n      'expired-callback': function () {\n        sendMessage('CAPTCHA_EXPIRED', null)\n      },\n    },\n    true\n  )\n}\n\nwindow.WIDGET_TIMER_PREFIX = window.setInterval(\n  window.INITIALIZE_CAPTCHA_PREFIX,\n  250\n)\n",u="https://www.google.com/recaptcha/api.js?render=explicit";function P(e){if((e==null?void 0:e.head.querySelector('script[src="'.concat(u,'"]')))===null){const n=e.createElement("script");n.src=u,e.head.appendChild(n)}}function T(e,n){if(!e)return;const t=e.createElement("script"),a=h.replace(/PREFIX/g,n).replace(/PARENT_ORIGIN/g,window.location.origin);t.textContent=a,e.head.appendChild(t)}const _=()=>c.useMemo(()=>"widget_".concat(Date.now()),[]);function F({theme:e,size:n,handleGetKey:t,siteKey:a}){const r=R(f),s=_(),d=c.useRef(!1);return c.useEffect(()=>{const l=o=>{var i,p;if((p=(i=o==null?void 0:o.data)==null?void 0:i.startsWith)!=null&&p.call(i,s)){const I=o.data.slice(s.length),{payload:E,type:g}=JSON.parse(I);g==="CAPTCHA_SUCCESS"&&E&&t(E)}};return window.addEventListener("message",l,!1),()=>{d.current&&window.removeEventListener("message",l)}},[s,t]),c.useEffect(()=>{r===void 0||d.current||(P(r),T(r,s),d.current=!0)},[r,s]),C.jsx("div",{id:s,"data-sitekey":a,"data-theme":e,"data-size":n})}const A="query {\n    site {\n        settings {\n            reCaptcha {\n                siteKey\n                isEnabledOnStorefront\n            }\n        }\n    }\n}",S="mutation recaptcha($token: String!, $email: String!) {\n    customer {\n      requestResetPassword(\n        reCaptchaV2: { \n            token: $token\n        },\n        input: {\n          email: $email,\n        }\n      ) {\n        errors {\n          ... on ValidationError {\n            message\n          }\n        }\n      }\n    }\n  }\n",m=(e,n)=>w.graphqlBCProxy({query:S,variables:{token:e,email:n}}),x=()=>w.graphqlBCProxy({query:A}).then(e=>{var n,t,a;return(a=(t=(n=e==null?void 0:e.data)==null?void 0:n.site)==null?void 0:t.settings)==null?void 0:a.reCaptcha});export{F as C,x as g,m as r};
//# sourceMappingURL=recaptcha-DzYa76Yy.js.map
