import{j as p,B as h}from"./mui-DjJKBaL-.js";import{r as E}from"./intl-D34a3Rgg.js";import{j as L,u as m,ad as B,t as M,o as P,aG as k,cj as O,bM as q,p as w,a7 as g,q as A,a9 as U}from"./react-setup-Ctz-bmMs.js";import{b as _}from"./base-CC7kTJh2.js";import"./load-functions-utyuqH_X.js";import{a as v}from"./router-DcuTQ_yx.js";const y=({data:a,companyId:t,parentId:n})=>a.filter(r=>t?r.companyId===t:n?r.parentCompanyId===n:r.parentCompanyId===null||r.parentCompanyId===0).map(r=>({...r,children:y({data:a,parentId:r.companyId})})),b=a=>{let t=[];return t.push({companyId:a.companyId,companyName:a.companyName,parentCompanyId:a.parentCompanyId,parentCompanyName:a.parentCompanyName,channelFlag:a.channelFlag}),a.children&&a.children.length>0&&a.children.forEach(n=>{t=t.concat(b(n))}),t};function W({open:a=!1,handleClose:t,currentRow:n,companyHierarchyAllList:r,title:I,context:C,dialogParams:x={}}){const l=L(),u=v(),{id:o}=m(({company:e})=>e.companyInfo),{pagesSubsidiariesPermission:f}=m(({company:e})=>e),{isHasCurrentPagePermission:S,companyHierarchyAllList:N}=m(({company:e})=>e.companyHierarchyInfo),[H,d]=E.useState(!1),j=async()=>{if(n)try{d(!0);const e=P.get("cartId"),{companyId:i}=n;if(!i)return;if(i===Number(o)?await k():i&&await O(Number(i)),e){const D=q(e);await w(D),g.dispatch(A(0))}const c=i===Number(o)?"":i,s=r||N;g.dispatch(U({selectCompanyHierarchyId:c,...r&&{companyHierarchyAllList:r},companyHierarchySelectSubsidiariesList:b(y({data:s,companyId:i})[0])}))}catch(e){_.error(e)}finally{d(!1),t()}};return p.jsx(B,{isOpen:a,rightSizeBtn:l("global.button.next"),title:I||l("companyHierarchy.dialog.title"),fullWidth:!0,loading:H,handleLeftClick:t,handRightClick:j,restDialogParams:{TransitionProps:{onExited:()=>{if(!n)return;const{companyId:e}=n;if(e===Number(o)){const{hash:i}=window.location;i.includes("/shoppingList/")&&u("/shoppingLists")}if(e!==Number(o)&&!S){const i=Object.keys(f).find(s=>!!f[s]),c=M.find(s=>s.key===i);c&&(t(),d(!1),u(c.path))}}}},dialogSx:{"& .MuiDialogTitle-root":{border:0},"& .MuiDialogActions-root":{border:0}},...x,children:p.jsx(h,{sx:{maxHeight:"600px"},children:p.jsx(h,{sx:{display:"flex",flexDirection:"column",flex:1},children:C||l("companyHierarchy.dialog.content")})})})}export{W as H,y as b};
//# sourceMappingURL=HierarchyDialog-Bh43E3c4.js.map
