import{j as e,A as et,ae as He,ah as lt,B as T,O as Vt,T as w,w as Ct,G as Se,s as We,b as Nt,v as Ut,x as Rt,ai as $t}from"./mui-DjJKBaL-.js";import{r as u}from"./intl-D34a3Rgg.js";import{bz as Ht,bA as Wt,G as tt,an as Gt,u as J,j as ue,ag as we,bt as Mt,ak as ce,ba as ut,bb as dt,bm as Ze,aN as nt,bk as mt,bl as Jt,ah as Kt,bB as Yt,a as Ge,bC as Xt,al as pt,y as vt,ad as jt,a7 as Zt,bD as en,bs as Re,ay as De,bE as Ve,aU as tn,br as st,bh as $e,i as qt,bj as Tt,bx as It,bF as nn,bG as ft,bH as sn,bg as an,C as on,bI as rn,ao as xt,af as cn,l as ln,bJ as Ke,bK as un,aA as dn,I as mn,aI as pn,a3 as fn,bL as ht,bM as xn,p as hn,bN as bn,bn as bt,bO as gn,bP as yn}from"./react-setup-Ctz-bmMs.js";import"./load-functions-utyuqH_X.js";import{a as Sn,u as Pt}from"./form-pKe_k4Gy.js";import{b as kt}from"./base-CC7kTJh2.js";import{d as Cn,c as Nn}from"./config-DFOFJePb.js";import{Q as vn,c as jn,d as qn,f as Tn}from"./QuoteStatus-DYr8EgTf.js";import{v as In}from"./ShoppingListDetailsContext-dB1dpdt_.js";import{B as Pn,Q as kn,C as Ye,a as wn,b as Dn,g as Ln}from"./getQuoteExtraFields-BMutsMTX.js";import{u as Bn}from"./useBlockPendingAccountViewPrice-DCd_y0C0.js";import{S as En,Q as Qn,C as An}from"./SearchProduct-C8Sz4cJ1.js";import{U as Fn,E as wt,f as Dt,W as _n,i as zn}from"./muiIcon-BBtg8u0V.js";import{t as On,f as ke,k as Vn,u as Un,l as Rn}from"./lodashEs-CONzB2I0.js";import{B as Lt}from"./B3CustomForm-BLuJSiae.js";import{v as $n}from"./validatorRules-BK2xeMTW.js";import{B as Hn}from"./B3FilterSearch-BPb2-EyD.js";import{a as Wn}from"./router-DcuTQ_yx.js";import"./reactVendor-CkUTLE5B.js";import"./eCache-97HTO8co.js";import"./redux-Bt5-tVzx.js";import"./toolkit-CpEbzTSY.js";import"../index.js";import"./global-D7Yn0gGb.js";import"./dropzone-B1UJxEDf.js";import"./dateFns-DubixNBV.js";const Gn=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),gt={randomUUID:Gn};function Mn(i,n,l){var x,c,P;if(gt.randomUUID&&!i)return gt.randomUUID();i=i||{};const d=(P=(c=i.random)!=null?c:(x=i.rng)==null?void 0:x.call(i))!=null?P:Ht();if(d.length<16)throw new Error("Random bytes length must be >= 16");return d[6]=d[6]&15|64,d[8]=d[8]&63|128,Wt(d)}const Jn=()=>{const{state:{countriesList:i},dispatch:n}=u.useContext(tt);u.useEffect(()=>{(async()=>{if(i&&!i.length){const{countries:d}=await Gt();n({type:"common",payload:{countriesList:d}})}})()},[i])},Kn=({setAddress:i,setValue:n,getValues:l,control:d,addresses:x})=>{const{state:{countriesList:c}}=u.useContext(tt),P=Sn({control:d,name:"country"});u.useEffect(()=>{const k=x.findIndex(C=>C.name==="country");c!=null&&c.length&&k!==-1&&i(x.map((C,N)=>k===N?{...C,options:c}:C))},[c]),u.useEffect(()=>{var V;if(!P||!(c!=null&&c.length))return;const k=((V=c.find(m=>m.countryCode===P))==null?void 0:V.states)||[],C=x.findIndex(m=>m.name==="state");C!==-1&&i(x.map((m,I)=>C===I?k.length>0?{...m,fieldType:"dropdown",options:k,required:!0}:{...m,fieldType:"text",options:[],required:!1}:m));const N=l("state");n("state",N&&P&&(k.find(m=>m.stateName===N)||k.length===0)?N:"")},[P,c])},Ue=(i,n)=>Object.values(i==null?void 0:i[n]).every(l=>l===""||l===0);function Yn(i){const{updateList:n,addToQuote:l}=i,d=J(({company:y})=>y.companyInfo.id),x=J(({company:y})=>y.customer.customerGroupId),c=J(({company:y})=>y.companyInfo.status),[P,k]=u.useState(!1),[C,N]=u.useState(!1),[V]=Bn(),m=ue(),I=y=>y.map(B=>{const{variantId:E,newSelectOptionList:F,id:U,name:h,quantity:j,variants:r=[],basePrice:t,taxPrice:s,calculatedValue:Q}=B,S=r.length===1?r[0]:r.find(se=>se.variant_id===E),{image_url:H="",sku:_}=S;let q;try{q=JSON.stringify(F)}catch(se){q="[]"}const ee=S.bc_calculated_price.tax_exclusive,Z=S.bc_calculated_price.tax_inclusive,R=t||ee,Y=s||Number(Z)-Number(ee);return{node:{basePrice:R,taxPrice:Y,optionList:q,id:mt(),primaryImage:H,productId:U,productName:h,calculatedValue:Q,productsSearch:{...B,selectOptions:q},quantity:j,variantSku:_}}}),D=async y=>{const B=I(y),E=y.filter(({sku:U,variantId:h,variants:j})=>{const t=j.find(s=>s.variant_id===h||s.variantId===h).sku;return!(U||t)});if(E.length>0&&ce.error(m("quoteDraft.notification.cantAddProductsNoSku")),E.length===y.length)return;await l(B)&&ce.success(m("quoteDraft.notification.productSingular"))},a=async y=>{const B=y.map(j=>j.productId),{productsSearch:E}=await ut({productIds:B,companyId:d,customerGroupId:x}),F=dt(E).map(j=>{const r=y.find(S=>S.productId===j.id)||{},{variantId:t,newSelectOptionList:s,quantity:Q}=r;return{...j,variantId:t,newSelectOptionList:s,quantity:Q}});await Ze(F);const U=I(F);await l(U)&&ce.success(m("quoteDraft.notification.productPlural"))},v=y=>(y==null?void 0:y.length)===0?[]:y.map(({option_id:E,id:F})=>({optionId:"attribute[".concat(E,"]"),optionValue:F})),K=async y=>{N(!0);try{const{validProduct:B}=y,E=[];B.forEach(r=>{const{products:t}=r;E.includes(Number(t.productId))||E.push(Number(t.productId))});const{productsSearch:F}=await ut({productIds:E,companyId:d,customerGroupId:x}),U=dt(F),h=[];B.forEach(r=>{const{products:{option:t,variantSku:s,productId:Q,productName:S,variantId:H},qty:_}=r,q=v(t),ee=U.find(Y=>Number(Y.id)===Number(Q)),Z=ee.variants.find(Y=>{var se;return((se=Y==null?void 0:Y.sku)==null?void 0:se.toUpperCase())===(s==null?void 0:s.toUpperCase())}),R={node:{id:mt(),variantSku:Z==null?void 0:Z.sku,variantId:H,productsSearch:{...ee,newSelectOptionList:q,variantId:H},primaryImage:Z.image_url||nt,productName:S,quantity:Number(_)||1,optionList:JSON.stringify(q),productId:Q,basePrice:Z.bc_calculated_price.as_entered,taxPrice:Z.bc_calculated_price.tax_inclusive-Z.bc_calculated_price.tax_exclusive}};h.push(R)}),Jt(h)?(await Ze(h,"2"),await l(h)&&ce.success(m("quoteDraft.notification.productPlural")),n(),k(!1)):ce.error(m("quoteDraft.notification.errorRangeProducts"))}catch(B){kt.error(B)}finally{N(!1)}},A=()=>{V&&c===0?ce.info(m("quoteDraft.notification.businessAccountPendingActivation")):k(!0)};return e.jsx(et,{children:e.jsx(He,{sx:{p:"16px !important"},children:e.jsxs(Pn,{title:m("quoteDraft.collapseTitle.addToQuote"),children:[e.jsx(En,{updateList:n,addToList:D,type:"quote",searchDialogTitle:m("quoteDraft.modalTitle.addToQuote"),addButtonText:m("quoteDraft.searchProduct.addToQuoteButton")}),e.jsx(lt,{}),e.jsx(Qn,{updateList:n,quickAddToList:a,level:1,buttonText:m("quoteDraft.button.addProductsToAddToQuote")}),e.jsx(lt,{}),e.jsx(T,{sx:{margin:"20px 0 0"},children:e.jsxs(we,{variant:"text",onClick:()=>A(),children:[e.jsx(Fn,{sx:{marginRight:"8px"}}),m("quoteDraft.button.bulkUploadCSV")]})}),e.jsx(Mt,{isOpen:P,setIsOpen:k,handleAddToList:K,isLoading:C,withModifiers:!0})]})})})}const Bt=$n(["email"]),Xn=(i,n,l)=>[{name:"name",label:n("quoteDraft.contactInfo.contactPerson"),required:!0,default:"",fieldType:"text",xs:i?12:6,variant:"filled",size:"small",disabled:!l},{name:"email",label:n("quoteDraft.contactInfo.email"),required:!0,default:"",fieldType:"text",xs:i?12:6,variant:"filled",size:"small",validate:Bt,disabled:!l},{name:"phoneNumber",label:n("quoteDraft.contactInfo.phone"),required:!1,default:"",fieldType:"text",xs:i?12:6,variant:"filled",size:"small"},{name:"companyName",label:n("quoteDraft.contactInfo.companyName"),required:!1,default:"",fieldType:"text",xs:i?12:6,variant:"filled",size:"small"}],Zn=({isMobile:i,b3Lang:n,quoteExtraFields:l,referenceNumber:d,recipients:x,handleSaveClick:c})=>{const P=l.map(C=>({...C,xs:i?12:6}));return[{name:"quoteTitle",label:n("quoteDraft.contactInfo.quoteTitle"),required:!1,default:"",fieldType:"text",xs:i?12:6,variant:"filled",size:"small"},{name:"referenceNumber",label:n("quoteDraft.contactInfo.referenceNumber"),required:!1,default:d||"",fieldType:"text",xs:i?12:6,variant:"filled",size:"small"},...P,{name:"ccEmail",label:n("quoteDraft.contactInfo.ccEmail"),required:!1,default:"",fieldType:"multiInputText",xs:i?12:6,variant:"filled",size:"small",isEmail:!0,existValue:x,validate:Bt,isEnterTrigger:!0,handleSave:c}]};function es({info:i,emailAddress:n,quoteExtraFields:l,referenceNumber:d,extraFieldsDefault:x,recipients:c,handleSaveCCEmail:P},k){const{control:C,getValues:N,setError:V,formState:{errors:m},setValue:I,handleSubmit:D}=Pt({mode:"onSubmit"}),v=J(({company:t})=>t.customer.role)===Kt.GUEST,K=J(Yt),[A]=Ge(),y=ue();u.useEffect(()=>{i&&JSON.stringify(i)!=="{}"&&Object.keys(i).forEach(t=>{I(t,i&&i[t])}),x.length&&x.forEach(t=>{t.fieldName&&I(t.fieldName,t.value)})},[i,x]);const B=async t=>n===On(t)?!0:(K||V("email",{type:"custom",message:y("quoteDraft.contactInfo.emailExists")}),K),E=async()=>{var S;const t=N(),s=l.map(H=>({fieldName:H.name,fieldValue:H.name?t[H.name]:""})),Q=await Xt({extraFields:s});if(Q.code!==200){const _=(((S=Q.data)==null?void 0:S.errMsg)||Q.message||"").split(":");if(_.length>=2){const q=l==null?void 0:l.find(ee=>ee.name===_[0]);if(q&&q.name)return V(q.name,{type:"manual",message:_[1]}),!1}return!1}return!0},F=t=>{P(t)},U=async()=>{let t=!0;return await D(async s=>{t=await B(s.email)},()=>{t=!1})(),t&&(t=await E()),t&&N()};u.useImperativeHandle(k,()=>({getContactInfoValue:U}));const h=Xn(A,y,v),j=Zn({isMobile:A,b3Lang:y,quoteExtraFields:l,referenceNumber:d,recipients:c,handleSaveClick:F}),r=[{title:y("quoteDraft.contactInfo.contact"),infos:h},{title:y("quoteDraft.quoteInfo.title"),infos:j,style:{mt:"20px"}}];return e.jsx(T,{width:"100%",children:r.map(t=>e.jsxs(T,{width:"100%",children:[e.jsx(T,{sx:{fontWeight:400,fontSize:"24px",height:"32px",mb:"20px",...t==null?void 0:t.style},children:t.title}),e.jsx(Lt,{formFields:t.infos,errors:m,control:C,setError:V,getValues:N,setValue:I})]},t.title))})}const ts=u.forwardRef(es),ns=Ct("div")(({marginBottom:i})=>({marginBottom:i,"& > span:not(:last-child)":{marginRight:"4px"}})),ss=Ct("div")(({theme:i})=>({display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:i.spacing(3)}));function as(i){const{item:n,onSetAddress:l}=i,d=Vt(),x=ue();return e.jsx(et,{children:e.jsxs(He,{sx:{color:"#313440",wordBreak:"break-word"},children:[n.label&&e.jsx(w,{variant:"h5",sx:{marginBottom:n.isDefaultShipping===1||n.isDefaultBilling===1?d.spacing(1):d.spacing(3),color:"rgba(0, 0, 0, 0.87)"},children:n.label}),e.jsxs(ns,{marginBottom:n.isDefaultShipping===1||n.isDefaultBilling===1?d.spacing(3):0,children:[n.isDefaultShipping===1&&e.jsx(pt,{color:"#C4DD6C",textColor:"rgba(0, 0, 0, 0.87)",children:x("quoteDraft.addressItemCard.defaultShipping")}),n.isDefaultBilling===1&&e.jsx(pt,{color:"#C4DD6C",textColor:"rgba(0, 0, 0, 0.87)",children:x("quoteDraft.addressItemCard.defaultBilling")})]}),e.jsx(w,{variant:"body1",children:"".concat(n.firstName," ").concat(n.lastName)}),e.jsx(w,{variant:"body1",children:n.company||""}),e.jsx(w,{variant:"body1",children:n.addressLine1}),e.jsx(w,{variant:"body1",children:n.addressLine2}),e.jsx(w,{variant:"body1",children:"".concat(n.city,", ").concat(n.state," ").concat(n.zipCode,", ").concat(n.country)}),e.jsx(w,{variant:"body1",children:n.phoneNumber}),e.jsx(ss,{children:e.jsx(we,{variant:"text",onClick:()=>{l(n)},children:x("quoteDraft.addressItemCard.chooseAddress")})})]})},n.id)}function os({isOpen:i,closeModal:n,handleChangeAddress:l,addressList:d=[],type:x}){const c=u.useRef({copyList:[]}),P=ue(),k=J(vt),[C,N]=u.useState([]);u.useEffect(()=>{if(d.length){const D=d.map(v=>v.node),a=D.filter(v=>v.isShipping===1&&x==="shipping"||v.isBilling===1&&x==="billing");c.current.copyList=k?a:D,N(a)}},[d,x,k]);const V=["address","firstName","lastName","phoneNumber","state","zipCode","country","label","address","addressLine1"],m=D=>{if(!D&&(c!=null&&c.current)){N(c.current.copyList);return}const a=[];V.forEach(v=>{let K=!0;C.forEach(A=>{A[v].includes(D)&&K&&(a.push(A),K=!1)})}),N(a)},I=()=>{n()};return e.jsxs(jt,{fullWidth:!0,isOpen:i,handleLeftClick:I,title:P("quoteDraft.chooseAddress.chooseFromSaved"),showRightBtn:!1,maxWidth:"lg",children:[e.jsx(T,{children:e.jsx(Hn,{searchBGColor:"rgba(0, 0, 0, 0.06)",placeholder:P("quoteDraft.chooseAddress.searchAddress"),handleChange:D=>{m(D)}})}),e.jsx(T,{sx:{mt:"20px"},children:e.jsx(Se,{container:!0,spacing:2,children:C.map(D=>e.jsx(Se,{item:!0,xs:4,children:e.jsx(as,{item:D,onSetAddress:l})},D.id))})})]})}function rs({title:i,addressList:n=[],pr:l=0,pl:d=0,info:x,role:c,accountFormFields:P=[],shippingSameAsBilling:k=!1,type:C,setBillingChange:N},V){const{control:m,getValues:I,formState:{errors:D},setValue:a}=Pt({mode:"onSubmit"}),[v]=Ge(),K=ue(),[A,y]=u.useState(!1),[B,E]=u.useState(ke(P));Kn({control:m,setValue:a,getValues:I,setAddress:E,addresses:B});const F=()=>I(),U=s=>{Object.keys(s).forEach(S=>{S!=="company"&&a(S,s[S])})};u.useImperativeHandle(V,()=>({getContactInfoValue:F,setShippingInfoValue:U}));const h=()=>{y(!0)},j=()=>{y(!1)},r=s=>{const Q={label:(s==null?void 0:s.label)||"",firstName:(s==null?void 0:s.firstName)||"",lastName:(s==null?void 0:s.lastName)||"",company:(s==null?void 0:s.company)||"",country:(s==null?void 0:s.countryCode)||"",address:(s==null?void 0:s.addressLine1)||"",apartment:(s==null?void 0:s.addressLine2)||"",city:(s==null?void 0:s.city)||"",state:(s==null?void 0:s.state)||"",zipCode:(s==null?void 0:s.zipCode)||"",phoneNumber:(s==null?void 0:s.phoneNumber)||""};Object.keys(Q).forEach(S=>{S!=="company"&&a(S,Q[S])}),C==="billing"&&k&&N(!0),j()};u.useEffect(()=>{JSON.stringify(x)!=="{}"&&Object.keys(x).forEach(s=>{a(s,x[s])})},[x]);const t=u.useId();return e.jsxs(T,{role:"group","aria-labelledby":t,width:v?"100%":"50%",mt:v?"2rem":"0",pr:l,pl:d,children:[e.jsxs(T,{sx:{display:"flex",mb:"20px"},children:[e.jsx(w,{id:t,sx:{fontWeight:400,fontSize:"24px",height:"32px",mr:"16px"},children:i}),Number(c)!==100&&e.jsx(w,{onClick:h,sx:{fontWeight:500,fontSize:"14px",color:"primary.main",display:"flex",alignItems:"flex-end",cursor:"pointer",textTransform:"uppercase"},children:K("quoteDraft.quoteAddress.chooseFromSaved")})]}),e.jsx(Lt,{formFields:B,errors:D,control:m,getValues:I,setValue:a}),e.jsx(os,{isOpen:A,handleChangeAddress:r,closeModal:j,addressList:n,type:C})]})}const yt=u.forwardRef(rs);function is({isOpen:i=!1,onClose:n,quoteSubmissionResponseInfo:l}){const d=ue(),x=l.message.split("\n");return e.jsx(T,{sx:{"#b2b-dialog-container":{'& [aria-labelledby="alert-dialog-title"]':{width:"500px",maxHeight:"500px"},"& h2":{color:"#313440"},"& h6":{color:"#313440",fontSize:"16px"}}},children:e.jsx(jt,{isOpen:i,title:l.title,showLeftBtn:!1,handRightClick:n,isShowBordered:!1,rightSizeBtn:d("quoteDraft.submission.response.button.text"),maxWidth:!1,children:x.map(c=>e.jsx(w,{variant:"subtitle2",sx:{marginTop:"1rem"},children:c},c))})})}const cs=i=>{const{global:{blockPendingQuoteNonPurchasableOOS:{isEnableProduct:n}}}=Zt.getState();return n?i.some(d=>!en(d.node.basePrice,d)):!1},St={subtotal:0,shipping:0,tax:0,grandTotal:0},ls=u.forwardRef((i,n)=>{const l=ue(),[d,x]=u.useState({...St}),[c,P]=u.useState(!1),k=J(({global:a})=>a.showInclusiveTaxPrice),C=J(({quoteInfo:a})=>a.draftQuoteList),N=a=>parseFloat(String(a)),V=u.useCallback(()=>{const a=cs(C);P(a);const v=C.reduce((K,A)=>{const{basePrice:y,taxPrice:B=0,quantity:E}=A.node;let{subtotal:F,grandTotal:U,tax:h}=K;const{shipping:j}=K,r=Re(Number(y),Number(B));return F+=N(r*E),h+=N(Number(B)*Number(E)),U=(k?F:F+h)+j,{grandTotal:U,shipping:j,tax:h,subtotal:F}},{...St});x(v)},[k,C]);u.useEffect(()=>{V()},[V]),u.useImperativeHandle(n,()=>({refreshSummary:()=>V()}));const m=a=>De(a),I=a=>c?l("quoteDraft.quoteSummary.tbd"):a,D=u.useId();return e.jsx(et,{role:"article","aria-labelledby":D,children:e.jsx(He,{children:e.jsxs(T,{children:[e.jsx(w,{id:D,variant:"h5",children:l("quoteDraft.quoteSummary.summary")}),e.jsxs(T,{sx:{marginTop:"20px",color:"#212121"},children:[e.jsxs(Se,{container:!0,justifyContent:"space-between",sx:{margin:"4px 0"},children:[e.jsx(w,{children:l("quoteDraft.quoteSummary.subTotal")}),e.jsx(w,{children:I(m(d.subtotal))})]}),e.jsxs(Se,{container:!0,justifyContent:"space-between",sx:{margin:"4px 0"},children:[e.jsx(w,{children:l("quoteDraft.quoteSummary.shipping")}),e.jsx(w,{children:l("quoteDraft.quoteSummary.tbd")})]}),e.jsxs(Se,{container:!0,justifyContent:"space-between",sx:{margin:"4px 0"},children:[e.jsx(w,{children:l("quoteDraft.quoteSummary.tax")}),e.jsx(w,{children:I(m(d.tax))})]}),e.jsxs(Se,{container:!0,justifyContent:"space-between",sx:{margin:"24px 0 0"},children:[e.jsx(w,{sx:{fontWeight:"bold"},children:l("quoteDraft.quoteSummary.grandTotal")}),e.jsx(w,{sx:{fontWeight:"bold"},children:I(m(d.grandTotal))})]})]})]})})})});function us({columnItems:i,isCustomRender:n=!1,tableKey:l,renderItem:d,noDataText:x="",tableFixed:c=!1,tableHeaderHide:P=!1,rowsPerPageOptions:k=[10,20,30],itemSpacing:C=2,itemXs:N=4,showCheckbox:V=!1,showSelectAllCheckbox:m=!1,selectedSymbol:I="id",isSelectOtherPageCheckbox:D=!1,showBorder:a=!0,getSelectCheckbox:v,hover:K=!1,labelRowsPerPage:A="",itemIsMobileSpacing:y=2,disableCheckbox:B=!1,onClickRow:E,showPagination:F=!0,showRowsPerPageOptions:U=!0,CollapseComponent:h,applyAllDisableCheckbox:j=!0,sortDirection:r="asc",sortByFn:t=()=>{},orderBy:s="",pageType:Q="",items:S}){const H={offset:0,first:k[0]},[_,q]=u.useState(H),[ee,Z]=u.useState(!1),[R,Y]=u.useState([]),[se]=Ge();u.useEffect(()=>{v&&v(R)},[R,S]);const me=async te=>{q(te)},Ce={..._,count:S.length},xe=u.useCallback(()=>R.length?S.every(te=>{const ae=Ve(te)?te.node:te;return R.includes(ae[I])}):!1,[S,R,I]);u.useEffect(()=>{if(D){const te=xe();Z(te)}},[R,_,D,xe]);const de=()=>{D?(()=>{const W=xe(),$=[...R];W?S.forEach(G=>{const be=Ve(G)?G.node:G,Le=$.findIndex(Me=>Me===be[I]);$.splice(Le,1)}):S.forEach(G=>{const be=Ve(G)?G.node:G;R.includes(be[I])||$.push(be[I])}),Y($)})():(()=>{if(R.length===S.length)Y([]);else{const W=[];S.forEach($=>{const G=Ve($)?$.node:$;G&&(Q==="shoppingListDetailsTable"?W.push(G.quantity>0||!G.disableCurrentCheckbox?G[I]:""):W.push(G[I]))}),Y(W)}})()},Ne=te=>{const ae=[...R],W=ae.indexOf(te);W!==-1?ae.splice(W,1):ae.push(te),Y(ae)};return e.jsx(tn,{hover:K,columnItems:i||[],listItems:S.slice(_.offset,_.offset+_.first),pagination:Ce,rowsPerPageOptions:k,onPaginationChange:me,isCustomRender:n,isInfiniteScroll:se,renderItem:d,tableFixed:c,tableHeaderHide:P,itemSpacing:C,itemXs:N,noDataText:x,tableKey:l,itemIsMobileSpacing:y,showCheckbox:V,showSelectAllCheckbox:m,disableCheckbox:B,selectedSymbol:I,isSelectOtherPageCheckbox:D,isAllSelect:ee,selectCheckbox:R,handleSelectAllItems:de,handleSelectOneItem:Ne,showBorder:a,labelRowsPerPage:A,onClickRow:E,showPagination:F,showRowsPerPageOptions:U,CollapseComponent:h,applyAllDisableCheckbox:j,sortDirection:r,sortByFn:t,orderBy:s})}const ds=We("img")(()=>({maxWidth:"60px",height:"auto",marginRight:"0.5rem"}));function ms(i){const{item:n,onEdit:l,onDelete:d,handleUpdateProductQty:x,idEdit:c,len:P,itemIndex:k}=i,{basePrice:C,quantity:N,id:V,primaryImage:m,productName:I,variantSku:D,productsSearch:a,taxPrice:v=0}=n,K=ue(),A=Re(Number(C),Number(v)),y=A*Number(N),B={...n.productsSearch,selectOptions:n.optionList},E=st(B,{}),F=JSON.parse(n.optionList),U=E.filter(t=>t.valueText),{productUrl:h}=a,j=$e({price:De(A),productInfo:n,showText:K("quoteDraft.quoteSummary.tbd")}),r=$e({price:De(y),productInfo:n,showText:K("quoteDraft.quoteSummary.tbd")});return e.jsx(T,{width:"100%",sx:{borderTop:"1px solid #D9DCE9",borderBottom:k===P-1?"1px solid #D9DCE9":""},children:e.jsxs(He,{sx:{color:"#313440",display:"flex",pl:0},children:[e.jsx(T,{children:e.jsx(ds,{src:m||nt,alt:"Product-img",loading:"lazy"})}),e.jsxs(T,{sx:{flex:1},children:[e.jsx(w,{variant:"body1",color:"#212121",onClick:()=>{const{location:{origin:t}}=window;h&&(window.location.href="".concat(t).concat(h))},sx:{cursor:"pointer"},children:I}),e.jsx(w,{variant:"body1",color:"#616161",children:D}),e.jsx(T,{sx:{margin:"1rem 0"},children:F.length>0&&U.length>0&&e.jsx(T,{children:U.map(t=>e.jsx(w,{sx:{fontSize:"0.75rem",lineHeight:"1.5",color:"#455A64"},children:"".concat(t.valueLabel,": ").concat(t.valueText)},t.valueLabel))})}),e.jsx(w,{sx:{fontSize:"14px"},children:"Price: ".concat(j)}),e.jsx(Nt,{size:"small",type:"number",variant:"filled",label:"qty",disabled:!c,inputProps:{inputMode:"numeric",pattern:"[0-9]*"},value:N,sx:{margin:"1rem 0",width:"60%",maxWidth:"100px","& label":{fontSize:"14px"},"& input":{fontSize:"14px"}},onChange:t=>{x(n,t.target.value)}}),e.jsx(w,{sx:{fontSize:"14px"},children:"Total: ".concat(r)}),e.jsxs(T,{sx:{marginTop:"1rem",textAlign:"end"},id:"shoppingList-actionList-mobile",children:[F.length>0&&c&&e.jsx(wt,{sx:{marginRight:"0.5rem",cursor:"pointer",color:"rgba(0, 0, 0, 0.54)"},onClick:()=>{l({...a,quantity:N,selectOptions:n.optionList},V)}}),c&&e.jsx(Dt,{sx:{cursor:"pointer",color:"rgba(0, 0, 0, 0.54)"},onClick:()=>{d(V)}})]})]})]})},n.id)}const ps=We("div")(()=>({backgroundColor:"#FFFFFF",padding:"0",width:"100%","& tbody":{"& tr":{"& td":{verticalAlign:"top"},"& td: first-of-type":{verticalAlign:"inherit"}},"& tr: hover":{"& #shoppingList-actionList":{opacity:1}}}})),fs=We("img")(()=>({maxWidth:"60px",height:"auto",marginRight:"0.5rem"})),xs=We(Nt)(()=>({"& input":{paddingTop:"12px",paddingRight:"6px"}})),Xe=1e6;function hs(i){const{total:n,items:l,idEdit:d=!0,updateSummary:x}=i,c=ue(),P=qt(),k=Tt(),[C,N]=u.useState(!1),[V,m]=u.useState(!1),[I,D]=u.useState(null),[a,v]=u.useState(""),K=J(({global:r})=>r.blockPendingQuoteNonPurchasableOOS.isEnableProduct),A=async(r,t)=>{const s=await nn(r,Number(t));P(ft({id:s.id,product:{node:s}})),x()},y=async(r,t)=>{let s=Vn(Number(t));s===Number(t)&&s>=1&&s<=Xe||(Number(t)<1&&(s=1),Number(t)>Xe&&(s=Xe),A(r,s))},B=r=>{P(sn(r)),x()},E=()=>{m(!1)},F=(r,t)=>{D(r),v(t),m(!0)},U=r=>r.map(t=>{var ae,W;const{variantId:s,newSelectOptionList:Q,id:S,productId:H,name:_,quantity:q,variants:ee=[],basePrice:Z,taxPrice:R=0,calculatedNoTaxPrice:Y=0,calculatedTaxPrice:se=0}=t;let[me]=ee;ee.length>1&&(me=(ae=ee.find($=>$.variant_id===s))!=null?ae:me);const{image_url:Ce="",sku:xe}=me;let de;try{de=JSON.stringify(Q)}catch($){de="[]"}const Ne=((W=me.bc_calculated_price)==null?void 0:W.tax_exclusive)||0;return{node:{basePrice:Z||Ne,taxPrice:R,optionList:de,id:S.toString(),primaryImage:Ce,productId:H,productName:_,productsSearch:{...t,selectOptions:de},quantity:Number(q),variantSku:xe,calculatedTaxPrice:se,calculatedNoTaxPrice:Y,calculatedValue:{}}}}),h=async r=>{await Ze(r);const t=U(r);t.forEach(s=>{const{basePrice:Q}=s.node,S=s;S.node.id=a,S.node.basePrice=Q}),m(!1),P(ft({id:a,product:t[0]})),x(),ce.success(c("quoteDraft.quoteTable.productUpdated"))},j=[{key:"Product",title:c("quoteDraft.quoteTable.product"),render:r=>{const t={...r.productsSearch,selectOptions:r.optionList},s=st(t,{}),Q=JSON.parse(r.optionList),S=s.filter(q=>q.valueText);let H=null,_=null;if(!k["B2B-3318.move_stock_and_backorder_validation_to_backend"]){const q=It(r);if(!K&&(q==null?void 0:q.name))if((q==null?void 0:q.type)==="oos"){const Z=t.inventoryTracking||r.inventoryTracking||"none";let R=t.inventoryLevel||r.inventoryLevel||0;if(Z==="variant"){const Y=t.variants.find(se=>se.sku===r.variantSku);R=Y==null?void 0:Y.inventory_level}H=c("quoteDraft.quoteTable.outOfStock.tip"),_=c("quoteDraft.quoteTable.oosNumber.tip",{qty:R})}else H=c("quoteDraft.quoteTable.unavailable.tip")}return e.jsxs(T,{sx:{display:"flex",alignItems:"flex-start"},children:[e.jsx(fs,{src:r.primaryImage||nt,alt:"Product-img",loading:"lazy"}),e.jsxs(T,{children:[e.jsx(w,{variant:"body1",color:"#212121",onClick:()=>{const{location:{origin:q}}=window;t!=null&&t.productUrl&&(window.location.href="".concat(q).concat(t==null?void 0:t.productUrl))},sx:{cursor:"pointer"},children:r.productName}),e.jsx(w,{variant:"body1",color:"#616161",children:r.variantSku}),Q.length>0&&S.length>0&&e.jsx(T,{children:S.map(q=>e.jsx(w,{sx:{fontSize:"0.75rem",lineHeight:"1.5",color:"#455A64"},children:"".concat(q.valueLabel,": ").concat(q.valueText)},q.valueLabel))}),H&&e.jsxs(T,{sx:{color:"red"},children:[e.jsxs(T,{sx:{mt:"1rem",display:"flex",alignItems:"center","& svg":{mr:"0.5rem"}},children:[e.jsx(_n,{color:"error",fontSize:"small"}),H]}),_&&e.jsx(T,{children:_})]})]})]})},width:"40%"},{key:"Price",title:c("quoteDraft.quoteTable.price"),render:r=>{const{basePrice:t,taxPrice:s}=r,Q=Re(Number(t),Number(s));return e.jsx(w,{sx:{padding:"12px 0"},children:$e({price:De(Q),productInfo:r,showText:c("quoteDraft.quoteSummary.tbd")})})},width:"15%",style:{textAlign:"right"}},{key:"Qty",title:c("quoteDraft.quoteTable.qty"),render:r=>e.jsx(xs,{size:"small",type:"number",variant:"filled",disabled:!d,value:r.quantity,inputProps:{inputMode:"numeric",pattern:"[0-9]*"},onChange:t=>{A(r,Number(t.target.value))},onBlur:t=>{y(r,Number(t.target.value))},sx:{width:"75%"}}),width:"15%",style:{textAlign:"right"}},{key:"Total",title:c("quoteDraft.quoteTable.total"),render:r=>{const{basePrice:t,quantity:s,taxPrice:Q}=r,H=Re(Number(t),Number(Q))*Number(s),_=JSON.parse(r.optionList);return e.jsxs(T,{children:[e.jsx(w,{sx:{padding:"12px 0"},children:$e({price:De(H),productInfo:r,showText:c("quoteDraft.quoteSummary.tbd")})}),e.jsxs(T,{sx:{marginTop:"1rem",opacity:0,textAlign:"end"},id:"shoppingList-actionList",children:[_.length>0&&d&&e.jsx(wt,{sx:{marginRight:"0.5rem",cursor:"pointer",color:"rgba(0, 0, 0, 0.54)"},onClick:()=>{const{productsSearch:q,id:ee,optionList:Z,quantity:R}=r;F({...q,quantity:R,selectOptions:Z},ee)}}),d&&e.jsx(Dt,{sx:{cursor:"pointer",color:"rgba(0, 0, 0, 0.54)"},onClick:()=>{const{id:q}=r;B(q)}})]})]})},width:"15%",style:{textAlign:"right"}}];return e.jsxs(ps,{children:[e.jsx(T,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",margin:"0.5rem 0 1rem"},children:e.jsx(w,{sx:{fontSize:"24px"},children:c("quoteDraft.quoteTable.totalProducts",{total:n||0})})}),e.jsx(us,{columnItems:j,rowsPerPageOptions:[12,24,36],items:l,isCustomRender:!1,hover:!0,labelRowsPerPage:c("quoteDraft.quoteTable.perPage"),showBorder:!1,itemIsMobileSpacing:0,noDataText:c("quoteDraft.quoteTable.noProducts"),renderItem:(r,t)=>e.jsx(ms,{len:n||0,item:r,itemIndex:t,onEdit:F,onDelete:B,handleUpdateProductQty:A,idEdit:d})}),e.jsx(An,{isOpen:V,isLoading:C,setIsLoading:N,product:I,onCancel:E,onConfirm:h,isEdit:!0})]})}const bs=(i,n)=>[{name:"label",label:n("quoteDraft.config.addressLabel"),required:!1,default:"",fieldType:"text",xs:12,variant:"filled",size:"small"},{name:"firstName",label:n("quoteDraft.config.firstName"),required:!1,default:"",fieldType:"text",xs:i?12:6,variant:"filled",size:"small"},{name:"lastName",label:n("quoteDraft.config.lastName"),required:!1,default:"",fieldType:"text",xs:i?12:6,variant:"filled",size:"small"},{name:"companyName",label:n("quoteDraft.config.company"),required:!1,default:"",fieldType:"text",xs:12,variant:"filled",size:"small"},{name:"country",label:n("quoteDraft.config.country"),required:!1,default:"",fieldType:"dropdown",options:[],xs:12,variant:"filled",size:"small",replaceOptions:{label:"countryName",value:"countryCode"}},{name:"address",label:n("quoteDraft.config.addressLine1"),required:!1,default:"",fieldType:"text",xs:12,variant:"filled",size:"small"},{name:"apartment",label:n("quoteDraft.config.addressLine2"),required:!1,default:"",fieldType:"text",xs:12,variant:"filled",size:"small"},{name:"city",label:n("quoteDraft.config.city"),required:!1,default:"",fieldType:"text",options:[],xs:12,variant:"filled",size:"small"},{name:"state",label:n("quoteDraft.config.state"),required:!1,default:"",fieldType:"text",options:[],xs:i?12:6,variant:"filled",size:"small",replaceOptions:{label:"stateName",value:"stateName"}},{name:"zipCode",label:n("quoteDraft.config.zipCode"),required:!1,default:"",fieldType:"text",options:[],xs:i?12:6,variant:"filled",size:"small"},{name:"phoneNumber",label:n("quoteDraft.config.phoneNumber"),required:!1,default:"",fieldType:"text",xs:12,variant:"filled",size:"small"}],gs={address:"",addressId:0,apartment:"",city:"",country:"",firstName:"",label:"",lastName:"",phoneNumber:"",state:"",zipCode:"",companyName:""},ys={address:"",addressId:0,apartment:"",city:"",country:"",firstName:"",label:"",lastName:"",phoneNumber:"",state:"",zipCode:"",companyName:""};function Ws({setOpenPage:i}){const{state:{countriesList:n,openAPPParams:l}}=u.useContext(tt),d=qt(),x=Tt(),c=J(vt),P=J(({company:o})=>o.companyInfo.id),k=J(({company:o})=>o.companyInfo.companyName),C=J(({company:o})=>o.customer),N=J(({company:o})=>o.customer.role),V=J(({storeConfigs:o})=>o.currencies.enteredInclusiveTax),m=J(({quoteInfo:o})=>o.draftQuoteList),I=J(({b2bFeatures:o})=>o.masqueradeCompany.id),D=J(({b2bFeatures:o})=>o.masqueradeCompany.companyName),a=J(({quoteInfo:o})=>o.draftQuoteInfo),v=J(an),K=J(({global:o})=>o.quoteSubmissionResponse),{selectCompanyHierarchyId:A}=J(({company:o})=>o.companyHierarchyInfo),y=J(({global:o})=>o.blockPendingQuoteNonPurchasableOOS.isEnableProduct),{state:{portalStyle:{backgroundColor:B="#FEF9F5"}}}=u.useContext(on),E=x["B2B-3318.move_stock_and_backorder_validation_to_backend"],F=u.useMemo(()=>c?rn(xt.quotesCreateActionsPermission,Number(A)):!0,[c,A]),U=Wn(),h=ue(),[j]=Ge(),[r,t]=u.useState(!1),[s,Q]=u.useState(!1),[S,H]=u.useState([]),[_,q]=u.useState(!1),[ee,Z]=u.useState(!1),[R,Y]=u.useState(!1),[se,me]=u.useState(""),[Ce,xe]=u.useState(""),[de,Ne]=u.useState([]),te=u.useRef(null),[ae]=Cn({level:dn.COMPANY_SUBSIDIARIES,code:xt.getAddressesPermission,containOrEqual:"equal"});Jn();const W=u.useRef(null),$=u.useRef(null),G=u.useRef(null);u.useEffect(()=>{(async()=>{var X,M,Be,Ee,Je,Qe,ve,je,qe,Ae,Fe,pe,ge,_e,ze,Oe,Te,fe,ye,Ie,O,p,le,Pe;t(!0);const g=ie=>{const oe={...ie};oe.contactInfo={name:"".concat(C.firstName," ").concat(C.lastName),email:C.emailAddress,companyName:k||D||"",phoneNumber:C.phoneNumber},d(Ke(oe))},z=ke(a);try{if(c){const oe=P||I;let ne=[];const re=async L=>{const{addresses:{edges:he}}=await jn(L);return he};A?A&&ae&&(ne=await re(Number(A))):ne=await re(Number(oe));const b=ne.find(L=>{var he;return((he=L==null?void 0:L.node)==null?void 0:he.isDefaultShipping)===1}),f=ne.find(L=>{var he;return((he=L==null?void 0:L.node)==null?void 0:he.isDefaultBilling)===1});if(b&&Ue(z,"shippingAddress")){const L={label:((X=b==null?void 0:b.node)==null?void 0:X.label)||"",firstName:((M=b==null?void 0:b.node)==null?void 0:M.firstName)||"",lastName:((Be=b==null?void 0:b.node)==null?void 0:Be.lastName)||"",companyName:((Ee=b==null?void 0:b.node)==null?void 0:Ee.company)||"",country:((Je=b==null?void 0:b.node)==null?void 0:Je.countryCode)||"",address:((Qe=b==null?void 0:b.node)==null?void 0:Qe.addressLine1)||"",apartment:((ve=b==null?void 0:b.node)==null?void 0:ve.addressLine2)||"",city:((je=b==null?void 0:b.node)==null?void 0:je.city)||"",state:((qe=b==null?void 0:b.node)==null?void 0:qe.state)||"",zipCode:((Ae=b==null?void 0:b.node)==null?void 0:Ae.zipCode)||"",phoneNumber:((Fe=b==null?void 0:b.node)==null?void 0:Fe.phoneNumber)||"",addressId:(pe=b==null?void 0:b.node)!=null&&pe.id?Number(b.node.id):0};z.shippingAddress=L}if(f&&(!(z!=null&&z.billingAddress)||Ue(z,"billingAddress"))){const L={label:((ge=f==null?void 0:f.node)==null?void 0:ge.label)||"",firstName:((_e=f==null?void 0:f.node)==null?void 0:_e.firstName)||"",lastName:((ze=f==null?void 0:f.node)==null?void 0:ze.lastName)||"",companyName:((Oe=f==null?void 0:f.node)==null?void 0:Oe.company)||"",country:((Te=f==null?void 0:f.node)==null?void 0:Te.countryCode)||"",address:((fe=f==null?void 0:f.node)==null?void 0:fe.addressLine1)||"",apartment:((ye=f==null?void 0:f.node)==null?void 0:ye.addressLine2)||"",city:((Ie=f==null?void 0:f.node)==null?void 0:Ie.city)||"",state:((O=f==null?void 0:f.node)==null?void 0:O.state)||"",zipCode:((p=f==null?void 0:f.node)==null?void 0:p.zipCode)||"",phoneNumber:((le=f==null?void 0:f.node)==null?void 0:le.phoneNumber)||"",addressId:(Pe=f==null?void 0:f.node)!=null&&Pe.id?Number(f.node.id):0};z.billingAddress=L}H(ne)}else if(N!==100){const{customerAddresses:{edges:oe=[]}}=await qn(),ne=oe.map(re=>({node:Nn(re.node)}));H(ne)}const ie=await Ln();if(ie.length){Ne(ie);const oe=z.extraFields,ne=ie==null?void 0:ie.map(re=>{var f;const b=((f=oe==null?void 0:oe.find(L=>L.fieldName===re.name))==null?void 0:f.value)||(re==null?void 0:re.default);return{id:Number(re.id),fieldName:re.name,value:b||""}});z.extraFields=ne}z&&(!(z!=null&&z.contactInfo)||Ue(z,"contactInfo"))&&Number(N)!==100?g(z):z&&d(Ke(z))}finally{const ie=C.b2bId||C.id||0;d(un(Number(ie))),t(!1)}})()},[A,ae]);const be=u.useMemo(()=>{const o=a.contactInfo||{};return{info:{quoteTitle:(o==null?void 0:o.quoteTitle)||"",referenceNumber:(a==null?void 0:a.referenceNumber)||""},extraFields:a.extraFields||[],recipients:a.recipients||[]}},[a]),Le=()=>{const o={shippingAddress:gs,billingAddress:ys};return $!=null&&$.current&&(o.billingAddress=$.current.getContactInfoValue()),G!=null&&G.current&&(o.shippingAddress=G.current.getContactInfoValue()),o},Me=async o=>{d(bn(o))},at=async o=>{if(W!=null&&W.current){const g=await W.current.getContactInfoValue();if(!g)return!1;const z=(o==null?void 0:o.recipients)||[];g.ccEmail.trim().length&&(o.recipients=Un(Rn(z,[g.ccEmail]))),o.contactInfo={name:g==null?void 0:g.name,email:g==null?void 0:g.email,companyName:(g==null?void 0:g.companyName)||"",phoneNumber:g==null?void 0:g.phoneNumber,quoteTitle:g==null?void 0:g.quoteTitle},o.referenceNumber=(g==null?void 0:g.referenceNumber)||"";const X=de.map(M=>({id:Number(M.id),fieldName:M.name,value:M.name?g[M.name]:""}));return o.extraFields=X,!0}return!1},Et=async()=>{const o=ke(a);if(W!=null&&W.current&&!await at(o))return;const{shippingAddress:g,billingAddress:z}=Le();o.shippingAddress=g,o.billingAddress=z,Object.keys(o.contactInfo).every(M=>M==="phoneNumber"||M==="companyName"||M==="quoteTitle"?!0:!!o.contactInfo[M])&&(d(Ke(o)),Q(!1))},Qt=()=>{Q(!0)},ot=bs(j,h),rt=()=>{var o;(o=te.current)==null||o.refreshSummary()},At=async o=>{if(E){const g=await In(o,h);return bt(g),g.length>0}return bt(o),!0},Ft=o=>N===100?[]:o.map(g=>({fileUrl:g.fileUrl,fileName:g.fileName,fileType:g.fileType,fileSize:g.fileSize})),_t=()=>{d(gn()),d(yn()),ht.delete("cartToQuoteId")},it=(o,g)=>{const z=o||se,X=g||Ce;z&&(_t(),U("/quoteDetail/".concat(z,"?date=").concat(X),{state:{to:"draft"}}))},ct=async()=>{var o,g,z;if(!r){t(!0);try{const X=ke(a);if(s&&(W!=null&&W.current)&&!await at(X))return;const M=(X==null?void 0:X.contactInfo)||{},Be=(M==null?void 0:M.quoteTitle)||"";"quoteTitle"in M&&delete M.quoteTitle;const Ee=Object.keys(M).every(O=>O==="phoneNumber"||O==="companyName"?!0:M&&!!M[O]);if(Ue(a,"contactInfo")||!Ee){ce.error(h("quoteDraft.addQuoteInfo"));return}if(!m||m.length===0){ce.error(h("quoteDraft.submit"));return}if(!y&&!E&&m.some(p=>{var le;return(le=It(p))==null?void 0:le.name})){ce.error(h("quoteDraft.submit.errorTip"));return}const Qe=((X==null?void 0:X.note)||"").trim().replace(/[\r\n]/g,"\\n"),ve=O=>{const p=ke(O),le=n==null?void 0:n.find(Pe=>Pe.countryCode===p.country);return le&&(p.country=le.countryName),p.address=(O==null?void 0:O.address)||"",p.apartment=(O==null?void 0:O.apartment)||"",p},{shippingAddress:je,billingAddress:qe}=$!=null&&$.current?Le():X,Ae=je?ve(je):{},Fe=qe?ve(qe):{};let pe=0,ge=0;const _e=O=>typeof O=="string"&&O.includes("-")?"".concat(new Date(O).getTime()/1e3):O,ze=m.map(O=>{var b,f;const{node:p}=O,le={...p.productsSearch,selectOptions:(p==null?void 0:p.optionList)||""},ie=st(le,{}).map(L=>({optionId:L.optionId,optionValue:L.fieldType==="date"?_e(L.optionValue):L.optionValue,optionLabel:"".concat(L.valueText),optionName:L.valueLabel,type:(L==null?void 0:L.fieldOriginType)||L.fieldType})).filter(L=>!!L.optionName)||[],oe=(b=p==null?void 0:p.productsSearch)==null?void 0:b.variants;let ne;return Array.isArray(oe)&&(ne=oe.find(L=>L.sku===p.variantSku)),pe+=Number((p==null?void 0:p.basePrice)||0)*Number((p==null?void 0:p.quantity)||0),ge+=Number((p==null?void 0:p.taxPrice)||0)*Number((p==null?void 0:p.quantity)||0),{productId:(f=p==null?void 0:p.productsSearch)==null?void 0:f.id,sku:p.variantSku,basePrice:Number((p==null?void 0:p.basePrice)||0).toFixed(v.decimal_places),discount:"0.00",offeredPrice:Number((p==null?void 0:p.basePrice)||0).toFixed(v.decimal_places),quantity:p.quantity,variantId:ne==null?void 0:ne.variant_id,imageUrl:p.primaryImage,productName:p.productName,options:ie,itemId:Mn()}}),Oe=Ft((a==null?void 0:a.fileInfo)||[]),Te={message:Qe,legalTerms:"",totalAmount:V?pe.toFixed(v.decimal_places):(pe+ge).toFixed(v.decimal_places),grandTotal:pe.toFixed(v.decimal_places),subtotal:pe.toFixed(v.decimal_places),companyId:c?A||P||I:"",storeHash:pn,quoteTitle:Be,discount:"0.00",channelId:mn,userEmail:C.emailAddress,shippingAddress:Ae,billingAddress:Fe,contactInfo:M,productList:ze,fileList:Oe,taxTotal:ge.toFixed(v.decimal_places),currency:{currencyExchangeRate:v.currency_exchange_rate,token:v.token,location:v.token_location,decimalToken:v.decimal_token,decimalPlaces:v.decimal_places,thousandsToken:v.thousands_token,currencyCode:v.currency_code},referenceNumber:"".concat(X.referenceNumber)||"",extraFields:X.extraFields||[],recipients:X.recipients||[]};if(!fn("on-quote-create",Te))throw new Error;const fe=await Tn(Te);if(E&&(z=(g=(o=fe==null?void 0:fe.error)==null?void 0:o.extensions)==null?void 0:g.productValidationErrors)!=null&&z.length){fe.error.extensions.productValidationErrors.forEach(O=>{ce.error(h("quoteDraft.notification.productCannotBeAddedToQuote",{productId:O.productId}))});return}const{quoteCreate:{quote:{id:ye,createdAt:Ie}}}=fe;if(me(ye),xe(Ie),ye){const O=ht.get("cartToQuoteId"),p=xn(O);await hn(p)}K.value==="0"?it(ye,Ie):Y(!0)}catch(X){kt.error(X)}finally{t(!1)}}},zt=()=>{Y(!1),it()},Ot=()=>{let o=Number(N)===100?h("quoteDraft.button.back"):h("quoteDraft.button.backToQuoteLists");return(l==null?void 0:l.quoteBtn)==="open"?o=h("quoteDraft.button.back"):(l==null?void 0:l.quoteBtn)==="add"&&(o=h("quoteDraft.button.backToProduct")),o};return u.useEffect(()=>{if(ee&&_&&$.current){const o=$.current.getContactInfoValue();G.current&&G.current.setShippingInfoValue(o)}},[ee,_]),e.jsxs(cn,{isSpinning:r,children:[e.jsxs(T,{sx:{mb:"60px",width:"100%"},children:[e.jsx(T,{sx:{marginBottom:"10px",width:"fit-content",displayPrint:"none"},children:e.jsxs(T,{sx:{color:"primary.main",cursor:"pointer",display:"flex",alignItems:"center"},onClick:()=>{l!=null&&l.quoteBtn||Number(N)===100?(U("/"),i({isOpen:!1,openUrl:""})):U("/quotes")},children:[e.jsx(zn,{fontSize:"small",sx:{fontSize:"12px",marginRight:"0.5rem"}}),e.jsx("p",{style:{margin:"0"},children:Ot()})]})}),e.jsxs(T,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(T,{sx:{display:"flex",mb:"24px",flexDirection:j?"column":"row",alignItems:j?"flex-start":"center"},children:[e.jsx(w,{component:"h3",sx:{fontSize:"34px",mr:"1rem",mb:j?"1rem":"0",color:ln(B)},children:h("quoteDraft.title.Quote")}),e.jsx(vn,{code:"0"})]}),F&&e.jsx(T,{children:j?e.jsx(T,{sx:{position:"fixed",left:0,bottom:0,background:"#FFF",width:"100%",display:"flex",p:"8px 0",zIndex:100,justifyContent:"center"},children:e.jsx(we,{variant:"contained",size:"small",disabled:r,sx:{height:"38px",width:"90%"},onClick:ct,children:h("quoteDraft.button.submit")})}):e.jsx(we,{variant:"contained",size:"small",disabled:r,sx:{padding:"8px 22px",alignSelf:"center",marginBottom:"24px"},onClick:ct,children:h("quoteDraft.button.submit")})})]}),e.jsxs(T,{children:[!s&&e.jsx(kn,{quoteAndExtraFieldsInfo:be,status:"Draft",contactInfo:a==null?void 0:a.contactInfo,shippingAddress:a==null?void 0:a.shippingAddress,billingAddress:(a==null?void 0:a.billingAddress)||{},handleEditInfoClick:Qt}),s&&e.jsxs(Ye,{flexDirection:"column",children:[e.jsx(ts,{emailAddress:C.emailAddress,info:a==null?void 0:a.contactInfo,referenceNumber:(a==null?void 0:a.referenceNumber)||"",quoteExtraFields:de,extraFieldsDefault:a.extraFields||[],recipients:(a==null?void 0:a.recipients)||[],handleSaveCCEmail:Me,ref:W}),e.jsxs(T,{sx:{display:"flex",mt:j?0:"3rem",flexDirection:j?"column":"row"},children:[e.jsx(yt,{title:h("quoteDraft.section.billing"),info:a==null?void 0:a.billingAddress,addressList:S,pr:j?0:"8px",ref:$,role:N,accountFormFields:ot,shippingSameAsBilling:_,type:"billing",setBillingChange:Z}),e.jsx(yt,{title:h("quoteDraft.section.shipping"),info:a==null?void 0:a.shippingAddress,addressList:S,pl:j?0:"8px",ref:G,role:N,accountFormFields:ot,shippingSameAsBilling:_,type:"shipping",setBillingChange:Z})]}),e.jsx(Ut,{label:h("quoteDraft.checkbox.sameAddressShippingAndBilling"),control:e.jsx(Rt,{checked:_,onChange:o=>{if(q(o.target.checked),$.current){const g=$.current.getContactInfoValue();G.current&&o.target.checked&&G.current.setShippingInfoValue(g)}}}),sx:{mt:2}}),e.jsx(we,{sx:{mt:"20px",mb:"15px"},onClick:Et,variant:"outlined",children:h("quoteDraft.button.saveInfo")})]})]}),e.jsxs(T,{sx:{mt:"20px",display:"flex",flexDirection:j?"column":"row",alignItems:"flex-start"},children:[e.jsx(Ye,{flexDirection:"column",xs:{flexBasis:j?"100%":"680px",flexGrow:2,marginRight:"20px",marginBottom:"20px",boxShadow:"0px 2px 1px -1px rgba(0, 0, 0, 0.2), 0px 1px 1px rgba(0, 0, 0, 0.14), 0px 1px 3px rgba(0, 0, 0, 0.12)",borderRadius:"4px"},children:e.jsx(hs,{updateSummary:rt,total:m.length,items:m})}),e.jsx(Ye,{flexDirection:"column",xs:{flexBasis:j?"100%":"340px",marginBottom:"20px",backgroundColor:"transparent",padding:0,flexGrow:1},children:e.jsxs($t,{spacing:2,sx:{width:"100%"},children:[e.jsx(ls,{ref:te}),e.jsx(Yn,{updateList:rt,addToQuote:At}),e.jsx(wn,{quoteStatus:"Draft"}),N!==100&&e.jsx(Dn,{status:0})]})})]})]}),e.jsx(is,{isOpen:R,onClose:zt,quoteSubmissionResponseInfo:K})]})}export{Ws as default};
//# sourceMappingURL=index-DqHgsY77.js.map
