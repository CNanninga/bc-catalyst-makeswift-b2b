import{j as e,B as x,O as E,al as F,Y as q,a9 as N}from"./mui-DjJKBaL-.js";import{r as d}from"./intl-D34a3Rgg.js";import{u as W}from"./form-pKe_k4Gy.js";import{a6 as U,ao as V,a7 as Y,I as v,j as w,u as S,y as T,ad as H,a2 as X,a as $,af as G,aa as k,ag as J}from"./react-setup-Ctz-bmMs.js";import{B as K}from"./B3CustomForm-BLuJSiae.js";import"./load-functions-utyuqH_X.js";import"./base-CC7kTJh2.js";import{S as L,d as Q,e as Z,g as _,a as ee}from"./shoppingList-5c4DgHH6.js";import{l as te}from"./muiIcon-BBtg8u0V.js";const se=({data:i,isB2BUser:a})=>{var o,l,n;const t=i,c=a?Q:Z;if(a){const p=U({containOrEqual:"contain",code:V.submitShoppingListPermission}),r=((n=(l=(o=Y.getState())==null?void 0:o.company)==null?void 0:l.companyHierarchyInfo)==null?void 0:n.selectCompanyHierarchyId)||0;t.status=p?L.Draft:L.Approved,r&&(t.companyId=r)}else t.channelId=v;return c({...t,channelId:v})},ie=i=>[{name:"name",label:i("global.createShoppingList.name"),required:!0,default:"",fieldType:"text",xs:12,variant:"filled",size:"small",maxLength:200},{name:"description",label:i("global.createShoppingList.description"),required:!1,default:"",fieldType:"multiline",xs:12,variant:"filled",size:"small",rows:4,maxLength:200}];function he({open:i,onChange:a,onClose:t}){const c=d.useRef(null),o=w(),[l,n]=d.useState(!1),p=S(T),{control:r,handleSubmit:m,getValues:h,formState:{errors:C},setValue:b}=W({mode:"onSubmit"}),B=()=>{t()},y=()=>{m(async g=>{const{name:j,description:u}=g;n(!0),await se({data:{name:j,description:u},isB2BUser:p}),n(!1),a()})()};return e.jsxs(x,{sx:{ml:3,cursor:"pointer",width:"50%"},children:[e.jsx(x,{ref:c}),e.jsx(H,{isOpen:i,fullWidth:!0,title:o("global.createShoppingList.createNew"),loading:l,handleLeftClick:B,handRightClick:y,children:e.jsx(x,{sx:{minHeight:"auto",display:"flex",alignItems:"flex-start"},children:e.jsx(K,{formFields:ie(o),errors:C,control:r,getValues:h,setValue:b})})})]})}const f=()=>{};function ge(i){const a=w(),{isOpen:t,dialogTitle:c=a("global.orderShoppingList.confirm"),confirmText:o=a("global.orderShoppingList.ok"),onClose:l=f,onConfirm:n=f,onCreate:p=f,isLoading:r=!1,setLoading:m=f}=i,h=S(T),C=S(({company:s})=>s.customer.role),{submitShoppingListPermission:b}=S(X),B=E(),[y]=$(),g=B.palette.primary.main,[j,u]=d.useState([]),[I,P]=d.useState("");d.useEffect(()=>{if(!t)return;(async()=>{m(!0),u([]);try{const z=b?L.Draft:L.Approved,{edges:D=[]}=h?await _({status:z}):await ee({channelId:v});u(D)}finally{m(!1)}})()},[h,t,C]);const O=()=>{l()},A=()=>{n(I)},M=()=>{p()},R=s=>()=>{P(s.node.id)};return e.jsx(H,{fullWidth:!0,isOpen:t,title:c,disabledSaveBtn:!I,handleLeftClick:O,handRightClick:A,rightSizeBtn:o,children:e.jsxs(G,{isSpinning:r,isFlex:!1,children:[e.jsx(x,{sx:y?{height:"430px"}:{padding:r?"4rem 0":"unset",maxHeight:"430PX"},children:e.jsx(F,{sx:{maxHeight:"400px",width:"100%",overflowY:"auto"},children:j.map(s=>e.jsx(q,{className:I===s.node.id?"active":"",onClick:R(s),sx:{"&:hover":{backgroundColor:k(g,.12)},"&.active":{backgroundColor:k(g,.12)}},children:e.jsx(N,{children:s.node.name})},s.node.id))})}),e.jsxs(J,{variant:"text",onClick:M,sx:{textTransform:"none"},children:[e.jsx(te,{sx:{fontSize:"17px"}})," ".concat(a("global.orderShoppingList.createNew"))]})]})})}export{he as C,ge as O,se as c};
//# sourceMappingURL=OrderShoppingList-qu8HwRgc.js.map
