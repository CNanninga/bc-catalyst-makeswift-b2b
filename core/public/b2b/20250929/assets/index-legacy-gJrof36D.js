System.register(["./mui-legacy-Co1sKVsS.js","./intl-legacy-f5dGU49Z.js","./load-functions-legacy-ksbQXdn-.js","./react-setup-legacy-DEc0vKYV.js","./base-legacy-DAqmyLJs.js","./shoppingList-legacy-CydALIG9.js","./OrderShoppingList-legacy-w3HPSrJA.js","./router-legacy-CQEMCAt4.js","./reactVendor-legacy-C5drotBr.js","./eCache-legacy-QcRlogRO.js","../index-legacy.js","./global-legacy-vVqwfyov.js","./redux-legacy-DH94TLLa.js","./toolkit-legacy-DO7GmFjE.js","./lodashEs-legacy-BTGS6uHg.js","./muiIcon-legacy-C-h6sDde.js","./dropzone-legacy-B1uEXZk9.js","./dateFns-legacy-DHywh9DD.js","./form-legacy-LlvE08FY.js","./B3CustomForm-legacy-lFqWnpvs.js"],function(t,e){"use strict";var n,o,s,i,a,r,c,l,p,u,d,g,m,y,h,L,f,j,S,I,b;return{setters:[t=>{n=t.j},t=>{o=t.r},t=>{s=t.c},t=>{i=t.b9,a=t.j,r=t.u,c=t.aM,l=t.a7,p=t.ba,u=t.bb,d=t.bc,g=t.bd,m=t.be,y=t.G,h=t.y,L=t.bf},null,t=>{f=t.b,j=t.c},t=>{S=t.O,I=t.C},t=>{b=t.a},null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){t({default:function(){const{setOpenPageFn:t,getShoppingListItem:e,addToShoppingList:i}=function(){const{state:{shoppingListClickNode:t}}=o.useContext(y),e=r(({company:t})=>t.customer.customerGroupId),n=r(({global:t})=>t.storeInfo.platform),i=r(({global:t})=>t.setOpenPageFn),a=r(h),c=()=>{if("bigcommerce"!==n)return window.b2b.utils.shoppingList.itemFromCurrentPage[0];if(!t)return;const e=t.closest(s["dom.productView"]);if(!e)return;const o=e.querySelector("input[name=product_id]")?.value,i=e.querySelector('[name="qty[]"]')?.value??1,a=(e.querySelector("[data-product-sku]")?.innerHTML??"").trim(),r=e.querySelector("form[data-cart-item-add]");return{productId:Number(o),sku:a,quantity:Number(i),optionSelections:L(r)}},l=({shoppingListId:t,product:n})=>T({isB2BUser:a,customerGroupId:e,shoppingListId:t,items:[n]});return{setOpenPageFn:i,getShoppingListItem:c,addToShoppingList:l}}(),c=a(),[l,p]=o.useState(!0),[u,d]=o.useState(!1),[g,m]=o.useState(!1),f=C(),j=b(),O=()=>{window.scrollTo(0,0),p(!1),d(!1),j("/"),t?.({isOpen:!1,openUrl:""})},v=()=>{d(!1),p(!0)};return n.jsxs(n.Fragment,{children:[n.jsx(S,{isOpen:l,dialogTitle:c("pdp.addToShoppingList"),onClose:O,onConfirm:async t=>{const n=e();if(n)try{m(!0),await i({shoppingListId:t,product:n}).then(()=>f(t)).catch(w),O()}finally{m(!1)}},onCreate:()=>{p(!1),d(!0)},isLoading:g,setLoading:m}),n.jsx(I,{open:u,onChange:()=>{v(),p(!0)},onClose:v})]})},useAddedToShoppingListAlert:C});class e extends Error{constructor(t){super(t),this.name="ValidationError"}}const w=t("addProductsToShoppingListErrorHandler",t=>{const n=t instanceof e?t.message:"Something went wrong. Please try again.";i.error(n)});function C(){const t=a(),e=r(({global:t})=>t.setOpenPageFn);return n=>{i.success(t("shoppingList.addToShoppingList.productsAdded"),{action:{label:t("pdp.notification.viewShoppingList"),onClick:()=>(t=>e?.({isOpen:!0,openUrl:`/shoppingList/${t}`,params:{shoppingListBtn:"add"}}))(n)}})}}const T=t("addProductsToShoppingList",async({isB2BUser:t,customerGroupId:n,items:o,shoppingListId:s})=>{const{currency_code:i}=c(),{id:a}=l.getState().company.companyInfo,{productsSearch:r}=await p({productIds:o.map(({productId:t})=>t),currencyCode:i,companyId:a,customerGroupId:n}),y=u(r),h=[];for(let c=0;c<y.length;c+=1){const{allOptions:t,variants:n}=y[c],{productId:s,sku:i,variantId:a,quantity:r,optionSelections:l}=o[c],p=a||n.find(t=>t.sku===i)?.variant_id||n[0]?.variant_id,u=l?d(l):[],{isValid:L,message:f}=g(t,u);if(!L)throw new e(f);const j=m(u,y[c]);h.push({productId:s,variantId:p,quantity:r,optionList:j})}const L=t?f:j;await L({shoppingListId:s,items:h})})}}});
//# sourceMappingURL=index-legacy-gJrof36D.js.map
