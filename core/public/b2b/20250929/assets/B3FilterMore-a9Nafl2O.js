import{j as l,B as h,b as Q,O as U,I as O,ac as W,y as X}from"./mui-DjJKBaL-.js";import{r as t}from"./intl-D34a3Rgg.js";import{u as Z}from"./form-pKe_k4Gy.js";import{G as _,cc as $,C as k,l as P,a as ee,j as le,h as R,ad as oe,ag as se}from"./react-setup-Ctz-bmMs.js";import"./load-functions-utyuqH_X.js";import"./base-CC7kTJh2.js";import{s as te,L as ae,A as ne,D as ue,B as re}from"./B3CustomForm-BLuJSiae.js";import{f as ie,s as ce}from"./dateFns-DubixNBV.js";import{F as z}from"./muiIcon-BBtg8u0V.js";const A=(e=0,o="yyyy-MM-dd")=>ie(ce(new Date,e),o);function T({onChange:e,variant:o,value:n,label:i,disableOpenPicker:C=!0,formatInput:b="YYYY-MM-DD",size:j="small"}){const u=t.useRef(null),c=t.useRef(null),{state:{bcLanguage:g}}=t.useContext(_),f=te(g||"en"),[F,x]=t.useState(!1),y=()=>{var s;x(!F),(s=u==null?void 0:u.current)!=null&&s.blur&&u.current.blur()},p=s=>{if(typeof s!="string"){const V=$(s).format(b);e(V)}else e(s)};return l.jsxs(l.Fragment,{children:[l.jsx(h,{ref:c}),l.jsx(ae,{dateAdapter:ne,adapterLocale:f,children:l.jsx(ue,{label:i,DialogProps:{container:c.current},onChange:s=>s&&p(s),onClose:()=>{x(!1)},value:n||null,open:F,inputRef:u,disableOpenPicker:C,renderInput:s=>l.jsx(Q,{...s,size:j,onMouseDown:()=>{y()},variant:o})})})]})}function fe({startPicker:e,endPicker:o,handleChange:n,isMonthlySpacing:i=!1,xs:C={},customWidth:b},j){const[u,c]=t.useState((e==null?void 0:e.defaultValue)||""),[g,f]=t.useState((o==null?void 0:o.defaultValue)||""),F=()=>{c(i?A(30):""),f(i?A():"")};t.useEffect(()=>{c((e==null?void 0:e.defaultValue)||"")},[e==null?void 0:e.defaultValue]),t.useEffect(()=>{f((o==null?void 0:o.defaultValue)||"")},[o==null?void 0:o.defaultValue]);const x=()=>{const s={startValue:u,endValue:g};return e!=null&&e.isEnabled?s:{}};t.useImperativeHandle(j,()=>({setClearPickerValue:F,getPickerValue:x}));const y=s=>{c(s),n&&n((e==null?void 0:e.pickerKey)||"start",s)},p=s=>{f(s),n&&n((o==null?void 0:o.pickerKey)||"end",s)};return l.jsxs(h,{sx:{display:"flex",width:b||"auto"},children:[(e==null?void 0:e.isEnabled)&&l.jsx(h,{sx:{width:"49%",mt:"16px",mr:"1%",cursor:"pointer","& > .MuiFormControl-root":{width:"100%"},...C},children:l.jsx(T,{onChange:y,value:u,label:e==null?void 0:e.label,variant:"filled"})}),(o==null?void 0:o.isEnabled)&&l.jsx(h,{sx:{width:"49%",mt:"16px",ml:"1%","& > .MuiFormControl-root":{width:"100%"},cursor:"pointer",...C},children:l.jsx(T,{onChange:p,value:g,label:o==null?void 0:o.label,variant:"filled"})})]})}const de=t.forwardRef(fe),me=["roleAutocomplete"];function Be({startPicker:e,endPicker:o,filterMoreInfo:n,onChange:i,isShowMore:C=!1,resetFilterInfo:b}){const{state:{portalStyle:{backgroundColor:j="#FEF9F5"}}}=t.useContext(k),u=P(j),[c,g]=t.useState(!1),[f,F]=t.useState(!1),[x,y]=t.useState(0),[p,s]=t.useState(null),V=t.useRef(null),{control:I,handleSubmit:Y,getValues:D,formState:{errors:H},setValue:E}=Z({mode:"onSubmit"}),[w]=ee(),B=le(),G=U().palette.primary.main;t.useEffect(()=>{p&&Object.keys(p).forEach(a=>{E(a,p[a])})},[p,c]);const K=()=>{g(!0)},N=t.useMemo(()=>{if(!x)return 0;const a=D();return n.reduce((d,m)=>{const S=m;return me.includes(S.fieldType)&&a[S.name]&&(d-=1),d},x)},[x]),L=()=>{g(!1)},v=a=>{if(a){const r=[],d=Object.keys(a).every(m=>a[m]==="");Object.keys(a).forEach(m=>{a[m]!==""&&r.push(m)}),F(!d),y(r.length)}},q=a=>{Y(r=>{var m;const d=(m=V.current)==null?void 0:m.getPickerValue();if(i){const S={...d,...r};v(S),i(S),s({...r})}L()})(a)},M=()=>{var a;Object.keys(D()).forEach(r=>{E(r,"")}),b&&b(),(a=V.current)==null||a.setClearPickerValue()},J=()=>{const a=e!=null&&e.isEnabled?{startValue:"",endValue:""}:{};M();const r=D();if(i){const d={...a,...r};v(d),i(d),s({...r})}};return l.jsxs(h,{sx:{ml:3,cursor:"pointer"},children:[(n&&n.length||C)&&l.jsxs(h,{sx:{display:"flex",alignItems:"center"},children:[l.jsxs(h,{onClick:K,children:[!f&&l.jsx(O,{"aria-label":"edit",size:"medium",sx:{color:u,":hover":{backgroundColor:R("#FFFFFF",.1)},"& svg":{width:"32px",height:"32px"}},children:l.jsx(z,{})}),f&&l.jsx(O,{"aria-label":"edit",size:"medium",sx:{color:u,":hover":{backgroundColor:R("#FFFFFF",.1)}},children:l.jsx(W,{badgeContent:N,sx:{"& .MuiBadge-badge.MuiBadge-standard.MuiBadge-anchorOriginTopRight":{bgcolor:G,borderRadius:"50%"}},children:l.jsx(z,{})})})]}),f&&!w&&l.jsx(X,{"aria-label":"clear-edit",size:"small",sx:{marginLeft:"5px",color:"#1976D2"},onClick:J,children:B("global.filter.clearFilters")})]}),l.jsxs(oe,{isOpen:c,leftSizeBtn:B("global.filter.cancel"),rightSizeBtn:B("global.filter.apply"),title:B("global.filter.title"),handleLeftClick:L,handRightClick:q,children:[l.jsxs(h,{sx:{width:w?"100%":"450px"},children:[l.jsx(re,{formFields:n,errors:H,control:I,getValues:D,setValue:E}),l.jsx(de,{ref:V,startPicker:e,endPicker:o})]}),l.jsx(se,{sx:{mt:1},onClick:M,size:"small",children:B("global.filter.clearFilters")})]})]})}export{Be as B,de as a,A as d};
//# sourceMappingURL=B3FilterMore-a9Nafl2O.js.map
