System.register(["./mui-legacy-Co1sKVsS.js","./intl-legacy-f5dGU49Z.js","./B3Filter-legacy-BmtmonFX.js","./react-setup-legacy-D2JRzxdF.js","./load-functions-legacy-rxJ-MsEG.js","./base-legacy-DAqmyLJs.js","./QuoteStatus-legacy-B_p6P32C.js","./shoppingList-legacy-BAOlftiS.js","./useSort-legacy-D3ci4eqa.js","./router-legacy-CQEMCAt4.js","./reactVendor-legacy-C5drotBr.js","./eCache-legacy-QcRlogRO.js","./B3FilterMore-legacy-BZwi3GoI.js","./form-legacy-LlvE08FY.js","./B3CustomForm-legacy-D2p9DUUp.js","./lodashEs-legacy-BTGS6uHg.js","./muiIcon-legacy-C-h6sDde.js","./dateFns-legacy-DHywh9DD.js","./B3FilterSearch-legacy-CpS4so5C.js","./redux-legacy-DH94TLLa.js","./toolkit-legacy-DO7GmFjE.js","../index-legacy.js","./global-legacy-vVqwfyov.js","./dropzone-legacy-B1uEXZk9.js"],function(e,t){"use strict";var a,s,r,l,o,u,n,d,i,c,m,p,y,b,g,q,x,f,A,h,C,j,B,N,k,R,P,I,L;return{setters:[e=>{a=e.O,s=e.j,r=e.A,l=e.ae,o=e.w,u=e.B,n=e.T},e=>{d=e.r},e=>{i=e.B},e=>{c=e.a7,m=e.bs,p=e.aM,y=e.j,b=e.aw,g=e.ay,q=e.a,x=e.G,f=e.af,A=e.am,h=e.u,C=e.y,j=e.bw,B=e.I},null,null,e=>{N=e.Q,k=e.k,R=e.l},e=>{P=e.f},e=>{I=e.u},e=>{L=e.a},null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){e("default",function(){const{getAvailableFilters:e,draftQuoteListLength:t,customer:a,getQuotesList:r}=function(){const e=h(({company:e})=>e.companyInfo.id),t=h(({company:e})=>e.customer),a=h(C),s=h(({quoteInfo:e})=>e.draftQuoteList.length),r=h(({b2bFeatures:e})=>e.masqueradeCompany.id),l=y(),o=e||r,u=e=>a?k({...e,channelId:B}):R({...e,channelId:B}),n=()=>[{name:"status",label:l("quotes.quoteStatus"),required:!1,default:"",fieldType:"dropdown",options:E.map(({idLangCustomLabel:e,...t})=>({customLabel:l(e),...t})),replaceOptions:{label:"customLabel",value:"statusCode"},xs:12,variant:"filled",size:"small"}],d=async()=>{const e=await P(Number(o),2),t=e?.createdByUser?.results?.createdBy.map(e=>({createdBy:e.email?`${e.name} (${e.email})`:`${e.name}`}))||[],a=e?.createdByUser?.results?.salesRep.map(e=>({salesRep:`${e.salesRep||e.salesRepEmail}`}))||[];return[...n(),{name:"createdBy",label:l("quotes.createdBy"),required:!1,default:"",fieldType:"dropdown",options:t,replaceOptions:{label:"createdBy",value:"createdBy"},xs:12,variant:"filled",size:"small"},{name:"salesRep",label:l("quotes.salesRep"),required:!1,default:"",fieldType:"dropdown",options:a,replaceOptions:{label:"salesRep",value:"salesRep"},xs:12,variant:"filled",size:"small"}]},i=async()=>a?d():n();return{companyId:o,isB2BUser:a,draftQuoteListLength:s,customer:t,getQuotesList:u,getAvailableFilters:i}}(),l=Q(),o={q:"",orderBy:`-${D[F]}`,createdBy:"",salesRep:"",status:"",dateCreatedBeginAt:"",dateCreatedEndAt:""},[n,c]=d.useState(o),[m,p]=d.useState(!1),[b,g]=d.useState([]),[j,N,S]=I(D,F,n,c),T=L(),w=y(),[O]=q(),{state:{openAPPParams:U},dispatch:V}=d.useContext(x);d.useEffect(()=>{e().then(e=>g(e)),U.quoteBtn&&V({type:"common",payload:{openAPPParams:{quoteBtn:"",shoppingListBtn:""}}})},[]);const z=(e,t)=>{0===Number(t)?T("/quoteDraft"):T(`/quoteDetail/${e.id}?date=${e.createdAt}`)},M=d.useCallback(async e=>{const{edges:s=[],totalCount:l}=await r(e);if(0===e.offset&&t){const e=$(),t={node:{quoteNumber:"—",quoteTitle:"—",createdAt:"—",salesRepEmail:"—",createdBy:`${a.firstName} ${a.lastName}`,updatedAt:"—",expiredAt:"—",totalAmount:e?.grandTotal,status:0,taxTotal:e?.tax}},{status:r,createdBy:l,salesRep:o,dateCreatedBeginAt:u,dateCreatedEndAt:d}=n,i=!(r||o||u||d);if(l&&i){const e=/^[^(]+/.exec(l);(e?.length?e[0].trim():"")===t.node.createdBy&&s.unshift(t)}else i&&s.unshift(t)}return{edges:s,totalCount:l}},[r,t,a.firstName,a.lastName,n]);return s.jsx(f,{isSpinning:m,children:s.jsxs(u,{sx:{display:"flex",flexDirection:"column",flex:1},children:[s.jsx(i,{filterMoreInfo:b,startPicker:{isEnabled:!0,label:w("quotes.from"),defaultValue:n?.dateCreatedBeginAt||"",pickerKey:"start"},endPicker:{isEnabled:!0,label:w("quotes.to"),defaultValue:n?.dateCreatedEndAt||"",pickerKey:"end"},handleChange:(e,t)=>{"search"===e&&c({...n,q:t})},handleFilterChange:e=>{const t={createdBy:e?.createdBy||"",status:e?.status||"",salesRep:e?.salesRep||"",dateCreatedBeginAt:e?.startValue||"",dateCreatedEndAt:e?.endValue||""};c({...n,...t})}}),s.jsx(A,{columnItems:l,rowsPerPageOptions:[10,20,30],getRequestList:M,searchParams:n,isCustomRender:!1,requestLoading:p,tableKey:"quoteNumber",sortDirection:N,orderBy:S,sortByFn:j,labelRowsPerPage:w(O?"quotes.cardsPerPage":"quotes.quotesPerPage"),renderItem:e=>s.jsx(v,{item:e,goToDetail:z}),onClickRow:e=>{z(e,Number(e.status))},hover:!0})]})})});const t={subtotal:0,shipping:0,tax:0,grandTotal:0},{decimal_places:S=2}=p(),T=e=>parseFloat(e.toFixed(S)),$=()=>{const{draftQuoteList:e}=c.getState().quoteInfo,{showInclusiveTaxPrice:a}=c.getState().global;return e.reduce((e,t)=>{const{basePrice:s,taxPrice:r=0,quantity:l,additionalCalculatedPrices:o=[]}=t.node;let{subtotal:u,grandTotal:n,tax:d}=e;const{shipping:i}=e;let c=0,p=0;return o.forEach(e=>{c+=e.additionalCalculatedPriceTax,p+=e.additionalCalculatedPrice}),u+=T(m(Number(s)+p,Number(r))*l),d+=T((Number(r)+c)*l),n=a?u+i:u+i+d,{grandTotal:n,shipping:i,tax:d,subtotal:u}},{...t})},w=o("div")({display:"flex",flexDirection:"column",alignItems:"start",marginBottom:"1rem"});function v(e){const{item:t,goToDetail:o}=e,d=a(),i=y(),c=d.palette.primary.main,m=[{key:"quoteTitle",title:i("quotes.quoteItemCard.title")},{key:"salesRepEmail",title:i("quotes.quoteItemCard.salesRep")},{key:"createdBy",title:i("quotes.quoteItemCard.createdBy")},{key:"createdAt",title:i("quotes.quoteItemCard.dateCreated"),render:()=>`${0!==Number(t.status)?b(Number(t.createdAt)):t.createdAt}`},{key:"updatedAt",title:i("quotes.quoteItemCard.lastUpdate"),render:()=>`${0!==Number(t.status)?b(Number(t.updatedAt)):t.updatedAt}`},{key:"expiredAt",title:i("quotes.quoteItemCard.expirationDate"),render:()=>`${0!==Number(t.status)?b(Number(t.expiredAt)):t.expiredAt}`},{key:"totalAmount",title:i("quotes.quoteItemCard.subtotal"),render:()=>{const{totalAmount:e}=t;return g(Number(e))}}];return s.jsx(r,{children:s.jsxs(l,{sx:{color:"rgba(0, 0, 0, 0.6)"},children:[s.jsxs(w,{children:[s.jsx(u,{sx:{display:"flex",alignItems:"center",mb:"1rem"},children:s.jsx(n,{variant:"h6",sx:{color:"rgba(0, 0, 0, 0.87)"},children:t.quoteNumber})}),s.jsx(u,{children:s.jsx(N,{code:t.status})})]}),m.map(e=>s.jsxs(u,{sx:{display:"flex"},children:[s.jsx(n,{sx:{fontWeight:"bold",color:"rgba(0, 0, 0, 0.87)",mr:"5px",whiteSpace:"nowrap"},children:`${e.title}:`}),s.jsx(n,{sx:{color:"black",wordBreak:"break-all"},children:e?.render?e.render():t[e.key]})]},e.key)),s.jsx(u,{onClick:()=>o(t,Number(t.status)),sx:{mt:"1rem",pl:0,color:c||"#1976D2",cursor:"pointer",fontWeight:"bold",display:"inline-block"},children:i("quotes.quoteItemCard.view")})]})})}const E=[{idLangCustomLabel:"quotes.open",statusCode:1},{idLangCustomLabel:"quotes.ordered",statusCode:4},{idLangCustomLabel:"quotes.expired",statusCode:5}],F="quoteNumber",D={quoteNumber:"quoteNumber",quoteTitle:"quoteTitle",salesRep:"salesRep",createdBy:"createdBy",createdAt:"createdAt",updatedAt:"updatedAt",expiredAt:"expiredAt",status:"status"},Q=()=>{const e=y();return d.useMemo(()=>[{key:"quoteNumber",title:e("quotes.quoteNumber"),isSortable:!0},{key:"quoteTitle",title:e("quotes.title"),isSortable:!0},{key:"salesRep",title:e("quotes.salesRep"),render:e=>`${e.salesRep||e.salesRepEmail}`,isSortable:!0},{key:"createdBy",title:e("quotes.createdBy"),isSortable:!0},{key:"createdAt",title:e("quotes.dateCreated"),render:e=>`${0!==Number(e.status)?b(Number(e.createdAt)):e.createdAt}`,isSortable:!0},{key:"updatedAt",title:e("quotes.lastUpdate"),render:e=>`${0!==Number(e.status)?b(Number(e.updatedAt)):e.updatedAt}`,isSortable:!0},{key:"expiredAt",title:e("quotes.expirationDate"),render:e=>`${0!==Number(e.status)?b(Number(e.expiredAt)):e.expiredAt}`,isSortable:!0},{key:"totalAmount",title:e("quotes.subtotal"),render:e=>{const{totalAmount:t,currency:a}=e,s=a;return j(Number(t),{currency:s,isConversionRate:!1,useCurrentCurrency:!!a})},style:{textAlign:"right"}},{key:"status",title:e("quotes.status"),render:e=>s.jsx(N,{code:e.status}),isSortable:!0}],[e])}}}});
//# sourceMappingURL=index-legacy-Cz4KXLrQ.js.map
