{"version":3,"file":"index-BIgyDGab.js","sources":["../../src/pages/InvoicePayment/index.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { Box } from '@mui/material';\n\nimport { Loading } from '@/components';\nimport B3Dialog from '@/components/B3Dialog';\nimport { useB3Lang } from '@/lib/lang';\nimport { getInvoiceDetail } from '@/shared/service/b2b';\nimport { useAppSelector } from '@/store';\nimport { snackbar } from '@/utils';\n\nimport { gotoInvoiceCheckoutUrl } from '../Invoice/utils/payment';\n\nfunction Payment() {\n  const platform = useAppSelector(({ global }) => global.storeInfo.platform);\n  const B2BToken = useAppSelector(({ company }) => company.tokens.B2BToken);\n\n  const [loading, setLoading] = useState<boolean>(false);\n\n  const [open, setOpen] = useState<boolean>(false);\n\n  const params = useParams();\n\n  const navigate = useNavigate();\n\n  const b3Lang = useB3Lang();\n\n  useEffect(() => {\n    const init = async () => {\n      setLoading(true);\n\n      if (!B2BToken) {\n        setOpen(true);\n        setLoading(false);\n        return;\n      }\n\n      if (!params?.id) {\n        snackbar.error(b3Lang('payment.errorInvoiceCantBeBlank'));\n      }\n\n      if (params?.id) {\n        try {\n          const {\n            invoice: {\n              openBalance: { code = '', value = '' },\n            },\n          } = await getInvoiceDetail(Number(params.id));\n\n          if (!code || !value) {\n            snackbar.error(b3Lang('payment.errorOpenBalanceIsIncorrect'));\n          }\n\n          const data = {\n            lineItems: [\n              {\n                invoiceId: Number(params.id),\n                amount: value,\n              },\n            ],\n            currency: code,\n          };\n\n          await gotoInvoiceCheckoutUrl(data, platform, true);\n        } catch (error: unknown) {\n          snackbar.error(\n            (error as CustomFieldItems)?.message || b3Lang('payment.invoiceDoesNotExist'),\n          );\n        } finally {\n          setLoading(false);\n        }\n      }\n    };\n\n    init();\n  }, [platform, params.id, B2BToken, b3Lang]);\n\n  const handleConfirm = () => {\n    navigate('/login');\n  };\n\n  return (\n    <Box>\n      {loading && <Loading backColor=\"#FFFFFF\" />}\n      <B3Dialog\n        isOpen={open}\n        fullWidth\n        title=\"\"\n        rightSizeBtn=\"ok\"\n        showLeftBtn={false}\n        handRightClick={handleConfirm}\n      >\n        <Box\n          sx={{\n            height: '200px',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            flexDirection: 'column',\n          }}\n        >\n          <Box>\n            <Box\n              sx={{\n                mb: '10px',\n              }}\n            >\n              {b3Lang('payment.firstLoginToPay')}\n            </Box>\n            <Box>{b3Lang('payment.clickToLandingPage')}</Box>\n          </Box>\n        </Box>\n      </B3Dialog>\n    </Box>\n  );\n}\n\nexport default Payment;\n"],"names":["Payment","platform","useAppSelector","global","B2BToken","company","loading","setLoading","useState","open","setOpen","params","useParams","navigate","useNavigate","b3Lang","useB3Lang","useEffect","snackbar","code","value","getInvoiceDetail","data","gotoInvoiceCheckoutUrl","error","handleConfirm","Box","jsx","Loading","B3Dialog"],"mappings":"uoBAaA,SAASA,GAAU,CACjB,MAAMC,EAAWC,EAAe,CAAC,CAAE,OAAAC,KAAaA,EAAO,UAAU,QAAQ,EACnEC,EAAWF,EAAe,CAAC,CAAE,QAAAG,KAAcA,EAAQ,OAAO,QAAQ,EAElE,CAACC,EAASC,CAAU,EAAIC,EAAAA,SAAkB,EAAK,EAE/C,CAACC,EAAMC,CAAO,EAAIF,EAAAA,SAAkB,EAAK,EAEzCG,EAASC,EAAA,EAETC,EAAWC,EAAA,EAEXC,EAASC,EAAA,EAEfC,EAAAA,UAAU,IAAM,EACD,SAAY,CAGvB,GAFAV,EAAW,EAAI,EAEX,CAACH,EAAU,CACbM,EAAQ,EAAI,EACZH,EAAW,EAAK,EAChB,MACF,CAMA,GAJKI,GAAA,MAAAA,EAAQ,IACXO,EAAS,MAAMH,EAAO,iCAAiC,CAAC,EAGtDJ,GAAA,MAAAA,EAAQ,GACV,GAAI,CACF,KAAM,CACJ,QAAS,CACP,YAAa,CAAE,KAAAQ,EAAO,GAAI,MAAAC,EAAQ,EAAA,CAAG,CACvC,EACE,MAAMC,EAAiB,OAAOV,EAAO,EAAE,CAAC,GAExC,CAACQ,GAAQ,CAACC,IACZF,EAAS,MAAMH,EAAO,qCAAqC,CAAC,EAG9D,MAAMO,EAAO,CACX,UAAW,CACT,CACE,UAAW,OAAOX,EAAO,EAAE,EAC3B,OAAQS,CAAA,CACV,EAEF,SAAUD,CAAA,EAGZ,MAAMI,EAAuBD,EAAMrB,EAAU,EAAI,CACnD,OAASuB,EAAgB,CACvBN,EAAS,OACNM,GAAA,YAAAA,EAA4B,UAAWT,EAAO,6BAA6B,CAAA,CAEhF,QAAA,CACER,EAAW,EAAK,CAClB,CAEJ,GAEA,CACF,EAAG,CAACN,EAAUU,EAAO,GAAIP,EAAUW,CAAM,CAAC,EAE1C,MAAMU,EAAgB,IAAM,CAC1BZ,EAAS,QAAQ,CACnB,EAEA,cACGa,EAAA,CACE,SAAA,CAAApB,GAAWqB,EAAAA,IAACC,EAAA,CAAQ,UAAU,SAAA,CAAU,EACzCD,EAAAA,IAACE,EAAA,CACC,OAAQpB,EACR,UAAS,GACT,MAAM,GACN,aAAa,KACb,YAAa,GACb,eAAgBgB,EAEhB,SAAAE,EAAAA,IAACD,EAAA,CACC,GAAI,CACF,OAAQ,QACR,QAAS,OACT,WAAY,SACZ,eAAgB,SAChB,cAAe,QAAA,EAGjB,gBAACA,EAAA,CACC,SAAA,CAAAC,EAAAA,IAACD,EAAA,CACC,GAAI,CACF,GAAI,MAAA,EAGL,WAAO,yBAAyB,CAAA,CAAA,EAEnCC,EAAAA,IAACD,EAAA,CAAK,SAAAX,EAAO,4BAA4B,CAAA,CAAE,CAAA,CAAA,CAC7C,CAAA,CAAA,CACF,CAAA,CACF,EACF,CAEJ"}