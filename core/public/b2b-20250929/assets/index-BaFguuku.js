import{j as t,B as j,ae as Ht,s as _t,T as st,b as Lt,ad as le,G as gt,X as pe,Y as he,w as wt,ah as Qt,ag as Jt,A as fe}from"./mui-DjJKBaL-.js";import{r as f}from"./intl-D34a3Rgg.js";import{a7 as Yt,B as me,j as mt,aN as Bt,ay as Et,aw as Xt,u as J,a as Ct,bg as Zt,af as It,am as ge,bh as xe,ba as Ot,bb as Rt,ak as v,bi as ye,G as be,bj as Mt,a2 as te,ag as kt,bk as ke,bl as Se,bm as qt,be as Pe,aP as At,bn as zt,a4 as Ft,bo as Ie,aO as Ce,bp as ve,bq as Oe,ad as ee,br as Le,bs as we,aS as je,bt as qe,y as Ae}from"./react-setup-B5wPcSA9.js";import"./load-functions-DCmK5p8C.js";import{b as Tt}from"./base-CC7kTJh2.js";import{b as se}from"./b2bGetVariantImageByVariantInfo-BskJ2qQo.js";import{d as Pt,B as Te,a as Ne}from"./B3FilterMore-CBogUOsZ.js";import{e as _e,u as Be,g as Ee}from"./lodashEs-CONzB2I0.js";import{u as Ve}from"./useSort-57pG6e8y.js";import{B as De}from"./B3FilterSearch-DNW83fPo.js";import{b as Qe,c as Fe}from"./shoppingList-t_D6w66q.js";import{b as Nt}from"./b3TriggerCartNumber-CvwG9-_U.js";import{v as ne,S as Re}from"./ShoppingListDetailsContext-FeeOVAR0.js";import{O as Me,C as $e}from"./OrderShoppingList-DWTsHiKm.js";import{a as ze}from"./router-DcuTQ_yx.js";import{c as Ue,k as re,U as We}from"./muiIcon-BBtg8u0V.js";import{u as $t}from"./useBlockPendingAccountViewPrice-ELS6NbDl.js";import{u as oe}from"./form-pKe_k4Gy.js";import{B as ae}from"./B3CustomForm-B2g91-rz.js";import"./reactVendor-CkUTLE5B.js";import"./eCache-97HTO8co.js";import"./redux-Bt5-tVzx.js";import"./toolkit-CpEbzTSY.js";import"../index.js";import"./global-D7Yn0gGb.js";import"./dropzone-B1UJxEDf.js";import"./dateFns-DubixNBV.js";const ie=(g,e,C)=>{const{global:{showInclusiveTaxPrice:b}}=Yt.getState(),n=g.find(I=>Number(I.variant_id)===e||C===I.sku);if(n&&!_e(n)){const I=n.bc_calculated_price;return Number(b?I.tax_inclusive:I.tax_exclusive)}return!1},Ge=g=>'\nquery RecentlyOrderedProducts {\n  orderedProducts (\n    q: "'.concat(g.q||"",'"\n    first: ').concat(g.first,"\n    offset: ").concat(g.offset,'\n    beginDateAt: "').concat(g.beginDateAt,'"\n    endDateAt: "').concat(g.endDateAt,'"\n    orderBy: "').concat((g==null?void 0:g.orderBy)||"",'"\n  ){\n    totalCount,\n    pageInfo{\n      hasNextPage,\n      hasPreviousPage,\n    },\n    edges{\n      node {\n        id,\n        createdAt,\n        updatedAt,\n        productName,\n        productBrandName,\n        variantSku,\n        productId,\n        variantId,\n        optionList,\n        orderedTimes,\n        firstOrderedAt,\n        lastOrderedAt,\n        lastOrderedItems,\n        sku,\n        lastOrdered,\n        imageUrl,\n        baseSku,\n        basePrice,\n        discount,\n        tax,\n        enteredInclusive,\n        productUrl,\n        optionSelections,\n      }\n    }\n  }\n}'),Ke=g=>me.graphqlB2B({query:Ge(g)}),He=_t("img")(()=>({maxWidth:"60px",height:"auto",marginRight:"0.5rem"}));function Je(g){const{item:e,checkBox:C,handleUpdateProductQty:b}=g,n=mt(),{quantity:I,imageUrl:u,productName:i,variantSku:q,optionList:V,basePrice:W,lastOrderedAt:nt,variantId:Y,productsSearch:T}=e,O=Number(W)*Number(I),l=T.variants||[],K=se(l,{variantId:Y})||u;return t.jsx(j,{sx:{borderTop:"1px solid #D9DCE9"},children:t.jsxs(Ht,{sx:{color:"#313440",display:"flex",pl:0},children:[t.jsx(j,{children:C&&C()}),t.jsx(j,{children:t.jsx(He,{src:K||Bt,alt:"Product-img",loading:"lazy"})}),t.jsxs(j,{sx:{flex:1},children:[t.jsx(st,{variant:"body1",color:"#212121",children:i}),t.jsx(st,{variant:"body1",color:"#616161",children:q}),t.jsx(j,{sx:{margin:"1rem 0"},children:V.length>0&&t.jsx(j,{children:V.map($=>t.jsx(st,{sx:{fontSize:"0.75rem",lineHeight:"1.5",color:"#455A64"},children:"".concat($.display_name,": ").concat($.display_value)},$.display_name))})}),t.jsx(st,{sx:{fontSize:"14px"},children:n("purchasedProducts.quickOrderCard.price",{price:Et(O)})}),t.jsx(j,{sx:{"& label":{zIndex:0}},children:t.jsx(Lt,{size:"small",type:"number",variant:"filled",label:"Qty",inputProps:{inputMode:"numeric",pattern:"[0-9]*"},value:I,sx:{margin:"1rem 0",width:"60%",maxWidth:"100px","& label":{fontSize:"14px"},"& input":{fontSize:"14px"}},onChange:$=>{b(e.id,$.target.value)}})}),t.jsx(st,{sx:{fontSize:"14px"},children:n("purchasedProducts.quickOrderCard.lastOrdered",{lastOrderedAt:Xt(nt)})})]})]})},e.id)}const Ye=_t("img")(()=>({maxWidth:"60px",height:"auto",marginRight:"0.5rem"})),Xe=_t(j)(()=>({display:"flex",flexDirection:"column",width:"100%","& tbody":{"& tr":{"& td":{verticalAlign:"top"},"& td: first-of-type":{paddingTop:"25px"}}}})),Ze=_t(Lt)(()=>({"& input":{paddingTop:"12px",paddingRight:"6px"}})),Ut="lastOrderedAt",Wt={product:"productName",lastOrderedAt:"lastOrderedAt"};function ts({setIsRequestLoading:g,setCheckedArr:e,isRequestLoading:C}){const b=f.useRef(null),n=J(({company:r})=>r.companyInfo.id),I=J(({company:r})=>r.customer.customerGroupId),[u,i]=f.useState({q:"",beginDateAt:Pt(90),endDateAt:Pt(0),orderBy:"-".concat(Wt[Ut])}),[q,V,W]=Ve(Wt,Ut,u,i),[nt,Y]=f.useState(0),[T]=Ct(),O=mt(),{currency_code:l}=J(Zt),K=async r=>{if(r.length>0){const p=[];r.forEach(h=>{const{node:S}=h;S.quantity=1,p.includes(S.productId)||p.push(S.productId)});try{const{productsSearch:h}=await Ot({productIds:p,currencyCode:l,companyId:n,customerGroupId:I}),S=Rt(h);return r.forEach(s=>{const{node:c}=s,k=S.find(m=>{const{id:o}=m;return Number(c.productId)===Number(o)});c.productsSearch=k||{}}),r}catch(h){v.error(h)}}return[]},$=async r=>{const{orderedProducts:{edges:p,totalCount:h}}=await Ke(r),S=await K(p);return Y(h),{edges:S,totalCount:h}},F=async r=>{i({...u,q:r})},R=r=>{var p;if(r.length>0){const h=((p=b.current)==null?void 0:p.getCacheList())||[],S=r.reduce((s,c)=>{const k=h.find(m=>{const{node:o}=m;return o.id===c});return k&&s.push(k),s},[]);e([...S])}else e([])},tt=(r,p)=>{const h={...u};r==="start"?h.beginDateAt=p||Pt(90):h.endDateAt=p||Pt(0),i(h)},_=r=>{const p={...u};p.beginDateAt=r.startValue,p.endDateAt=r.endValue,i(p)},B=(r,p)=>{var k,m,o,L;if(p!==""&&Number(p)<=0)return;const h=((k=b.current)==null?void 0:k.getList())||[],S=((m=b.current)==null?void 0:m.getCacheList())||[],s=h==null?void 0:h.map(N=>{const{node:D}=N;return(D==null?void 0:D.id)===r&&(D.quantity=Number(p)||""),N}),c=S==null?void 0:S.map(N=>{const{node:D}=N;return(D==null?void 0:D.id)===r&&(D.quantity=Number(p)||""),N});(o=b.current)==null||o.setList([...s]),(L=b.current)==null||L.setCacheAllList([...c])},et=(r,p)=>{const{productsSearch:{isPriceHidden:h}}=p;return h?"":xe({price:r,productInfo:p,showText:h?"":r,forcedSkip:!0})},M=r=>{var S;const p=((S=b.current)==null?void 0:S.getCacheList())||[];let h=r.quantity;if(p.length>0){const s=p.find(c=>c.node.variantId===r.variantId&&c.node.productId===r.productId&&c.node.id===r.id);s&&s.node&&(h=s.node.quantity||h)}return h},rt=[{key:"product",title:O("purchasedProducts.product"),render:r=>{const{optionList:p,productsSearch:h,variantId:S}=r,s=h.variants||[],c=se(s,{variantId:S})||r.imageUrl;return t.jsxs(j,{sx:{display:"flex",alignItems:"flex-start"},children:[t.jsx(Ye,{src:c||Bt,alt:"Product-img",loading:"lazy"}),t.jsxs(j,{children:[t.jsx(st,{variant:"body1",color:"#212121",children:r.productName}),t.jsx(st,{variant:"body1",color:"#616161",children:r.variantSku}),p.length>0&&t.jsx(j,{children:p.map(k=>t.jsx(st,{sx:{fontSize:"0.75rem",lineHeight:"1.5",color:"#455A64"},children:"".concat(k.display_name,": ").concat(k.display_value)},k.id))})]})]})},width:"40%",isSortable:!0},{key:"price",title:O("purchasedProducts.price"),render:r=>{const{productsSearch:{variants:p},variantId:h,basePrice:S}=r;let s=Number(S);p!=null&&p.length&&(s=ie(p,Number(h))||Number(S));const c=M(r),m=(s||Number(S))*Number(c);return t.jsx(st,{sx:{padding:"12px 0"},children:"".concat(et(Et(m),r))})},width:"15%",style:{textAlign:"right"}},{key:"qty",title:O("purchasedProducts.qty"),render:r=>{const p=M(r);return t.jsx(Ze,{size:"small",type:"number",variant:"filled",value:p,inputProps:{inputMode:"numeric",pattern:"[0-9]*"},onChange:h=>{B(r.id,h.target.value)}})},width:"15%",style:{textAlign:"right"}},{key:"lastOrderedAt",title:O("purchasedProducts.lastOrdered"),render:r=>t.jsx(j,{children:t.jsx(st,{sx:{padding:"12px 0"},children:"".concat(Xt(Number(r.lastOrderedAt)))})}),width:"15%",style:{textAlign:"right"},isSortable:!0}];return t.jsx(It,{isSpinning:C,children:t.jsxs(Xe,{children:[t.jsx(st,{sx:{fontSize:"24px",height:"50px"},children:O("purchasedProducts.totalProducts",{total:nt})}),t.jsxs(j,{sx:{marginBottom:"5px",display:"flex","& label":{zIndex:0}},children:[t.jsxs(j,{sx:{width:T?"100%":"40%",mr:"20px",display:"flex",justifyContent:T?"space-between":"flex-start"},children:[t.jsx(De,{h:"48px",searchBGColor:"rgba(0, 0, 0, 0.06)",handleChange:r=>{F(r)}}),T&&t.jsx(j,{sx:{display:"flex",alignItems:"center"},children:t.jsx(Te,{filterMoreInfo:[],startPicker:{isEnabled:!0,label:O("purchasedProducts.from"),defaultValue:(u==null?void 0:u.beginDateAt)||"",pickerKey:"start"},endPicker:{isEnabled:!0,label:O("purchasedProducts.to"),defaultValue:(u==null?void 0:u.endDateAt)||"",pickerKey:"end"},isShowMore:!0,onChange:_})})]}),!T&&t.jsx(Ne,{handleChange:tt,xs:{mt:0,height:"50px"},startPicker:{isEnabled:!0,label:O("purchasedProducts.from"),defaultValue:Pt(90),pickerKey:"start"},endPicker:{isEnabled:!0,label:O("purchasedProducts.to"),defaultValue:Pt(),pickerKey:"end"},customWidth:"58%"})]}),t.jsx(ge,{ref:b,columnItems:rt,rowsPerPageOptions:[12,24,36],getRequestList:$,searchParams:u,isCustomRender:!1,showCheckbox:!0,showSelectAllCheckbox:!0,disableCheckbox:!1,hover:!0,labelRowsPerPage:O("purchasedProducts.itemsPerPage"),showBorder:!1,requestLoading:g,getSelectCheckbox:R,itemIsMobileSpacing:0,isSelectOtherPageCheckbox:!0,noDataText:O("purchasedProducts.noProductsFound"),sortDirection:V,orderBy:W,sortByFn:q,renderItem:(r,p,h)=>t.jsx(Je,{item:r,checkBox:h,handleUpdateProductQty:B})})]})})}const es=(g,e)=>{var K,$;const{variantId:C,variants:b,inventoryLevel:n,inventoryTracking:I,orderQuantityMaximum:u,orderQuantityMinimum:i,quantity:q,sku:V}=g,W=(($=(K=Yt.getState().global)==null?void 0:K.blockPendingQuoteNonPurchasableOOS)==null?void 0:$.isEnableProduct)||!1,nt=I!=="none";let Y=!1,T=n,O=V;const l=b.find(F=>Number(F.variant_id)===Number(C));return l&&(Y=l.purchasing_disabled,T=I==="variant"?l.inventory_level:T,O=l.sku||V),Y&&!W?(v.error(e("purchasedProducts.quickOrderPad.notPurchaseableSku",{notPurchaseSku:O})),{isVerify:!1,type:"notPurchaseableSku"}):nt&&Number(q)>Number(T)?(v.error(e("purchasedProducts.quickOrderPad.insufficientStockSku",{sku:O})),{isVerify:!1,type:"insufficientStockSku"}):Number(i)>0&&Number(q)<i?(v.error(e("purchasedProducts.quickOrderPad.minQuantityMessage",{minQuantity:i,sku:O})),{isVerify:!1,type:"minQuantity"}):Number(u)>0&&Number(q)>Number(u)?(v.error(e("purchasedProducts.quickOrderPad.maxQuantityMessage",{maxQuantity:u,sku:O})),{isVerify:!1,type:"maxQuantity"}):{isVerify:!0}},ce=async()=>{const{data:{site:{cart:g}}}=await ye();if(g){const{lineItems:e}=g;return Object.values(e).reduce((C,b)=>(b.forEach(n=>{C.push(n)}),C),[])}return[]},de=async(g,e)=>{const C=await ce();return g.reduce((n,I)=>{var q;const{node:u}=I,i=((q=C.find(V=>V.sku===(u==null?void 0:u.sku)&&Number((V==null?void 0:V.variantEntityId)||0)===Number((u==null?void 0:u.variantId)||0)))==null?void 0:q.quantity)||0;return n.push({...u==null?void 0:u.productsSearch,variantId:u==null?void 0:u.variantId,quantity:((u==null?void 0:u.quantity)||0)+i}),n},[]).every(n=>es(n,e).isVerify)};function ss(g){const{checkedArr:e,isAgenting:C,setIsRequestLoading:b,isB2BUser:n}=g,{state:{productQuoteEnabled:I=!1,shoppingListEnabled:u=!1}}=f.useContext(be),i=mt(),q=Mt(),V=J(d=>d.company.companyInfo.id),{currency_code:W}=J(Zt),{purchasabilityPermission:nt}=J(te),Y=q["B2B-3318.move_stock_and_backorder_validation_to_backend"],T=n?nt:!0,O=le("(min-width:1775px)"),[l]=Ct(),K=f.useRef(null),[$,F]=f.useState(!1),[R,tt]=f.useState(0),[_,B]=f.useState(!1),[et,M]=f.useState(!1),[rt,r]=f.useState(!1),p=J(d=>d.company.customer.customerGroupId),h=ze(),S=l?{alignItems:"flex-start",flexDirection:"column"}:{alignItems:"center"},s=()=>{e.length===0?v.error(i("purchasedProducts.error.selectOneItem")):F(!0)},c=()=>{F(!1)},k=d=>{const A=[];return e.forEach(X=>{const{node:H}=X,ot=d.find(E=>Number(H.productId)===E.id);if(ot){const{variants:E}=ot;if(E.length>0){const a=E.find(x=>H.variantSku===x.sku&&Number(H.variantId)===Number(x.variant_id));if(a){const{optionList:x,quantity:P}=H,y=x.map(w=>({optionId:w.product_option_id,optionValue:w.value}));A.push({optionSelections:y,allOptions:x,productId:parseInt(a.product_id,10)||0,quantity:P,variantId:parseInt(a.variant_id,10)||0})}}}}),A},m=()=>{v.success(i("purchasedProducts.footer.productsAdded"),{action:{label:i("purchasedProducts.footer.viewCart"),onClick:()=>{window.b2b.callbacks.dispatchEvent("on-click-cart-button")&&(window.location.href=Ft)}}})},o=async d=>{try{if(!await de(e,i))return;const X=V,{productsSearch:H}=await Ot({productIds:d,companyId:X,customerGroupId:p}),ot=k(H||[]),E=await At(ot);E&&!E.errors?m():E&&E.errors?v.error(E.errors[0].message):v.error("Error has occurred")}finally{Nt(),b(!1)}},L=async()=>{try{const d=e.map(({node:A})=>({productId:Number(A.productId),variantId:Number(A.variantId),quantity:A.quantity,optionSelections:A.optionSelections,allOptions:A.optionList}));await At(d),m()}catch(d){d instanceof Error&&v.error(d.message)}finally{Nt(),b(!1)}},N=async()=>{b(!0),c();const d=Be(e.map(({node:A})=>Number(A.productId)));if(d.length===0){v.error(i("purchasedProducts.footer.selectOneItemToAdd"));return}Y?L():o(d)},D=d=>(d==null?void 0:d.length)===0?[]:d.map(({product_option_id:X,value:H})=>({optionId:"attribute[".concat(X,"]"),optionValue:H})),it=async d=>{if(q["B2B-3318.move_stock_and_backorder_validation_to_backend"]){const A=await ne(d,i);return zt(A),A.length>0}return zt(d),!0},G=async()=>{b(!0),c();try{const d=e.filter(y=>{const{node:{variantSku:w}}=y;return w!==""&&w!==null&&w!==void 0}),A=e.filter(y=>{const{node:{variantSku:w}}=y;return!w});if(A.length>0&&v.error(i("purchasedProducts.footer.cantAddProductsNoSku")),A.length===e.length)return;const X=[];d.forEach(y=>{const{node:w}=y;X.includes(Number(w.productId))||X.push(Number(w.productId))});const{productsSearch:H}=await Ot({productIds:X,companyId:V,customerGroupId:p,currencyCode:W}),ot=Rt(H);let E="",a=!0;const x=[];d.forEach(y=>{const{node:{basePrice:w,optionList:at,variantSku:Q,productId:Z,productName:xt,quantity:yt,variantId:ut,tax:St}}=y,vt=D(at),jt=ot.find(Vt=>Number(Vt.id)===Number(Z)),bt=jt==null?void 0:jt.variants.find(Vt=>Vt.sku===Q);bt||(E=i("purchasedProducts.footer.notFoundSku",{sku:Q}),a=!1);const ue={node:{id:ke(),variantSku:(bt==null?void 0:bt.sku)||Q,variantId:ut,productsSearch:{...jt,newSelectOptionList:vt,variantId:ut},primaryImage:(bt==null?void 0:bt.image_url)||Bt,productName:xt,quantity:Number(yt)||1,optionList:JSON.stringify(vt),productId:Z,basePrice:w,tax:St}};x.push(ue)});const P=Se(x);if(!a){v.error(E);return}P?(await qt(x,"2"),await it(x)&&v.success(i("purchasedProducts.footer.productsAddedToQuote"),{action:{label:i("purchasedProducts.footer.viewQuote"),onClick:()=>{h("/quoteDraft")}}})):v.error(i("purchasedProducts.footer.productsLimit"),{action:{label:i("purchasedProducts.footer.viewQuote"),onClick:()=>{h("/quoteDraft")}}})}catch(d){Tt.error(d)}finally{b(!1)}},z=d=>{h("/shoppingList/".concat(d))},U=d=>{B(!1),M(!1)},ct=()=>{B(!1),M(!0)},dt=()=>{M(!1),B(!0)},pt=()=>{c(),dt(),B(!0)},ht=async d=>{r(!0);try{const A=[];e.forEach(ot=>{const{node:E}=ot;A.includes(Number(E.productId))||A.push(Number(E.productId))});const X=[];e.forEach(ot=>{const{node:{optionList:E,productId:a,quantity:x,variantId:P,productsSearch:y}}=ot,w=D(E),at=Pe(w,y);X.push({productId:Number(a),variantId:Number(P),quantity:Number(x),optionList:at})}),await(n?Qe:Fe)({shoppingListId:Number(d),items:X}),v.success(i("purchasedProducts.footer.productsAddedToShoppingList"),{action:{label:i("pdp.notification.viewShoppingList"),onClick:()=>z(d)}}),U(!0)}catch(A){Tt.error(A)}finally{r(!1)}},ft=[{name:i("purchasedProducts.footer.addToCart"),key:"add-selected-to-cart",handleClick:N,isDisabled:!T},{name:i("purchasedProducts.footer.addToQuote"),key:"add-selected-to-quote",handleClick:G,isDisabled:!I},{name:i("purchasedProducts.footer.addSelectedProductsToShoppingList"),key:"add-selected-to-shoppingList",handleClick:pt,isDisabled:!u}];f.useEffect(()=>{if(e.length>0){let d=0;e.forEach(A=>{const{node:{variantId:X,productsSearch:{variants:H},quantity:ot,basePrice:E}}=A;if(H!=null&&H.length){const a=ie(H,Number(X))||Number(E||0);d+=a*Number(ot)}else d+=Number(E||0)*Number(ot)}),tt(1e3*d/1e3)}else tt(0)},[e]);let lt={display:l?"initial":"flex",flexBasis:"100%"};return O&&(lt={display:"flex",flexGrow:1,maxWidth:1775,margin:"auto"}),t.jsxs(t.Fragment,{children:[T||I||u?t.jsx(gt,{sx:{position:"fixed",bottom:l&&C?"52px":0,left:0,backgroundColor:"#fff",width:"100%",padding:l?"0 0 1rem 0":"16px 0 16px",height:l?"8rem":"auto",marginLeft:0,display:"flex",flexWrap:"nowrap",zIndex:"1000"},container:!0,spacing:2,children:t.jsxs(gt,{item:l,sx:lt,children:[t.jsx(j,{sx:{width:263,display:l?"none":"block"}}),t.jsxs(j,{sx:{flex:1,display:"flex",alignItems:"center",paddingLeft:l?0:"50px",paddingRight:l?0:"80px"},children:[t.jsxs(j,{sx:{width:l?"100%":"calc(66.6667% + 32px)",display:"flex",zIndex:"999",justifyContent:"space-between",...S},children:[t.jsx(st,{sx:{color:"#000000",fontSize:"16px",fontWeight:"400"},children:i("purchasedProducts.footer.selectedProducts",{quantity:e.length})}),t.jsxs(j,{sx:{display:"flex",alignItems:"center",flexWrap:l?"wrap":"nowrap",width:l?"100%":"auto"},children:[t.jsx(st,{variant:"h6",sx:{fontSize:"16px",fontWeight:"700",color:"#000000"},children:i("purchasedProducts.footer.subtotal",{subtotal:Et(R)})}),t.jsxs(j,{sx:{display:"flex",alignItems:"center",marginTop:l?"0.5rem":0,marginLeft:l?0:"20px",width:l?"100%":"auto"},children:[t.jsx(kt,{variant:"contained",ref:K,onClick:s,sx:{marginRight:l?"1rem":0,width:l?"100%":"auto"},endIcon:t.jsx(Ue,{}),children:i("purchasedProducts.footer.addSelectedTo")}),t.jsx(pe,{id:"basic-menu",anchorEl:K.current,open:$,onClose:c,MenuListProps:{"aria-labelledby":"basic-button"},children:ft.length>0&&ft.map(d=>d.isDisabled?null:t.jsx(he,{onClick:()=>{d.handleClick()},children:d.name},d.key))})]})]})]}),t.jsx(j,{sx:{width:"33.3333%",display:l?"none":"block"}})]})]})}):null,t.jsx(Me,{isOpen:_,dialogTitle:i("purchasedProducts.footer.addToShoppingList"),onClose:U,onConfirm:ht,onCreate:ct,isLoading:rt,setLoading:r}),t.jsx($e,{open:et,onChange:pt,onClose:dt})]})}const Gt=3,Kt=g=>(g||[]).reduce((e,C)=>{try{const b=typeof C=="string"?JSON.parse(C):C;return e.push({optionId:"attribute[".concat(b.option_id,"]"),optionValue:"".concat(b.id)}),e}catch(b){return e}},[]);function ns(g){const e=mt(),{quickAddToList:C}=g,b=e("purchasedProducts.quickOrderPad.addProductsToCart"),n=Mt(),I=J(({company:s})=>s.companyInfo.status),[u,i]=f.useState(Gt),[q,V]=f.useState([]),[W,nt]=f.useState(!1),Y=(s,c)=>{new Array(s).fill(1).forEach((k,m)=>c(m))};f.useEffect(()=>{let s=[];Y(u,c=>{s=[...s,...Ie(c,e)]}),V(s)},[e,u]);const[T]=$t(),O=()=>{i(u+Gt)},{control:l,handleSubmit:K,getValues:$,formState:{errors:F},setError:R,setValue:tt}=oe({mode:"all"}),_=(s,c,k)=>{if(!c&&!k)return!0;let m=!0;const o=parseInt(k,10)||0;return c||(R("sku-".concat(s),{type:"manual",message:e("global.validate.required",{label:e("purchasedProducts.quickAdd.sku")})}),m=!1),k?o<=0&&(R("qty-".concat(s),{type:"manual",message:"incorrect number"}),m=!1):(R("qty-".concat(s),{type:"manual",message:e("global.validate.required",{label:e("purchasedProducts.quickAdd.qty")})}),m=!1),m},B=s=>{const c={};let k=!0;return Y(u,m=>{const o=s["sku-".concat(m)],L=s["qty-".concat(m)];if(k=_(m,o,L)===!1?!1:k,k&&o){const N=parseInt(L,10)||0;c[o]=c[o]?c[o]+N:N}}),{skuValue:c,isValid:k,skus:Object.keys(c)}},et=async(s,c,k)=>{const m=[],o=[],L=[],N=[],D=[],it=[],G=await ce();return k.forEach(z=>{var x;const U=(s||[]).find(P=>P.variantSku.toUpperCase()===z.toUpperCase());if(!U){m.push(z);return}const{productId:ct,variantId:dt,option:pt,purchasingDisabled:ht="1",stock:ft,isStock:lt,maxQuantity:d,minQuantity:A,variantSku:X}=U,H=((x=G.find(P=>P.sku===X&&Number((P==null?void 0:P.variantEntityId)||0)===Number(dt||0)))==null?void 0:x.quantity)||0,ot=c[z]||0,E=c[z]+H||0;if(ht==="1"){o.push(z);return}if(lt==="1"&&E>Number(ft)){D.push({sku:z,stock:Number(ft)});return}if(d!==0&&A!==0&&E>0&&(E>d||E<A)){it.push({sku:z,min:E<A?A:0,max:E>d?d:0});return}const a=Kt(pt);N.push(z),L.push({...U,newSelectOptionList:a,productId:parseInt(ct,10)||0,quantity:ot,variantId:parseInt(dt,10)||0})}),{notFoundSku:m,notPurchaseSku:o,notStockSku:D,productItems:L,passSku:N,orderLimitSku:it}},M=(s,c,k,m)=>{c.forEach(o=>{const L=Object.keys(s).find(N=>s[N]===o)||"";L&&R(L.replace("sku",k),{type:"manual",message:m})})},rt=(s,c)=>{c.forEach(k=>{const m=Object.keys(s).find(o=>s[o]===k)||"";m&&(tt(m,""),tt(m.replace("sku","qty"),""))})},r=async s=>{try{const{variantSku:c}=await Ce(s);return c}catch(c){return[]}},p=async(s,c,k,m)=>{const{notFoundSku:o,notPurchaseSku:L,productItems:N,passSku:D,notStockSku:it,orderLimitSku:G}=await et(c,k,m);if(o.length>0&&(M(s,o,"sku",""),v.error(e("purchasedProducts.quickAdd.notFoundSku",{notFoundSku:o.join(",")}))),L.length>0&&(M(s,L,"sku",""),v.error(e("purchasedProducts.quickAdd.notPurchaseableSku",{notPurchaseSku:L.join(",")}))),it.length>0){const z=it.map(U=>U.sku);it.forEach(U=>{const{sku:ct,stock:dt}=U;M(s,[ct],"qty","".concat(dt," in stock"))}),v.error(e("purchasedProducts.quickAdd.insufficientStockSku",{stockSku:z.join(",")}))}return G.length>0&&G.forEach(z=>{const{min:U,max:ct,sku:dt}=z,pt=U===0?"Max":"Min",ht=U===0?ct:U;M(s,[dt],"qty","".concat(pt," is ").concat(ht));const ft=U===0?"maximum":"minimum";v.error(e("purchasedProducts.quickAdd.purchaseQuantityLimitMessage",{typeText:ft,limit:ht,sku:dt}))}),{productItems:N,passSku:D}},h=()=>{if(T&&I===0){v.info("Your business account is pending approval. This feature is currently disabled.");return}K(async s=>{try{nt(!0);const{skuValue:c,isValid:k,skus:m}=B(s);if(!k||m.length<=0)return;const o=await r(m);let L=[],N=[];if(n["B2B-3318.move_stock_and_backorder_validation_to_backend"]){if(o.length<=0){v.error(e("purchasedProducts.quickAdd.notFoundSku",{notFoundSku:m.join(",")}));return}const D=o.map(G=>{const z=Object.keys(c).find(ct=>ct.toUpperCase()===G.variantSku.toUpperCase()),U=z?c[z]:0;return{node:{productId:parseInt(G.productId,10)||0,quantity:U,productsSearch:{variantId:parseInt(G.variantId,10)||0,newSelectOptionList:Kt(G.option)}}}}),it=await ne(D,e);L=it.map(({node:G})=>({...o.find(U=>parseInt(U.productId,10)===G.productId),newSelectOptionList:G.productsSearch.newSelectOptionList,productId:G.productId,quantity:G.quantity,variantId:G.productsSearch.variantId})),N=it.map(({node:G})=>{const z=o.find(U=>parseInt(U.productId,10)===G.productId);return(z==null?void 0:z.variantSku)||""}).filter(Boolean)}else({productItems:L,passSku:N}=await p(s,o,c,m));L.length>0&&(await C(L),rt(s,N))}catch(c){c instanceof Error&&v.error(c.message)}finally{nt(!1)}})()},S=s=>{s.key==="Enter"&&h()};return t.jsx(It,{isSpinning:W,spinningHeight:"auto",children:t.jsxs(j,{sx:{width:"100%"},children:[t.jsxs(gt,{container:!0,sx:{margin:"16px 0"},children:[t.jsx(gt,{item:!0,sx:{flex:1,display:"flex",alignItems:"center"},children:t.jsx(st,{sx:{color:"#000"},variant:"body1",children:e("purchasedProducts.quickAdd.title")})}),t.jsx(gt,{item:!0,children:t.jsx(kt,{variant:"text",sx:{textTransform:"initial",ml:"-8px"},onClick:O,children:e("purchasedProducts.quickAdd.showMoreRowsButton")})})]}),t.jsx(j,{onKeyDown:S,sx:{"& label":{zIndex:0}},children:t.jsx(ae,{formFields:q,errors:F,control:l,getValues:$,setValue:tt})}),t.jsx(kt,{variant:"outlined",fullWidth:!0,disabled:W,onClick:h,sx:{margin:"20px 0"},children:t.jsx(It,{isSpinning:W,tip:"",size:16,children:t.jsx(j,{sx:{flex:1,textAlign:"center"},children:b})})})]})})}const rs=wt("div")({display:"flex",wordBreak:"break-word",gap:"8px",flexWrap:"wrap",padding:"12px 0 12px","&:first-of-type":{marginTop:"12px"}}),Dt=wt("div")(({padding:g})=>({display:"flex",flexGrow:1,flexShrink:1,alignItems:"flex-start",width:"100%",padding:g||"0 0 0 16px"})),os=wt("img")(()=>({width:"60px",height:"60px",borderRadius:"4px",marginTop:"12px",flexShrink:0})),as=wt("div")(()=>({fontSize:"0.75rem",lineHeight:"1.5",color:"#455A64"})),is=wt(Lt)(()=>({"& input::-webkit-outer-spin-button, input::-webkit-inner-spin-button":{marginTop:"-8px",marginBottom:"8px"}}));function cs(g){const{isOpen:e,onCancel:C,onConfirm:b,product:n,isLoading:I,setIsLoading:u}=g,i=mt(),q=J(({global:a})=>a.showInclusiveTaxPrice),V=J(({global:a})=>a.blockPendingQuoteNonPurchasableOOS.isEnableProduct),W=J(({b2bFeatures:a})=>a.masqueradeCompany.id),nt=J(a=>a.company.customer.customerGroupId),Y=J(a=>a.company.companyInfo.id),[T,O]=f.useState(1),[l,K]=f.useState([]),[$,F]=f.useState(null),[R,tt]=f.useState(""),[_,B]=f.useState((n==null?void 0:n.imageUrl)||""),[et,M]=f.useState({}),[rt,r]=f.useState([]),[p,h]=f.useState(0),[S,s]=f.useState([]),[c,k]=f.useState(!1),m=!!(n!=null&&n.isPriceHidden),o=async a=>{var x,P;try{u(!0);const y=((x=a==null?void 0:a.modifiers)==null?void 0:x.filter(Z=>Z.type==="product_list_with_images"||Z.type==="product_list"))||[],w={},at={};if(y.length>0){const Z=y.reduce((xt,yt)=>{const{option_values:ut}=yt;return ut.forEach(St=>{var vt;(vt=St==null?void 0:St.value_data)!=null&&vt.product_id&&xt.push(St.value_data.product_id)}),xt},[]);if(Z.length>0){const xt=Y||W,{productsSearch:yt}=await Ot({productIds:Z,companyId:xt,customerGroupId:nt});yt.forEach(ut=>{w[ut.id]=ut.imageUrl,at[ut.id]=ut})}}M(at),O(a.quantity),((P=a.variants)==null?void 0:P.length)===1&&a.variants[0]&&F(a.variants[0]);const Q=Le(a,w);K([...Q])}finally{u(!1)}},L=a=>{var P;const x=[];(P=a.allOptions)==null||P.forEach(y=>{(y.type==="product_list_with_images"||y.type==="product_list"||y.type==="checkbox"||y.type==="rectangles"||y.type==="swatch"||y.type==="radio_buttons"||y.type==="dropdown")&&x.push(y)}),r(x)};f.useEffect(()=>{var a;n?(o(n),s([]),h(0),(a=n==null?void 0:n.allOptions)!=null&&a.length&&L(n)):(O(1),K([]))},[n]);const N=a=>{var y,w,at;const{variants:x=[]}=a;let P=0;if(R){const Q=(y=x.find(Z=>Z.sku===R))==null?void 0:y.bc_calculated_price;P=(q?Q==null?void 0:Q.tax_inclusive:Q==null?void 0:Q.tax_exclusive)||0}else{const Q=(w=x[0])==null?void 0:w.bc_calculated_price;P=parseFloat((at=q?Q==null?void 0:Q.tax_inclusive:Q==null?void 0:Q.tax_exclusive)==null?void 0:at.toString())||0}return P},D=a=>{(!a.target.value||parseInt(a.target.value,10)>0)&&O(a.target.value)},it=a=>{["KeyE","Equal","Minus"].indexOf(a.code)>-1&&a.preventDefault()},G=()=>{T||O(1),Number(T)>1e6&&O(1e6)},{control:z,handleSubmit:U,getValues:ct,formState:{errors:dt},watch:pt,setValue:ht,reset:ft}=oe({mode:"all"}),lt=pt(),d=f.useRef(lt),A=f.useCallback(async(a,x="")=>{var at;if(!(((at=l.find(Q=>Q.name===x))==null?void 0:at.isVariantOption)||!1)||!n||!x)return;const{variants:y=[]}=n||{},w=y.find(Q=>{const{option_values:Z=[]}=Q;return Z.reduce((yt,ut)=>a[ve.encode("attribute[".concat(ut.option_id,"]"))].toString()!==(ut.id||"").toString()?!1:yt,!0)})||null;if(tt(w?w.sku:""),F(w),w&&(w.sku||w.variant_id)){const Q=y.find(Z=>Z.sku===w.sku||Z.variant_id===w.variant_id);B((Q==null?void 0:Q.image_url)||n.imageUrl||"")}},[l,n]);f.useEffect(()=>{const a=pt((x,{name:P})=>{A(x,P)});if(l[0]){const x=l.reduce((P,y)=>{const w=P;return w[y.name]=y.default,ht(y.name,y.default),P},{});A(x,l[0].name)}return()=>a.unsubscribe()},[l,A]);const X=f.useCallback(()=>{const{purchasing_disabled:a=!0}=$||{};return a&&!V?(v.error(i("shoppingList.chooseOptionsDialog.productNoLongerForSale")),!1):!0},[i,V,$]),H=f.useCallback(a=>{const x=Oe(l,{},a);return Object.keys(x).map(P=>{var y;return{optionId:P,optionValue:(y=x[P])==null?void 0:y.toString()}})},[l]);f.useEffect(()=>{if(!(d!=null&&d.current&&Ee(d==null?void 0:d.current,lt))&&(d.current=lt,Object.keys(lt).length&&l.length&&rt.length)){const a=H(lt),{variant_id:x=""}=$||{};if(!n||!n.id||!x||!X())return;const P=[{...n,newSelectOptionList:a,productId:n==null?void 0:n.id,quantity:parseInt(T.toString(),10)||1,variantId:parseInt(x.toString(),10)||1,additionalProducts:et}];if(S[0]){let y=!1;const{newSelectOptionList:w}=S[0];w.forEach(at=>{const Q=rt.findIndex(Z=>at.optionId.includes(String(Z.id)));a.forEach(Z=>{at.optionId===Z.optionId&&at.optionValue!==Z.optionValue&&Q!==-1&&(y=!0)})}),y&&s(P)}else s(P)}},[et,S,l.length,lt,H,n,rt,T,X,$]),f.useEffect(()=>{(async()=>{try{if(S.length){k(!0);const x=await qt(S);if(x[0]){const{basePrice:P,taxPrice:y}=x[0],w=we(Number(P),Number(y));h(w)}}}catch(x){Tt.error(x)}finally{k(!1)}})()},[S]);const ot=()=>{U(a=>{const x=H(a),{variant_id:P=""}=$||{};!n||!n.id||!P||!X()||b([{...n,newSelectOptionList:x,productId:n==null?void 0:n.id,quantity:parseInt(T.toString(),10)||1,variantId:parseInt(P.toString(),10)||1,additionalProducts:et}])})()},E=()=>{O(1),C()};return f.useEffect(()=>{e||ft()},[e]),t.jsx(ee,{isOpen:e,rightSizeBtn:i("purchasedProducts.quickOrderPad.addToCart"),handleLeftClick:E,handRightClick:ot,title:i("shoppingList.chooseOptionsDialog.chooseOptions"),loading:I||c,children:t.jsx(It,{isSpinning:I,children:n&&t.jsx(j,{children:t.jsxs(j,{sx:{display:"flex",flexDirection:"column"},children:[t.jsxs(j,{sx:{display:"flex"},children:[t.jsx(os,{src:_||n.imageUrl||Bt}),t.jsxs(rs,{children:[t.jsx(Dt,{padding:"0",children:t.jsxs(j,{sx:{marginLeft:"16px"},children:[t.jsx(st,{variant:"body1",color:"#212121",children:n.name}),t.jsx(st,{variant:"body1",color:"#616161",children:R||n.sku}),(n.product_options||[]).map(a=>t.jsx(as,{children:"".concat(a.display_name,": ").concat(a.display_value)},"".concat(a.option_id)))]})}),t.jsxs(Dt,{children:[t.jsx("span",{children:i("shoppingList.chooseOptionsDialog.price")}),m?Et(p*Number(T)||N(n)):""]}),t.jsx(Dt,{children:t.jsx(is,{type:"number",variant:"filled",label:i("shoppingList.chooseOptionsDialog.quantity"),value:T,onChange:D,onKeyDown:it,onBlur:G,size:"small",sx:{width:"60%",maxWidth:"100px"}})})]})]}),t.jsx(Qt,{sx:{margin:"16px 0 24px"}}),t.jsx(ae,{formFields:l,errors:dt,control:z,getValues:ct,setValue:ht})]})})})})}function ds(g){const{product:{id:e,allOptions:C},onAddToListClick:b,onChooseOptionsClick:n,addButtonText:I}=g,{state:{isLoading:u=!1}}=f.useContext(Re),[i]=Ct(),q=mt();return C&&C.length>0?t.jsx(kt,{variant:"outlined",onClick:()=>{n(e)},disabled:u,fullWidth:i,children:q("global.searchProduct.chooseOptionsButton")}):t.jsx(kt,{variant:"outlined",onClick:()=>{b(e)},disabled:u,fullWidth:i,children:I})}const us=je;function ls(g){const e=mt(),{isOpen:C,onCancel:b,searchText:n,productList:I,onSearchTextChange:u,onSearch:i,onProductQuantityChange:q,onAddToListClick:V,onChooseOptionsClick:W,isLoading:nt}=g,Y=J(({global:F})=>F.blockPendingQuoteNonPurchasableOOS.isEnableProduct),[T]=Ct(),O=()=>{b()},l=F=>{F.key==="Enter"&&i()},K=f.useCallback(F=>{const{variants:R=[]}=F||{},{purchasing_disabled:tt=!0}=R[0]||{};return tt&&!Y?(v.error(e("shoppingList.chooseOptionsDialog.productNoLongerForSale")),!1):!0},[e,Y]),$=F=>{var tt;const R=I.find(_=>_.id===F);if(R&&K(R||{})){let _=R.variantId||0;!R.variantId&&((tt=R.variants)!=null&&tt[0])&&(_=R.variants[0].variant_id),V([{...R,newSelectOptionList:[],quantity:parseInt(R.quantity.toString(),10)||1,variantId:_}])}};return t.jsx(ee,{fullWidth:!0,isOpen:C,handleLeftClick:O,title:e("purchasedProducts.quickOrderPad.quickOrderPad"),showRightBtn:!1,loading:nt,maxWidth:"md",leftSizeBtn:e("shoppingLists.close"),children:t.jsx(It,{isSpinning:nt,children:t.jsxs(j,{sx:{minWidth:T?"initial":"100%",flex:1},children:[t.jsx(Lt,{hiddenLabel:!0,variant:"filled",fullWidth:!0,size:"small",value:n,onChange:u,onKeyDown:l,error:!I||I.length<=0,InputProps:{startAdornment:t.jsx(Jt,{position:"start",children:t.jsx(re,{})})},sx:{margin:"12px 0","& input":{padding:"12px 12px 12px 0"}}}),I&&I.length>0?t.jsx(us,{products:I,quantityEditable:!0,type:"quickOrder",textAlign:T?"left":"right",canToProduct:!0,onProductQuantityChange:q,renderAction:F=>t.jsx(ds,{product:F,onAddToListClick:$,onChooseOptionsClick:W,addButtonText:e("purchasedProducts.quickOrderPad.addToCart")}),actionWidth:"180px"}):t.jsx(st,{children:"No products found"})]})})})}function ps({addToList:g}){const e=mt(),C=J(({company:o})=>o.companyInfo.id),b=J(o=>o.company.customer.customerGroupId),n=J(({company:o})=>o.companyInfo.status),I=J(({b2bFeatures:o})=>o.masqueradeCompany.id),u=C||I,[i,q]=f.useState(!1),[V,W]=f.useState(!1),[nt,Y]=f.useState(!1),[T,O]=f.useState(""),[l,K]=f.useState([]),[$,F]=f.useState(!1),[R,tt]=f.useState(),[_]=$t(),B=o=>{O(o.target.value)},et=async()=>{if(!(!T||i)){if(_&&n===0){v.info(e("global.searchProductAddProduct.businessAccountPendingApproval"));return}q(!0);try{const{productsSearch:o}=await Ot({search:T,companyId:u,customerGroupId:b,categoryFilter:!0}),L=Rt(o);K(L),W(!0)}finally{q(!1)}}},M=o=>{o.key==="Enter"&&et()},rt=()=>{et()},r=()=>{K([])},p=()=>{F(!1),W(!1),nt&&Y(!1),r()},h=(o,L)=>{const N=l.find(D=>D.id===o);N&&(N.quantity=L),K([...l])},S=async o=>{try{q(!0),await qt(o),await g(o)}finally{q(!1)}},s=async o=>{await S(o)},c=o=>{const L=l.find(N=>N.id===o);L&&tt({...L}),W(!1),F(!0)},k=()=>{F(!1),W(!0)},m=async o=>{try{q(!0),await qt(o),await S(o),F(!1),W(!0)}catch(L){q(!1)}finally{q(!1)}};return t.jsxs(j,{sx:{margin:"24px 0"},children:[t.jsx(st,{children:e("global.searchProductAddProduct.searchBySkuOrName")}),t.jsx(Lt,{hiddenLabel:!0,placeholder:e("global.searchProduct.placeholder.quickOrder"),variant:"filled",fullWidth:!0,size:"small",value:T,onChange:B,onKeyDown:M,InputProps:{startAdornment:t.jsx(Jt,{position:"start",children:t.jsx(re,{})})},sx:{margin:"12px 0","& input":{padding:"12px 12px 12px 0"}}}),t.jsx(kt,{variant:"outlined",fullWidth:!0,disabled:i,onClick:rt,children:t.jsx(It,{isSpinning:i,tip:"",size:16,children:t.jsx(j,{sx:{flex:1,textAlign:"center"},children:e("global.searchProductAddProduct.searchProduct")})})}),t.jsx(ls,{isOpen:V,isLoading:i,productList:l,searchText:T,onSearchTextChange:B,onSearch:rt,onCancel:p,onProductQuantityChange:h,onChooseOptionsClick:c,onAddToListClick:s}),t.jsx(cs,{isOpen:$,isLoading:i,setIsLoading:q,product:R,onCancel:k,onConfirm:m})]})}function hs(){const[g]=Ct(),e=mt(),[C,b]=f.useState(!1),[n,I]=f.useState([]),[u,i]=f.useState("Add to cart"),[q,V]=f.useState(!1),[W]=$t(),Y=Mt()["B2B-3318.move_stock_and_backorder_validation_to_backend"],T=J(({company:_})=>_.companyInfo.status),O=_=>{_&&!_.errors?v.success(e("purchasedProducts.quickOrderPad.productsAdded"),{action:{label:e("purchasedProducts.quickOrderPad.viewCart"),onClick:()=>{window.b2b.callbacks.dispatchEvent("on-click-cart-button")&&(window.location.href=Ft)}}}):v.error("Error has occurred")},l=async _=>{const B=await At(_);return B&&B.errors?v.error(B.errors[0].message):v.success(e("purchasedProducts.quickOrderPad.productsAdded"),{action:{label:e("purchasedProducts.quickOrderPad.viewCart"),onClick:()=>{window.b2b.callbacks.dispatchEvent("on-click-cart-button")&&(window.location.href=Ft)}}}),Nt(),B},K=_=>{const B=[],et=[],M=[],rt=[],r=[],p=[];return _.forEach(h=>{const{products:S,qty:s}=h,{option:c,isStock:k,stock:m,purchasingDisabled:o,maxQuantity:L,minQuantity:N,variantSku:D,variantId:it,productId:G,modifiers:z}=S;if(o==="1"||o){B.push(D);return}if(k==="1"&&m===0){p.push(D);return}if(k==="1"&&m>0&&m<Number(s)){M.push({variantSku:D,AvailableAmount:m});return}if(Number(N)>0&&Number(s)<Number(N)){rt.push({variantSku:D,minQuantity:N});return}if(Number(L)>0&&Number(s)>Number(L)){r.push({variantSku:D,maxQuantity:L});return}const U=c.map(ct=>({optionId:ct.option_id,optionValue:ct.id}));et.push({productId:parseInt(G,10)||0,variantId:parseInt(it,10)||0,quantity:Number(s),optionSelections:U,allOptions:z})}),{notPurchaseSku:B,productItems:et,limitProduct:M,minLimitQuantity:rt,maxLimitQuantity:r,outOfStock:p}},$=async _=>{V(!0);try{const{stockErrorFile:B,validProduct:et}=_,{notPurchaseSku:M,productItems:rt,limitProduct:r,minLimitQuantity:p,maxLimitQuantity:h,outOfStock:S}=K(et);if(rt.length>0){const s=await At(rt);O(s),Nt()}r.length>0&&r.forEach(s=>{v.warning(e("purchasedProducts.quickOrderPad.notEnoughStock",{variantSku:s.variantSku}),{description:e("purchasedProducts.quickOrderPad.availableAmount",{availableAmount:s.AvailableAmount})})}),M.length>0&&v.error(e("purchasedProducts.quickOrderPad.notPurchaseableSku",{notPurchaseSku:M.join(",")})),S.length>0&&B&&v.error(e("purchasedProducts.quickOrderPad.outOfStockSku",{outOfStock:S.join(",")}),{action:{label:e("purchasedProducts.quickOrderPad.downloadErrorsCSV"),onClick:()=>{window.location.href=B}}}),p.length>0&&p.forEach(s=>{v.error(e("purchasedProducts.quickOrderPad.minQuantityMessage",{minQuantity:s.minQuantity,sku:s.variantSku}))}),h.length>0&&h.forEach(s=>{v.error(e("purchasedProducts.quickOrderPad.maxQuantityMessage",{maxQuantity:s.maxQuantity,sku:s.variantSku}))}),b(!1)}finally{V(!1)}},F=async _=>{const B=_.map(M=>({node:{...M,productsSearch:M}})),et=await de(B,e);try{et&&await l(_)}catch(M){Tt.error(M)}return _},R=()=>{W&&T===0?v.info(e("purchasedProducts.quickOrderPad.addNProductsToCart")):b(!0)},tt=async _=>{try{await l(_)}catch(B){B instanceof Error&&v.error(B.message)}};return f.useEffect(()=>{(n==null?void 0:n.length)>0&&i(e("purchasedProducts.quickOrderPad.addNProductsToCart",{quantity:n.length}))},[e,n]),t.jsxs(fe,{sx:{marginBottom:g?"8.5rem":"50px"},children:[t.jsx(Ht,{children:t.jsxs(j,{children:[t.jsx(st,{variant:"h5",sx:{marginBottom:"1rem"},children:e("purchasedProducts.quickOrderPad.quickOrderPad")}),t.jsx(ps,{addToList:Y?tt:F}),t.jsx(Qt,{}),t.jsx(ns,{quickAddToList:l}),t.jsx(Qt,{}),t.jsx(j,{sx:{margin:"20px 0 0"},children:t.jsxs(kt,{variant:"text",onClick:()=>R(),children:[t.jsx(We,{sx:{marginRight:"8px"}}),e("purchasedProducts.quickOrderPad.bulkUploadCSV")]})})]})}),t.jsx(qe,{isOpen:C,setIsOpen:b,handleAddToList:$,setProductData:I,addBtnText:u,isLoading:q,isToCart:!0})]})}function Rs(){const g=J(Ae),e=J(({b2bFeatures:V})=>V.masqueradeCompany.isAgenting),[C]=Ct(),[b,n]=f.useState(!1),[I,u]=f.useState([]),{purchasabilityPermission:i}=J(te),q=g?i:!0;return t.jsxs(j,{sx:{width:"100%"},children:[t.jsx(j,{sx:{display:"flex",justifyContent:"center"},children:t.jsxs(gt,{sx:{m:0,width:"100%"},container:!0,spacing:2,children:[t.jsx(gt,{item:!0,xs:C?12:8,sx:{backgroundColor:"#ffffff",boxShadow:"0px 2px 1px -1px rgba(0, 0, 0, 0.2), 0px 1px 1px rgba(0, 0, 0, 0.14), 0px 1px 3px rgba(0, 0, 0, 0.12)",borderRadius:"4px",pr:"16px"},children:t.jsx(ts,{setCheckedArr:u,setIsRequestLoading:n,isRequestLoading:b})}),t.jsx(gt,{item:!0,xs:C?12:4,sx:{pt:C?"16px":"0px !important",pl:C?"0px !important":"16px"},children:q&&t.jsx(hs,{})})]})}),t.jsx(j,{sx:{position:"fixed",bottom:0,left:0,width:"100%",zIndex:"999"},children:t.jsx(ss,{checkedArr:I,isAgenting:e,setIsRequestLoading:n,isB2BUser:g})})]})}export{Rs as default};
//# sourceMappingURL=index-BaFguuku.js.map
