System.register(["./mui-legacy-Co1sKVsS.js","./intl-legacy-f5dGU49Z.js","./react-setup-legacy-D2JRzxdF.js","./B3Filter-legacy-BmtmonFX.js","./load-functions-legacy-rxJ-MsEG.js","./shoppingList-legacy-BAOlftiS.js","./useTableRef-legacy-Ct-N3MGx.js","./base-legacy-DAqmyLJs.js","./form-legacy-LlvE08FY.js","./B3CustomForm-legacy-D2p9DUUp.js","./ShoppingListStatusTag-legacy-Dp-8jg0g.js","./router-legacy-CQEMCAt4.js","./muiIcon-legacy-C-h6sDde.js","./reactVendor-legacy-C5drotBr.js","./eCache-legacy-QcRlogRO.js","./redux-legacy-DH94TLLa.js","./toolkit-legacy-DO7GmFjE.js","./lodashEs-legacy-BTGS6uHg.js","../index-legacy.js","./global-legacy-vVqwfyov.js","./dropzone-legacy-B1uEXZk9.js","./dateFns-legacy-DHywh9DD.js","./B3FilterMore-legacy-BZwi3GoI.js","./B3FilterSearch-legacy-CpS4so5C.js"],function(s,e){"use strict";var i,t,n,a,p,o,l,r,d,c,h,u,g,m,L,f,y,S,x,B,b,j,I,D,C,v,$,q,w,P,A,k,N,F,z,E,R,T;return{setters:[s=>{i=s.j,t=s.A,n=s.ae,a=s.T,p=s.B,o=s.w,l=s.I},s=>{r=s.r},s=>{d=s.j,c=s.B,h=s.u,u=s.a2,g=s.ad,m=s.I,L=s.ak,f=s.ao,y=s.at,S=s.aw,x=s.ag,B=s.a,b=s.G,j=s.af,I=s.am,D=s.y},s=>{C=s.B},null,s=>{v=s.S,$=s.f,q=s.g,w=s.a},s=>{P=s.a,A=s.u},null,s=>{k=s.u},s=>{N=s.B},s=>{F=s.S},s=>{z=s.a},s=>{E=s.E,R=s.q,T=s.f},null,null,null,null,null,null,null,null,null,null,null],execute:function(){s("default",function(){const[s,t]=r.useState(!1),[n,a]=r.useState(!1),[o,l]=r.useState(null),[c,f]=r.useState([]),y=e(),[S]=B(),x=d(),[k]=P(),{isB2BUser:N,shoppingListCreateActionsPermission:F,submitShoppingListPermission:z,deleteShoppingList:E,getUserShoppingLists:R}=function(){const s=h(({b2bFeatures:s})=>s.masqueradeCompany.id),e=h(D),i=h(({company:s})=>s.companyInfo.id),{shoppingListCreateActionsPermission:t,submitShoppingListPermission:n}=h(u),a=i||s,p=e?X:_,o=e?()=>$(Number(a),1):()=>Promise.resolve({});return{isB2BUser:e,shoppingListCreateActionsPermission:t,submitShoppingListPermission:n,deleteShoppingList:p,getUserShoppingLists:o}}(),{state:{openAPPParams:T},dispatch:U}=r.useContext(b);r.useEffect(()=>{(async()=>{f(y(z,await R()))})(),T.shoppingListBtn&&U({type:"common",payload:{openAPPParams:{quoteBtn:"",shoppingListBtn:""}}})},[]);const O=A(),V={isEnabled:!N||F,customLabel:x("shoppingLists.createNew"),customButtonStyle:{fontSize:"15px",fontWeight:"500",width:"140px",padding:"0"}},H=z?"":[v.Approved,v.ReadyForApproval],M={search:"",createdBy:"",status:H,isDefault:!0},[W,J]=r.useState(M),K=r.useRef(null),Q=()=>{k.current?.refresh()},Z=s=>{K.current?.handleOpenAddEditShoppingListsClick("edit",s)},ss=s=>{K.current?.handleOpenAddEditShoppingListsClick("dup",s)},es=s=>{l(s),a(!0)},is=()=>{a(!1)};return i.jsx(j,{isSpinning:s,children:i.jsxs(p,{sx:{display:"flex",flexDirection:"column",flex:1},children:[i.jsx(C,{showB3FilterMoreIcon:N,filterMoreInfo:c,handleChange:(s,e)=>{if("search"===s){const s={...M,search:e};J(s)}},handleFilterChange:s=>{const{status:e}=s,i=""===e||99===e?H:e,t={...M,createdBy:s.createdBy,status:i,isDefault:""===e};J(t)},customButtonConfig:V,handleFilterCustomButtonClick:()=>{K.current?.handleOpenAddEditShoppingListsClick("add")}}),i.jsx(I,{columnItems:[],ref:k,rowsPerPageOptions:[12,24,36],getRequestList:async s=>{const{edges:e,totalCount:i}=N?await q(s):await w({offset:s.offset,first:s.first,search:s.search,channelId:m});return{edges:e,totalCount:i}},searchParams:W,isCustomRender:!0,itemXs:O?3:4,requestLoading:t,renderItem:s=>i.jsx(Y,{item:s,isPermissions:!N||F,onEdit:Z,onDelete:es,onCopy:ss,isB2BUser:N},s.id||"")}),i.jsx(G,{renderList:Q,ref:K,isB2BUser:N}),i.jsx(g,{isOpen:n,title:x("shoppingLists.deleteShoppingList"),leftSizeBtn:x("shoppingLists.cancel"),rightSizeBtn:x("shoppingLists.delete"),handleLeftClick:is,handRightClick:async()=>{if(o)try{t(!0),is(),await E(o?.id||0),L.success(x("shoppingLists.deleteSuccess"))}finally{t(!1),Q()}},row:o,rightStyleBtn:{color:"#D32F2F"},isShowBordered:!1,children:i.jsx(p,{sx:{display:"flex",width:S?"100%":"450px",height:"100%"},children:x("shoppingLists.confirmDelete")})})]})})});const e=()=>{const s=d(),e=(()=>{const s=d();return e=>{const i={value:v.Draft,label:s("global.shoppingLists.status.draft")},t={value:v.Rejected,label:s("global.shoppingLists.status.rejected")};return[{value:99,label:s("global.shoppingLists.status.all")},{value:v.Approved,label:s("global.shoppingLists.status.approved")},...e?[i]:[],{value:v.ReadyForApproval,label:s("global.shoppingLists.status.readyForApproval")},...e?[t]:[]]}})();return(i,t)=>[{name:"createdBy",required:!1,default:"",fieldType:"dropdown",options:t?.createdByUser?.results.map(s=>({createdBy:`${s.firstName} ${s.lastName} (${s.email})`}))||[],replaceOptions:{label:"createdBy",value:"createdBy"},xs:12,variant:"filled",size:"small",label:s("global.shoppingLists.filter.createdBy")},{name:"status",required:!1,default:"",fieldType:"dropdown",options:e(i),xs:12,variant:"filled",size:"small",label:s("global.shoppingLists.filter.status")}]},U=s=>c.graphqlB2B({query:"\n  mutation CreateShoppingList ($shoppingListData: ShoppingListsInputType!){\n    shoppingListsCreate (\n      shoppingListData: $shoppingListData\n    ) {\n      shoppingList {\n        id,\n      }\n    }\n  }\n",variables:{shoppingListData:s}}),O=s=>c.graphqlB2B({query:"\n  mutation CreateCustomerShoppingList($shoppingListData: CustomerShoppingListsInputType!) {\n    customerShoppingListsCreate(shoppingListData: $shoppingListData) {\n      shoppingList {\n        id,\n      }\n    }\n  }\n",variables:{shoppingListData:{name:s.name,description:s.description,channelId:s?.channelId?Number(s.channelId):1}}}),V=s=>c.graphqlB2B({query:"\n  mutation DuplicateB2BShoppingList($sampleShoppingListId: Int!, $shoppingListData: ShoppingListsDuplicateInputType!){\n    shoppingListsDuplicate(sampleShoppingListId: $sampleShoppingListId, shoppingListData: $shoppingListData) {\n      shoppingList {\n        id,\n      }\n    }\n  }\n",variables:{sampleShoppingListId:Number(s.sampleShoppingListId),shoppingListData:{name:s.name,description:s.description}}}),H=s=>c.graphqlB2B({query:"\n  mutation DuplicateB2CShoppingList($sampleShoppingListId: Int!, $shoppingListData: ShoppingListsDuplicateInputType!){\n    customerShoppingListsDuplicate(sampleShoppingListId: $sampleShoppingListId, shoppingListData: $shoppingListData) {\n      shoppingList {\n        id,\n      }\n    }\n  }\n",variables:{sampleShoppingListId:Number(s.sampleShoppingListId),shoppingListData:{name:s.name,description:s.description}}}),M=s=>c.graphqlB2B({query:"\n  mutation UpdateB2BShoppingList ($id: Int!, $shoppingListData: ShoppingListsInputType!) {\n    shoppingListsUpdate(id: $id, shoppingListData: $shoppingListData) {\n      shoppingList {\n        id\n      }\n    }\n  }\n",variables:{id:Number(s.id),shoppingListData:{name:s.name,description:s.description,status:s.status}}}),W=s=>c.graphqlB2B({query:"mutation UpdateB2CShoppingList($id: Int!, $shoppingListData: CustomerShoppingListsInputType!){\n  customerShoppingListsUpdate(id: $id, shoppingListData: $shoppingListData) {\n    shoppingList {\n      id\n    }\n  }\n}",variables:{id:Number(s.id),shoppingListData:{name:s.name,description:s.description,channelId:s?.channelId?Number(s.channelId):1}}}),G=r.forwardRef(function({renderList:s,isB2BUser:e},t){const n=h(u),{selectCompanyHierarchyId:a}=h(({company:s})=>s.companyHierarchyInfo),[p,o]=r.useState(!1),[l,c]=r.useState(""),[f,y]=r.useState(null),[S,x]=r.useState(!1),[B,b]=r.useState([]),j=d(),{control:I,handleSubmit:D,getValues:C,formState:{errors:$},clearErrors:q,setValue:w}=k({mode:"onSubmit"});r.useEffect(()=>{p&&"add"!==l&&f&&B.forEach(s=>{w(s.name,f[s.name])})},[f,p,w,l,B]);const P=()=>{B.forEach(s=>{w(s.name,"")}),q(),o(!1)},A=(s,e)=>{const i=(s=>[{name:"name",label:s("shoppingLists.name"),required:!0,default:"",fieldType:"text",xs:12,variant:"filled",size:"small",maxLength:200},{name:"description",label:s("shoppingLists.description"),required:!1,default:"",fieldType:"multiline",xs:12,variant:"filled",size:"small",rows:4,maxLength:200}])(j);b(i),e&&y(e),c(s),o(!0)};return r.useImperativeHandle(t,()=>({handleOpenAddEditShoppingListsClick:A})),i.jsx(g,{isOpen:p,title:j("edit"===l?"shoppingLists.edit":"add"===l?"shoppingLists.createNewShoppingList":"shoppingLists.duplicateShoppingList"),leftSizeBtn:j("shoppingLists.cancel"),rightSizeBtn:j("shoppingLists.save"),handleLeftClick:P,handRightClick:()=>{D(async i=>{x(!0);try{const t={...i};let p=e?U:O,o=j("shoppingLists.addSuccess");if("edit"===l)e?(p=M,t.status=f?.status):(p=W,t.channelId=m),t.id=f?.id||0,o=j("shoppingLists.updateSuccess");else if("dup"===l)p=e?V:H,t.sampleShoppingListId=f?.id||0,o=j("shoppingLists.duplicateSuccess");else if("add"===l)if(e){const{submitShoppingListPermission:s}=n;a&&(t.companyId=Number(a)),t.status=s?v.Draft:v.Approved}else t.channelId=m;await p(t),P(),L.success(o),s()}finally{x(!1)}})()},loading:S,children:i.jsx(N,{formFields:B,errors:$,control:I,getValues:C,setValue:w})})}),X=s=>c.graphqlB2B({query:"\n  mutation DeleteShoppingList($id: Int!) {\n    shoppingListsDelete(id: $id) {\n      message\n    }\n  }\n",variables:{id:Number(s)}}),_=s=>c.graphqlB2B({query:"\n  mutation DeleteCustomerShoppingList ($id: Int!) {\n    customerShoppingListsDelete (id: $id) {\n      message\n    }\n  }\n",variables:{id:Number(s)}}),J=o("div")(()=>({display:"flex",alignItems:"center",justifyContent:"space-between"})),K=o(a)(()=>({fontWeight:"500",paddingRight:"5px"})),Q=o(p)(()=>({display:"flex",alignItems:"center",justifyContent:"start"}));function Y(s){const{item:e,onEdit:o,onDelete:c,onCopy:g,isPermissions:m,isB2BUser:L}=s,B=d(),[b,j]=r.useState(!0),{submitShoppingListPermission:I,approveShoppingListPermission:D}=h(u),C=z();return r.useEffect(()=>{if(L){const{companyInfo:s,customerInfo:i}=e,{shoppingListCreateActionsPermission:t}=f,n=y({code:t,companyId:Number(s?.companyId||0),userId:Number(i.userId)});j(n)}},[e,L]),i.jsx(t,{sx:{"& .b2b-card-content":{paddingBottom:"16px"}},children:i.jsxs(n,{className:"b2b-card-content",sx:{color:"#313440"},children:[i.jsx(a,{variant:"h5",sx:{color:"rgba(0, 0, 0, 0.87)",width:"100%",wordBreak:"break-all"},children:e.name}),i.jsxs(p,{sx:{pt:"8px",pb:"20px"},children:[L&&(I||D&&e.approvedFlag)&&i.jsx(p,{sx:{pb:"25px"},children:i.jsx(F,{status:e.status})}),i.jsx(p,{sx:{width:"100%",wordBreak:"break-all"},children:e.description}),L&&i.jsxs(Q,{children:[i.jsx(K,{children:B("shoppingLists.card.createdBy")}),e.customerInfo.firstName," ",e.customerInfo.lastName]}),i.jsxs(Q,{children:[i.jsx(K,{children:B("shoppingLists.card.products")}),e.products.totalCount]}),i.jsxs(Q,{children:[i.jsx(K,{children:B("shoppingLists.card.lastActivity")}),`${S(e.updatedAt)}`]})]}),i.jsxs(J,{children:[i.jsx(x,{sx:{m:"0 0 0 -8px",minWidth:0},variant:"text",onClick:()=>C(`/shoppingList/${e.id}`,{state:{from:"shoppingList"}}),children:B("shoppingLists.card.view")}),i.jsxs(p,{sx:{display:m?"block":"none"},children:[($=e.status,!(I?$!==v.Draft&&$!==v.Approved:$===v.ReadyForApproval)&&b&&i.jsx(l,{"aria-label":"edit",size:"medium",sx:{marginRight:"8px"},onClick:()=>{o(e)},children:i.jsx(E,{fontSize:"inherit"})})),i.jsx(l,{"aria-label":"duplicate",size:"medium",sx:{marginRight:"8px"},onClick:()=>{g(e)},children:i.jsx(R,{fontSize:"inherit"})}),(s=>!I||(s===v.Deleted||s===v.Draft||s===v.Rejected))(e.status)&&b&&i.jsx(l,{"aria-label":"delete",size:"medium",onClick:()=>{c(e)},children:i.jsx(T,{fontSize:"inherit"})})]})]})]})},e.id);var $}}}});
//# sourceMappingURL=index-legacy-CampFvKc.js.map
