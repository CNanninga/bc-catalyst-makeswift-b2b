System.register(["./mui-legacy-Co1sKVsS.js","./intl-legacy-f5dGU49Z.js","./react-setup-legacy-D2JRzxdF.js","./load-functions-legacy-rxJ-MsEG.js","./base-legacy-DAqmyLJs.js","./QuoteStatus-legacy-B_p6P32C.js","./lodashEs-legacy-BTGS6uHg.js","./muiIcon-legacy-C-h6sDde.js"],function(e,t){"use strict";var i,l,a,n,o,s,r,d,c,f,u,x,p,g,m,h,b,j,y,w,q,I,N,S,D,z,F,C,v,E,L,k,$,T,U,A,B,R,M;return{setters:[e=>{i=e.j,l=e.B,a=e.T,n=e.N,o=e.O,s=e.w,r=e.am,d=e.A,c=e.ae,f=e.b},e=>{u=e.r},e=>{x=e.j,p=e.bR,g=e.af,m=e.bS,h=e.ak,b=e.bT,j=e.bk,y=e.i,w=e.u,q=e.bU,I=e.bJ,N=e.bp,S=e.a,D=e.ag,z=e.y,F=e.a2,C=e.a7,v=e.bV},null,e=>{E=e.b},e=>{L=e.h,k=e.i,$=e.j},e=>{T=e.n},e=>{U=e.n,A=e.o,B=e.f,R=e.H,M=e.p}],execute:function(){function t(e){const{children:t,title:o="",header:s,defaultOpen:r=!1,handleOnChange:d}=e,[c,f]=u.useState(r);return u.useEffect(()=>{d&&d(c)},[d,c]),u.useEffect(()=>{r&&f(r)},[r]),i.jsxs(l,{children:[i.jsxs(l,{onClick:()=>{f(!c)},sx:{display:"flex",justifyContent:"space-between",cursor:"pointer",alignItems:"center"},children:[s||i.jsx(a,{variant:"h5",children:o}),c?i.jsx(U,{}):i.jsx(A,{})]}),i.jsx(n,{in:c,timeout:"auto",unmountOnExit:!0,children:t})]})}e({B:t,Q:function({quoteAndExtraFieldsInfo:e,contactInfo:t,shippingAddress:a,billingAddress:n,handleEditInfoClick:o,status:s}){const r=x(),[d]=S();return i.jsxs(V,{flexDirection:"column",xs:{boxShadow:"0px 2px 1px -1px rgba(0, 0, 0, 0.2), 0px 1px 1px rgba(0, 0, 0, 0.14), 0px 1px 3px rgba(0, 0, 0, 0.12)",borderRadius:"4px"},children:[i.jsxs(l,{sx:{width:"100%",display:"flex",justifyContent:"space-between",flexDirection:d?"column":"row"},children:[i.jsxs(l,{sx:{width:d?"100%":"33.3%"},children:[i.jsx(X,{title:r("quoteDraft.contactInfo.contact"),flag:"info",status:s,info:t}),i.jsx(J,{status:s,quoteInfo:e})]}),i.jsx(X,{title:r("global.quoteInfo.billing"),flag:"Billing",status:s,info:n}),i.jsx(X,{title:r("global.quoteInfo.shipping"),flag:"Shipping",status:s,info:a})]}),o&&i.jsx(D,{sx:{mt:"10px",mb:"15px"},onClick:o,variant:"outlined",children:r("global.quoteInfo.editInfo")})]})},a:function(e){const n=x(),{quoteStatus:o,quoteNotes:s=""}=e,[r,p]=u.useState(""),[g,m]=u.useState(!1),h=w(z),b=w(F),j=!h||b.quotesCreateActionsPermission;return u.useEffect(()=>{const e=C.getState().quoteInfo.draftQuoteInfo.note||"";p(e)},[]),u.useEffect(()=>{C.dispatch(v(r||""))},[r]),u.useEffect(()=>{s&&m(!0)},[s]),i.jsx(d,{children:i.jsx(c,{sx:{p:"16px !important"},children:i.jsx(t,{title:n(o&&"Draft"===o?"global.quoteNote.message":"global.quoteNote.notes"),defaultOpen:g,children:i.jsxs(l,{sx:{padding:"16px 0"},children:[o&&"Draft"===o&&i.jsx(l,{sx:{fontSize:"16px",color:"rgba(0, 0, 0, 0.38)",mb:"16px"},children:n("global.quoteNote.messageNote")}),s?i.jsx(a,{variant:"body1",style:{whiteSpace:"pre-line",maxHeight:"400px",overflow:"auto"},children:s}):i.jsx(l,{children:j?i.jsx(f,{multiline:!0,fullWidth:!0,rows:5,value:r,onChange:e=>{p(e?.target.value||""),C.dispatch(v(e?.target.value||""))},label:n("global.quoteNote.typeMessage"),size:"small",variant:"filled",sx:{"& .MuiFormLabel-root":{color:"rgba(0, 0, 0, 0.38)"}}}):null})]})})})})},b:function(e){const{allowUpload:a=!0,defaultFileList:n=[],status:o,quoteId:s}=e,r=x(),f=y(),p=w(({company:e})=>e.customer.firstName),g=w(({company:e})=>e.customer.lastName),m=w(({quoteInfo:e})=>e.draftQuoteInfo),[b]=q(),[j,N]=u.useState([]),S=u.useRef(null);u.useEffect(()=>{if(0===o){const{fileInfo:e=[]}=m||{};N("object"!=typeof e?[]:e)}else n.length&&N(n)},[n.length,o]);const D=e=>{if(m){const t={...m,fileInfo:e};f(I(t))}};return i.jsx(d,{children:i.jsx(c,{sx:{p:"16px !important"},children:i.jsx(t,{title:r("global.quoteAttachment.title"),children:i.jsx(l,{children:i.jsx(P,{ref:S,requestType:"b2b"!==b?"customerQuoteAttachedFile":"quoteAttachedFile",isEndLoadding:!0,fileList:j,limitUploadFn:()=>j.filter(e=>e?.title&&e.title.includes("by customer")).length>=3&&(h.error(r("global.quoteAttachment.maxFilesMessage")),!0),onchange:async e=>{try{let t=[];if(0!==o){const i={fileName:e.fileName,fileType:e.fileType,fileUrl:e.fileUrl,fileSize:e.fileSize},{quoteAttachFileCreate:{attachFiles:l}}=await L({fileList:[{...i}],quoteId:s});i.id=l[0].id,t=[{...i,title:r("global.quoteAttachment.uploadedByCustomer",{createdBy:l[0].createdBy}),hasDelete:!0},...j]}else t=[{...e,title:r("global.quoteAttachment.uploadedByCustomerWithName",{firstName:p,lastName:g}),hasDelete:!0},...j],D(t);N(t)}finally{S.current?.setUploadLoadding(!1)}},onDelete:async e=>{try{S.current?.setUploadLoadding(!0);const t=j.find(t=>t.id===e),i=j.filter(t=>t.id!==e);0!==o&&t?await k({fileId:t?.id||"",quoteId:s}):D(i),N(i)}finally{S.current?.setUploadLoadding(!1)}},allowUpload:a})})})})})}});const O=s(l)(({style:e})=>({"& .file-upload-area":{cursor:"pointer","& .MuiDropzoneArea-textContainer":{display:"flex",alignItems:"center",color:e?.color||"#1976D2"},"& .MuiDropzoneArea-text":{order:1,textTransform:"uppercase",fontWeight:500,fontSize:"14px",lineHeight:"24px"}}})),W=s(l)(e=>({display:"flex",background:"true"===e.hasdelete?"rgba(25, 118, 210, 0.3)":"rgba(0, 0, 0, 0.12)",borderRadius:"18px",padding:"6px 8px",alignItems:"center",margin:"0 0 2px",color:"rgba(0, 0, 0, 0.54)","& .fileList-name-area":{display:"flex",flex:1,alignItems:"center"},"& .fileList-name":{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",flexGrow:1,flexBasis:"100px",maxWidth:"200px",color:"#313440",fontSize:"14px",cursor:"pointer"}})),Q=s(a)({marginBottom:"16px",fontSize:"10px",color:"rgba(0, 0, 0, 0.38)",padding:"0 12px",textAlign:"right",wordBreak:"break-word"}),H=s(M)(()=>({transform:"rotate(45deg)",marginRight:"5px"})),P=u.forwardRef(function(e,t){const n=x(),{title:s=n("global.fileUpload.addAttachment"),tips:d=n("global.fileUpload.maxFileSizeMessage"),maxFileSize:c=2097152,fileNumber:f=3,limitUploadFn:y,acceptedFiles:w=p,onchange:q=T,fileList:I=[],allowUpload:N=!0,onDelete:S=T,isEndLoadding:D=!1,requestType:z="quoteAttachedFile"}=e,F=o().palette.primary.main,[C,v]=u.useState(!1);u.useImperativeHandle(t,()=>({setUploadLoadding:e=>v(e)}));const E=e=>e/1048576>1?`${(e/1048576).toFixed(1)}MB`:e/1024>1?`${(e/1024).toFixed(1)}KB`:`${e}B`;return i.jsx(g,{isSpinning:C,children:i.jsxs(l,{sx:{padding:"12px 0 0",width:"100%"},children:[i.jsx(l,{children:I.map((e,t)=>i.jsxs(l,{children:[i.jsxs(W,{hasdelete:(e?.hasDelete||"").toString(),children:[i.jsxs(l,{className:"fileList-name-area",children:[i.jsx(H,{}),i.jsx(a,{className:"fileList-name",onClick:()=>{var t;(t=e.fileUrl)&&window.open(t,"_blank")},children:e.fileName})]}),e.hasDelete&&i.jsx(B,{sx:{cursor:"pointer"},onClick:()=>{S(e?.id||"")}})]}),i.jsx(Q,{children:e.title||""})]},e.id||t))}),N&&i.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",marginTop:"10px"},children:[i.jsx(O,{style:{color:F},children:i.jsx(m,{dropzoneClass:"file-upload-area",Icon:H,filesLimit:1,onChange:async e=>{const t=e.length>0?e[0]:null;if(!(t&&y&&y()))if(!y&&t&&I.length>=f)h.error(n("global.fileUpload.maxFileNumber",{fileNumber:f}));else if(t)try{v(!0);const{code:e,data:i,message:l}=await b({file:t,type:z});200===e?q({...i,id:j()}):h.error(l)}finally{D||v(!1)}},showPreviews:!1,showPreviewsInDropzone:!1,maxFileSize:c,showAlerts:!1,dropzoneText:s,getDropRejectMessage:(e,t,i)=>{const{size:l,type:a}=e;let o=!1;t.forEach(e=>{o=new RegExp(e).test(a)||o});let s="";return o||(s=n("global.fileUpload.fileTypeNotSupported")),l>i&&(s=n("global.fileUpload.fileSizeExceedsLimit",{maxFileSize:E(i)})),s&&h.error(s),s},getFileLimitExceedMessage:()=>(h.error(n("global.fileUpload.fileSizeExceedsLimit",{maxFileSize:E(c)})),""),acceptedFiles:w})}),i.jsx(r,{title:d,sx:{fontSize:"20px",color:"rgba(0, 0, 0, 0.54)"},children:i.jsx(R,{})})]})]})})}),V=e("C",s("div")(({padding:e="1rem",alignItems:t="flex-start",flexDirection:i="row",backgroundColor:l="white",width:a="100%",xs:n})=>({display:"flex",flexDirection:i,alignItems:t,padding:e,width:a,backgroundColor:l,...n})));function J({status:e,quoteInfo:t}){const n=x(),{info:{quoteTitle:o,referenceNumber:s},extraFields:r=[],recipients:d}=t,c=u.useId();return i.jsxs(l,{role:"article","aria-labelledby":c,sx:{width:"100%"},children:[i.jsx(a,{id:c,sx:{fontWeight:400,fontSize:"24px",height:"32px"},children:n("quoteDraft.quoteInfo.title")}),i.jsxs(l,{sx:{p:"15px 0"},children:[(o||"Draft"===e)&&i.jsx(a,{children:`${n("quoteDraft.quoteInfo.titleText")} ${o}`}),(s||"Draft"===e)&&i.jsx(a,{children:`${n("quoteDraft.quoteInfo.referenceText")} ${s}`}),"Draft"!==e||d.length?d.map(e=>i.jsx(a,{sx:{wordBreak:"break-all"},children:`${n("quoteDraft.quoteInfo.ccEmailText")} ${e}`},`ccEmail-${N.encode(e)}`)):i.jsx(a,{children:n("quoteDraft.quoteInfo.ccEmailText")}),r.map(t=>(t.value||"Draft"===e)&&i.jsx(a,{children:`${t.fieldName}: ${t.value}`},`extraField-${t.fieldName}`))]})]})}const G=["name","email","companyName","phoneNumber"],K=["label","firstName","lastName","company","address","apartment","city","state","zipCode","country","phoneNumber"],_=["label",["firstName","lastName"],"company","address","apartment",["city","state","zipCode","country"],"phoneNumber"];function X({flag:e,title:t,info:n,status:o}){const s="info"===e?G:_,[r]=S(),d=x(),c="Draft"===o?`Please add ${"Billing"===e?"billing":"shipping"} address `:`No ${"Billing"===e?"billing":"shipping"} address`,f="info"!==e&&K.some(e=>n&&!!n[e]),p="info"===e||r?0:"10px",g=u.useId();return i.jsxs(l,{"aria-labelledby":g,role:"article",sx:{width:r||"info"===e?"100%":"33.3%",paddingLeft:p},children:[i.jsx(a,{id:g,sx:{fontWeight:400,fontSize:"24px",height:"32px"},children:t}),i.jsxs(l,{sx:{p:"15px 0"},children:[(f||"info"===e)&&"{}"!==JSON.stringify(n)&&s.map(e=>"quoteTitle"===e?"Draft"===o?i.jsx(a,{sx:{wordBreak:"break-all"},variant:"body1",children:`${d("quoteDraft.quoteInfo.quoteTitle")}${n[e]||""}`},e):"":"string"==typeof e?i.jsx(a,{variant:"body1",children:n&&n[e]||""},e):i.jsx(a,{variant:"body1",children:e.map((t,i)=>i===e.length-1?n[t]||"":"firstName"===t?`${n[t]||""} `:n[t]?`${n[t]||""}, `:"")},`${e}`)),!f&&"info"!==e&&i.jsx(l,{children:c})]})]})}e("g",async()=>{let e=[];try{const{quoteExtraFieldsConfig:t}=await $(),i=t.filter(e=>e.visibleToEnduser);e=i.map(e=>{const{listOfValue:t}=e,i={isExtraFields:!0,name:e.fieldName||"",label:e.labelName||"",required:e.isRequired,default:e.defaultValue||"",fieldType:e.fieldCategory||"",xs:6,variant:"filled",size:"small",id:e.id};switch(e.fieldCategory){case"dropdown":if(t){const e=t?.map(e=>({label:e,value:e}));e.length>0&&(i.options=e)}break;case"number":i.max=e.maximumValue||"";break;case"multiline":i.rows=e.numberOfRows||"";break;default:i.maxLength=e.maximumLength||""}return i})}catch(t){E.error(t)}return e})}}});
//# sourceMappingURL=getQuoteExtraFields-legacy-KyXS2_Qd.js.map
